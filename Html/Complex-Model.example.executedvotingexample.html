<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.executedvotingexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.executedvotingexample.html" class="Module">Complex-Model.example.executedvotingexample</a>  <a id="85" class="Keyword">where</a>
<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Data.List.html" class="Module">Data.List</a>
<a id="113" class="Keyword">open</a> <a id="118" class="Keyword">import</a> <a id="125" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> 
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="171" class="Keyword">open</a> <a id="176" class="Keyword">import</a> <a id="183" href="Data.Product.html" class="Module">Data.Product</a> <a id="196" class="Keyword">renaming</a> <a id="205" class="Symbol">(</a><a id="206" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="210" class="Symbol">to</a> <a id="213" class="InductiveConstructor Operator">_,,_</a> <a id="218" class="Symbol">)</a>
<a id="220" class="Keyword">open</a> <a id="225" class="Keyword">import</a> <a id="232" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="243" class="Keyword">hiding</a> <a id="250" class="Symbol">(</a><a id="251" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="256" class="Symbol">)</a>
<a id="258" class="Keyword">open</a> <a id="263" class="Keyword">import</a> <a id="270" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> 
<a id="285" class="Keyword">open</a> <a id="290" class="Keyword">import</a> <a id="297" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="337" class="Keyword">hiding</a> <a id="344" class="Symbol">(</a><a id="345" href="Data.Fin.Base.html#5404" class="Function Operator">_+_</a><a id="348" class="Symbol">;</a> <a id="350" href="Data.Fin.Base.html#5540" class="Function Operator">_-_</a><a id="353" class="Symbol">)</a>
<a id="355" class="Keyword">import</a> <a id="362" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="400" class="Symbol">as</a> <a id="403" class="Module">Eq</a>
<a id="406" class="Keyword">open</a> <a id="411" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="414" class="Keyword">using</a> <a id="420" class="Symbol">(</a><a id="421" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="425" class="Symbol">;</a> <a id="427" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="432" class="Symbol">;</a> <a id="434" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="438" class="Symbol">;</a> <a id="440" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="444" class="Symbol">)</a>
<a id="446" class="Keyword">open</a> <a id="451" class="Keyword">import</a> <a id="458" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="475" class="Keyword">using</a> <a id="481" class="Symbol">(</a><a id="482" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="485" class="Symbol">;</a> <a id="487" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="490" class="Symbol">)</a>
<a id="492" class="Keyword">open</a> <a id="497" class="Keyword">import</a> <a id="504" href="Data.String.html" class="Module">Data.String</a> <a id="516" class="Keyword">hiding</a> <a id="523" class="Symbol">(</a><a id="524" href="Data.String.Base.html#2430" class="Function">length</a><a id="530" class="Symbol">;</a> <a id="532" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="536" class="Symbol">)</a> <a id="538" class="Keyword">renaming</a> <a id="547" class="Symbol">(</a><a id="548" href="Data.String.Base.html#2366" class="Function Operator">_++_</a> <a id="553" class="Symbol">to</a> <a id="556" class="Function Operator">_++str_</a><a id="563" class="Symbol">)</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="587" class="Keyword">open</a> <a id="592" class="Keyword">import</a> <a id="599" href="Data.Empty.html" class="Module">Data.Empty</a>



<a id="613" class="Comment">--our work</a>
<a id="624" class="Keyword">open</a> <a id="629" class="Keyword">import</a>  <a id="637" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="658" class="Keyword">open</a> <a id="663" class="Keyword">import</a> <a id="670" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="719" href="constantparameters.html#969" class="Function">exampleParameters</a>
<a id="737" class="Keyword">open</a> <a id="742" class="Keyword">import</a> <a id="749" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="791" class="Keyword">open</a> <a id="796" class="Keyword">import</a> <a id="803" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="822" class="Keyword">open</a> <a id="827" class="Keyword">import</a> <a id="834" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>
<a id="856" class="Keyword">open</a> <a id="861" class="Keyword">import</a> <a id="868" href="Complex-Model.example.votingexample.html" class="Module">Complex-Model.example.votingexample</a>



<a id="IsJust"></a><a id="907" href="Complex-Model.example.executedvotingexample.html#907" class="Function">IsJust</a> <a id="914" class="Symbol">:</a> <a id="916" class="Symbol">{</a><a id="917" href="Complex-Model.example.executedvotingexample.html#917" class="Bound">A</a> <a id="919" class="Symbol">:</a> <a id="921" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="924" class="Symbol">}</a> <a id="926" class="Symbol">→</a> <a id="928" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="934" href="Complex-Model.example.executedvotingexample.html#917" class="Bound">A</a> <a id="936" class="Symbol">→</a> <a id="938" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="942" href="Complex-Model.example.executedvotingexample.html#907" class="Function">IsJust</a> <a id="949" class="Symbol">(</a><a id="950" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="955" class="Symbol">_)</a> <a id="958" class="Symbol">=</a> <a id="960" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="962" href="Complex-Model.example.executedvotingexample.html#907" class="Function">IsJust</a> <a id="969" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>  <a id="978" class="Symbol">=</a> <a id="980" href="Data.Empty.html#526" class="Datatype">⊥</a>


<a id="fromJust"></a><a id="984" href="Complex-Model.example.executedvotingexample.html#984" class="Function">fromJust</a> <a id="993" class="Symbol">:</a> <a id="995" class="Symbol">{</a><a id="996" href="Complex-Model.example.executedvotingexample.html#996" class="Bound">A</a> <a id="998" class="Symbol">:</a> <a id="1000" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1003" class="Symbol">}</a> <a id="1005" class="Symbol">→</a> <a id="1007" class="Symbol">(</a><a id="1008" href="Complex-Model.example.executedvotingexample.html#1008" class="Bound">p</a> <a id="1010" class="Symbol">:</a> <a id="1012" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1018" href="Complex-Model.example.executedvotingexample.html#996" class="Bound">A</a><a id="1019" class="Symbol">)</a> <a id="1021" class="Symbol">→</a> <a id="1023" href="Complex-Model.example.executedvotingexample.html#907" class="Function">IsJust</a> <a id="1030" href="Complex-Model.example.executedvotingexample.html#1008" class="Bound">p</a> <a id="1032" class="Symbol">→</a> <a id="1034" href="Complex-Model.example.executedvotingexample.html#996" class="Bound">A</a>
<a id="1036" href="Complex-Model.example.executedvotingexample.html#984" class="Function">fromJust</a> <a id="1045" class="Symbol">(</a><a id="1046" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1051" href="Complex-Model.example.executedvotingexample.html#1051" class="Bound">a</a><a id="1052" class="Symbol">)</a> <a id="1054" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="1057" class="Symbol">=</a> <a id="1059" href="Complex-Model.example.executedvotingexample.html#1051" class="Bound">a</a>

<a id="1062" class="Comment">--------------------------- First test   (adding voter)</a>
<a id="1118" class="Comment">-- using function &quot;AddVoter&quot; with (nat 5) on testLedger</a>

<a id="resultAfterAddVoter5"></a><a id="1175" href="Complex-Model.example.executedvotingexample.html#1175" class="Function">resultAfterAddVoter5</a> <a id="1196" class="Symbol">:</a> <a id="1198" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a> <a id="1205" href="Data.Product.html#1167" class="Function Operator">×</a>  <a id="1208" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="1226" href="Complex-Model.example.executedvotingexample.html#1175" class="Function">resultAfterAddVoter5</a> <a id="1247" class="Symbol">=</a> <a id="1249" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html#32402" class="Function">evaluateTerminatingfinal</a> <a id="1274" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="1285" class="Number">1</a> <a id="1287" class="Number">1</a> <a id="1289" class="Number">1</a> <a id="1291" class="String">&quot;addVoter&quot;</a> <a id="1302" class="Symbol">(</a><a id="1303" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1307" class="Number">5</a><a id="1308" class="Symbol">)</a> <a id="1310" class="Number">20</a>


<a id="resultReturnedAddVoter5"></a><a id="1315" href="Complex-Model.example.executedvotingexample.html#1315" class="Function">resultReturnedAddVoter5</a> <a id="1339" class="Symbol">:</a> <a id="1341" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="1359" href="Complex-Model.example.executedvotingexample.html#1315" class="Function">resultReturnedAddVoter5</a> <a id="1383" class="Symbol">=</a> <a id="1385" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1391" href="Complex-Model.example.executedvotingexample.html#1175" class="Function">resultAfterAddVoter5</a>
<a id="1412" class="Comment">{-
evaluate to
theMsg (nat 5) , 16 gas
so executing addVoter (nat 5) returned (nat 5)
-}</a>

<a id="ledgerAfterAdd5"></a><a id="1502" href="Complex-Model.example.executedvotingexample.html#1502" class="Function">ledgerAfterAdd5</a> <a id="1518" class="Symbol">:</a> <a id="1520" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a>
<a id="1527" href="Complex-Model.example.executedvotingexample.html#1502" class="Function">ledgerAfterAdd5</a> <a id="1543" class="Symbol">=</a> <a id="1545" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1551" href="Complex-Model.example.executedvotingexample.html#1175" class="Function">resultAfterAddVoter5</a>


<a id="1574" class="Comment">-- check the pure function with (nat 5) after adding voter to our ledger</a>
<a id="checkVoter5afterAdd5"></a><a id="1647" href="Complex-Model.example.executedvotingexample.html#1647" class="Function">checkVoter5afterAdd5</a> <a id="1668" class="Symbol">:</a> <a id="1670" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="1681" href="Complex-Model.example.executedvotingexample.html#1647" class="Function">checkVoter5afterAdd5</a> <a id="1702" class="Symbol">=</a> <a id="1704" href="Complex-Model.example.executedvotingexample.html#1502" class="Function">ledgerAfterAdd5</a> <a id="1720" class="Number">1</a> <a id="1722" class="Symbol">.</a><a id="1723" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="1736" class="String">&quot;checkVoter&quot;</a> <a id="1749" class="Symbol">(</a><a id="1750" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1754" class="Number">5</a><a id="1755" class="Symbol">)</a>
<a id="1757" class="Comment">{-
evaluate to
theMsg (nat 1)
which means true
-}</a>


<a id="checkVoter3AfterAdd5"></a><a id="1809" href="Complex-Model.example.executedvotingexample.html#1809" class="Function">checkVoter3AfterAdd5</a> <a id="1830" class="Symbol">:</a> <a id="1832" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="1843" href="Complex-Model.example.executedvotingexample.html#1809" class="Function">checkVoter3AfterAdd5</a> <a id="1864" class="Symbol">=</a> <a id="1866" href="Complex-Model.example.executedvotingexample.html#1502" class="Function">ledgerAfterAdd5</a> <a id="1882" class="Number">1</a> <a id="1884" class="Symbol">.</a><a id="1885" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="1898" class="String">&quot;checkVoter&quot;</a> <a id="1911" class="Symbol">(</a><a id="1912" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1916" class="Number">3</a><a id="1917" class="Symbol">)</a>
<a id="1919" class="Comment">{-
evaluate to
theMsg (nat 0)
which means false
our ledger only includes (nat 5)
-}</a>


<a id="2005" class="Comment">----------------------------- Second test   (adding voter)</a>
<a id="2064" class="Comment">-- using function &quot;addVoter&quot; with (nat 3) on ledgerAfterAdd5</a>

<a id="resultAfterAddVoter3"></a><a id="2126" href="Complex-Model.example.executedvotingexample.html#2126" class="Function">resultAfterAddVoter3</a> <a id="2147" class="Symbol">:</a> <a id="2149" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a> <a id="2156" href="Data.Product.html#1167" class="Function Operator">×</a>  <a id="2159" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="2177" href="Complex-Model.example.executedvotingexample.html#2126" class="Function">resultAfterAddVoter3</a> <a id="2198" class="Symbol">=</a> <a id="2200" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html#32402" class="Function">evaluateTerminatingfinal</a> <a id="2225" href="Complex-Model.example.executedvotingexample.html#1502" class="Function">ledgerAfterAdd5</a> <a id="2241" class="Number">1</a> <a id="2243" class="Number">1</a> <a id="2245" class="Number">1</a> <a id="2247" class="String">&quot;addVoter&quot;</a> <a id="2258" class="Symbol">(</a><a id="2259" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2263" class="Number">3</a><a id="2264" class="Symbol">)</a> <a id="2266" class="Number">20</a>

<a id="resultReturnedAddVoter3"></a><a id="2270" href="Complex-Model.example.executedvotingexample.html#2270" class="Function">resultReturnedAddVoter3</a> <a id="2294" class="Symbol">:</a> <a id="2296" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="2314" href="Complex-Model.example.executedvotingexample.html#2270" class="Function">resultReturnedAddVoter3</a> <a id="2338" class="Symbol">=</a> <a id="2340" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="2346" href="Complex-Model.example.executedvotingexample.html#2126" class="Function">resultAfterAddVoter3</a>

<a id="2368" class="Comment">{- evaluates to

theMsg (nat 3) , 16 gas

-}</a>


<a id="ledgerAfterAdd3"></a><a id="2415" href="Complex-Model.example.executedvotingexample.html#2415" class="Function">ledgerAfterAdd3</a> <a id="2431" class="Symbol">:</a> <a id="2433" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a>
<a id="2440" href="Complex-Model.example.executedvotingexample.html#2415" class="Function">ledgerAfterAdd3</a> <a id="2456" class="Symbol">=</a> <a id="2458" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="2464" href="Complex-Model.example.executedvotingexample.html#2126" class="Function">resultAfterAddVoter3</a>

<a id="2486" class="Comment">-- check the pure function with (nat 5) after adding voter to our ledger</a>
<a id="checkVoter5afterAdd3"></a><a id="2559" href="Complex-Model.example.executedvotingexample.html#2559" class="Function">checkVoter5afterAdd3</a> <a id="2580" class="Symbol">:</a> <a id="2582" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="2593" href="Complex-Model.example.executedvotingexample.html#2559" class="Function">checkVoter5afterAdd3</a> <a id="2614" class="Symbol">=</a> <a id="2616" href="Complex-Model.example.executedvotingexample.html#2415" class="Function">ledgerAfterAdd3</a> <a id="2632" class="Number">1</a> <a id="2634" class="Symbol">.</a><a id="2635" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="2648" class="String">&quot;checkVoter&quot;</a> <a id="2661" class="Symbol">(</a><a id="2662" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2666" class="Number">5</a><a id="2667" class="Symbol">)</a>
<a id="2669" class="Comment">-- evaluates to</a>
<a id="2685" class="Comment">-- theMsg (nat 1) which means true</a>

<a id="2721" class="Comment">-- check the pure function with (nat 3) after adding voter to our ledger</a>
<a id="checkVoter3afterAdd3"></a><a id="2794" href="Complex-Model.example.executedvotingexample.html#2794" class="Function">checkVoter3afterAdd3</a> <a id="2815" class="Symbol">:</a> <a id="2817" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="2828" href="Complex-Model.example.executedvotingexample.html#2794" class="Function">checkVoter3afterAdd3</a> <a id="2849" class="Symbol">=</a> <a id="2851" href="Complex-Model.example.executedvotingexample.html#2415" class="Function">ledgerAfterAdd3</a> <a id="2867" class="Number">1</a> <a id="2869" class="Symbol">.</a><a id="2870" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="2883" class="String">&quot;checkVoter&quot;</a> <a id="2896" class="Symbol">(</a><a id="2897" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2901" class="Number">3</a><a id="2902" class="Symbol">)</a>
<a id="2904" class="Comment">-- evaluates to</a>
<a id="2920" class="Comment">-- theMsg (nat 1) which means true</a>

<a id="2956" class="Comment">-- check the pure function with (nat 2) after adding voter to our ledger</a>
<a id="checkVoter2afterAdd3"></a><a id="3029" href="Complex-Model.example.executedvotingexample.html#3029" class="Function">checkVoter2afterAdd3</a> <a id="3050" class="Symbol">:</a> <a id="3052" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="3063" href="Complex-Model.example.executedvotingexample.html#3029" class="Function">checkVoter2afterAdd3</a> <a id="3084" class="Symbol">=</a> <a id="3086" href="Complex-Model.example.executedvotingexample.html#2415" class="Function">ledgerAfterAdd3</a> <a id="3102" class="Number">1</a> <a id="3104" class="Symbol">.</a><a id="3105" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="3118" class="String">&quot;checkVoter&quot;</a> <a id="3131" class="Symbol">(</a><a id="3132" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3136" class="Number">2</a><a id="3137" class="Symbol">)</a>
<a id="3139" class="Comment">-- evaluates to</a>
<a id="3155" class="Comment">-- theMsg (nat 0) which means false because our ledger only include (nat 5) and (nat 3)</a>





<a id="3248" class="Comment">----------------------------- Third test  using &quot;deletevoter&quot;</a>
<a id="3310" class="Comment">-- using function &quot;deleteVoter&quot; with (nat 5) on ledgerAfterAdd3</a>

<a id="resultAfterDeleteVoter5"></a><a id="3375" href="Complex-Model.example.executedvotingexample.html#3375" class="Function">resultAfterDeleteVoter5</a> <a id="3399" class="Symbol">:</a> <a id="3401" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a> <a id="3408" href="Data.Product.html#1167" class="Function Operator">×</a>  <a id="3411" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="3429" href="Complex-Model.example.executedvotingexample.html#3375" class="Function">resultAfterDeleteVoter5</a> <a id="3453" class="Symbol">=</a> <a id="3455" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html#32402" class="Function">evaluateTerminatingfinal</a> <a id="3480" href="Complex-Model.example.executedvotingexample.html#2415" class="Function">ledgerAfterAdd3</a> <a id="3496" class="Number">1</a> <a id="3498" class="Number">1</a> <a id="3500" class="Number">1</a> <a id="3502" class="String">&quot;deleteVoter&quot;</a> <a id="3516" class="Symbol">(</a><a id="3517" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3521" class="Number">5</a><a id="3522" class="Symbol">)</a> <a id="3524" class="Number">20</a>


<a id="resultReturnedDeleteVoter5"></a><a id="3529" href="Complex-Model.example.executedvotingexample.html#3529" class="Function">resultReturnedDeleteVoter5</a> <a id="3556" class="Symbol">:</a> <a id="3558" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="3576" href="Complex-Model.example.executedvotingexample.html#3529" class="Function">resultReturnedDeleteVoter5</a> <a id="3603" class="Symbol">=</a> <a id="3605" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3611" href="Complex-Model.example.executedvotingexample.html#3375" class="Function">resultAfterDeleteVoter5</a>
<a id="3635" class="Comment">{- evaluates to

theMsg (nat 5) , 16 gas

-}</a>

<a id="ledgerAfterDelete5"></a><a id="3681" href="Complex-Model.example.executedvotingexample.html#3681" class="Function">ledgerAfterDelete5</a> <a id="3700" class="Symbol">:</a> <a id="3702" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a>
<a id="3709" href="Complex-Model.example.executedvotingexample.html#3681" class="Function">ledgerAfterDelete5</a> <a id="3728" class="Symbol">=</a> <a id="3730" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3736" href="Complex-Model.example.executedvotingexample.html#3375" class="Function">resultAfterDeleteVoter5</a>


<a id="3762" class="Comment">-- check the pure function with (nat 5) after deleting voter from our ledger</a>
<a id="checkVoter5afterDelete5"></a><a id="3839" href="Complex-Model.example.executedvotingexample.html#3839" class="Function">checkVoter5afterDelete5</a> <a id="3863" class="Symbol">:</a> <a id="3865" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="3876" href="Complex-Model.example.executedvotingexample.html#3839" class="Function">checkVoter5afterDelete5</a> <a id="3900" class="Symbol">=</a> <a id="3902" href="Complex-Model.example.executedvotingexample.html#3681" class="Function">ledgerAfterDelete5</a> <a id="3921" class="Number">1</a> <a id="3923" class="Symbol">.</a><a id="3924" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="3937" class="String">&quot;checkVoter&quot;</a> <a id="3950" class="Symbol">(</a><a id="3951" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3955" class="Number">5</a><a id="3956" class="Symbol">)</a>
<a id="3958" class="Comment">-- evaluates to</a>
<a id="3974" class="Comment">-- theMsg (nat 0) which means (nat 5) not in our ledger</a>


<a id="4032" class="Comment">-- check the pure function with (nat 3) after deleting voter (nat 5) from our ledger</a>
<a id="checkVoter3afterDelete5"></a><a id="4117" href="Complex-Model.example.executedvotingexample.html#4117" class="Function">checkVoter3afterDelete5</a> <a id="4141" class="Symbol">:</a> <a id="4143" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="4154" href="Complex-Model.example.executedvotingexample.html#4117" class="Function">checkVoter3afterDelete5</a> <a id="4178" class="Symbol">=</a> <a id="4180" href="Complex-Model.example.executedvotingexample.html#3681" class="Function">ledgerAfterDelete5</a> <a id="4199" class="Number">1</a> <a id="4201" class="Symbol">.</a><a id="4202" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="4215" class="String">&quot;checkVoter&quot;</a> <a id="4228" class="Symbol">(</a><a id="4229" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="4233" class="Number">3</a><a id="4234" class="Symbol">)</a>
<a id="4236" class="Comment">-- evaluates to</a>
<a id="4252" class="Comment">-- theMsg (nat 1) which means our ledger only have (nat 3)</a>




<a id="4315" class="Comment">----------------------------- Fourth test  using &quot;addVoter&quot;</a>
<a id="4375" class="Comment">-- using function &quot;addVoter&quot; with (nat 8) on ledgerAfterDelete5</a>

<a id="resultAfterAddVoter8"></a><a id="4440" href="Complex-Model.example.executedvotingexample.html#4440" class="Function">resultAfterAddVoter8</a> <a id="4461" class="Symbol">:</a> <a id="4463" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a> <a id="4470" href="Data.Product.html#1167" class="Function Operator">×</a>  <a id="4473" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="4491" href="Complex-Model.example.executedvotingexample.html#4440" class="Function">resultAfterAddVoter8</a> <a id="4512" class="Symbol">=</a> <a id="4514" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html#32402" class="Function">evaluateTerminatingfinal</a> <a id="4539" href="Complex-Model.example.executedvotingexample.html#3681" class="Function">ledgerAfterDelete5</a> <a id="4558" class="Number">1</a> <a id="4560" class="Number">1</a> <a id="4562" class="Number">1</a> <a id="4564" class="String">&quot;addVoter&quot;</a> <a id="4575" class="Symbol">(</a><a id="4576" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="4580" class="Number">8</a><a id="4581" class="Symbol">)</a> <a id="4583" class="Number">20</a>

<a id="resultReturnedAddVoter8"></a><a id="4587" href="Complex-Model.example.executedvotingexample.html#4587" class="Function">resultReturnedAddVoter8</a> <a id="4611" class="Symbol">:</a> <a id="4613" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="4631" href="Complex-Model.example.executedvotingexample.html#4587" class="Function">resultReturnedAddVoter8</a> <a id="4655" class="Symbol">=</a> <a id="4657" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="4663" href="Complex-Model.example.executedvotingexample.html#4440" class="Function">resultAfterAddVoter8</a>
<a id="4684" class="Comment">{- evaluates to

theMsg (nat 8) , 16 gas

-}</a>

<a id="ledgerAfterAdd8"></a><a id="4730" href="Complex-Model.example.executedvotingexample.html#4730" class="Function">ledgerAfterAdd8</a> <a id="4746" class="Symbol">:</a> <a id="4748" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a>
<a id="4755" href="Complex-Model.example.executedvotingexample.html#4730" class="Function">ledgerAfterAdd8</a> <a id="4771" class="Symbol">=</a> <a id="4773" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="4779" href="Complex-Model.example.executedvotingexample.html#4440" class="Function">resultAfterAddVoter8</a>


<a id="4802" class="Comment">-- check the pure function with (nat 8) after adding voter to our ledger</a>
<a id="checkVoter8afterAdd8"></a><a id="4875" href="Complex-Model.example.executedvotingexample.html#4875" class="Function">checkVoter8afterAdd8</a> <a id="4896" class="Symbol">:</a> <a id="4898" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="4909" href="Complex-Model.example.executedvotingexample.html#4875" class="Function">checkVoter8afterAdd8</a> <a id="4930" class="Symbol">=</a> <a id="4932" href="Complex-Model.example.executedvotingexample.html#4730" class="Function">ledgerAfterAdd8</a> <a id="4948" class="Number">1</a> <a id="4950" class="Symbol">.</a><a id="4951" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="4964" class="String">&quot;checkVoter&quot;</a> <a id="4977" class="Symbol">(</a><a id="4978" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="4982" class="Number">8</a><a id="4983" class="Symbol">)</a>
<a id="4985" class="Comment">-- evaluates to</a>
<a id="5001" class="Comment">-- theMsg (nat 1) which means true</a>


<a id="5038" class="Comment">-- check the pure function with (nat 3) after adding voter to our ledger</a>
<a id="checkVoter3afterAdd8"></a><a id="5111" href="Complex-Model.example.executedvotingexample.html#5111" class="Function">checkVoter3afterAdd8</a> <a id="5132" class="Symbol">:</a> <a id="5134" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="5145" href="Complex-Model.example.executedvotingexample.html#5111" class="Function">checkVoter3afterAdd8</a> <a id="5166" class="Symbol">=</a> <a id="5168" href="Complex-Model.example.executedvotingexample.html#4730" class="Function">ledgerAfterAdd8</a> <a id="5184" class="Number">1</a> <a id="5186" class="Symbol">.</a><a id="5187" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="5200" class="String">&quot;checkVoter&quot;</a> <a id="5213" class="Symbol">(</a><a id="5214" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="5218" class="Number">3</a><a id="5219" class="Symbol">)</a>
<a id="5221" class="Comment">-- evaluates to</a>
<a id="5237" class="Comment">-- theMsg (nat 1) which means true</a>


<a id="5274" class="Comment">-- check the pure function with (nat 5) after adding voter to our ledger</a>
<a id="checkVoter5afterAdd8"></a><a id="5347" href="Complex-Model.example.executedvotingexample.html#5347" class="Function">checkVoter5afterAdd8</a> <a id="5368" class="Symbol">:</a> <a id="5370" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="5381" href="Complex-Model.example.executedvotingexample.html#5347" class="Function">checkVoter5afterAdd8</a> <a id="5402" class="Symbol">=</a> <a id="5404" href="Complex-Model.example.executedvotingexample.html#4730" class="Function">ledgerAfterAdd8</a> <a id="5420" class="Number">1</a> <a id="5422" class="Symbol">.</a><a id="5423" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="5436" class="String">&quot;checkVoter&quot;</a> <a id="5449" class="Symbol">(</a><a id="5450" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="5454" class="Number">5</a><a id="5455" class="Symbol">)</a>
<a id="5457" class="Comment">-- evaluates to</a>
<a id="5473" class="Comment">-- theMsg (nat 0) which means false</a>

<a id="5510" class="Comment">-- ******** Now our ledger only include (nat 3) and ( nat 8)</a>


<a id="checkCounterAfterAdd8"></a><a id="5573" href="Complex-Model.example.executedvotingexample.html#5573" class="Function">checkCounterAfterAdd8</a> <a id="5595" class="Symbol">:</a> <a id="5597" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="5608" href="Complex-Model.example.executedvotingexample.html#5573" class="Function">checkCounterAfterAdd8</a> <a id="5630" class="Symbol">=</a> <a id="5632" href="Complex-Model.example.executedvotingexample.html#4730" class="Function">ledgerAfterAdd8</a> <a id="5648" class="Number">1</a> <a id="5650" class="Symbol">.</a><a id="5651" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="5664" class="String">&quot;counter&quot;</a> <a id="5674" class="Symbol">(</a><a id="5675" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="5679" class="Number">0</a><a id="5680" class="Symbol">)</a>
<a id="5682" class="Comment">-- evaluates to</a>
<a id="5698" class="Comment">-- theMsg (nat 0)</a>
<a id="5716" class="Comment">-- so the counter is zero</a>


<a id="5744" class="Comment">----------------------------- Fifth test  using &quot;vote&quot; (who is not allowed to vote)</a>
<a id="5828" class="Comment">-- using function &quot;vote&quot;</a>

<a id="resultAfterVote5"></a><a id="5854" href="Complex-Model.example.executedvotingexample.html#5854" class="Function">resultAfterVote5</a> <a id="5871" class="Symbol">:</a> <a id="5873" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a> <a id="5880" href="Data.Product.html#1167" class="Function Operator">×</a>  <a id="5883" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="5901" href="Complex-Model.example.executedvotingexample.html#5854" class="Function">resultAfterVote5</a> <a id="5918" class="Symbol">=</a> <a id="5920" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html#32402" class="Function">evaluateTerminatingfinal</a> <a id="5945" href="Complex-Model.example.executedvotingexample.html#4730" class="Function">ledgerAfterAdd8</a> <a id="5961" class="Number">1</a> <a id="5963" class="Number">5</a> <a id="5965" class="Number">1</a> <a id="5967" class="String">&quot;vote&quot;</a> <a id="5974" class="Symbol">(</a><a id="5975" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="5979" class="Number">0</a><a id="5980" class="Symbol">)</a> <a id="5982" class="Number">50</a>

<a id="resultReturnedVote5"></a><a id="5986" href="Complex-Model.example.executedvotingexample.html#5986" class="Function">resultReturnedVote5</a> <a id="6006" class="Symbol">:</a> <a id="6008" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="6026" href="Complex-Model.example.executedvotingexample.html#5986" class="Function">resultReturnedVote5</a> <a id="6046" class="Symbol">=</a> <a id="6048" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6054" href="Complex-Model.example.executedvotingexample.html#5854" class="Function">resultAfterVote5</a>
<a id="6071" class="Comment">-- returns</a>
<a id="6082" class="Comment">-- err (strErr &quot;The voter is not allowed to vote&quot;) ⟨ 5 &gt;&gt; 1 ∙ &quot;checkVoter&quot; [ nat 5 ]⟩ , 46 gas</a>
<a id="6177" class="Comment">-- because 5 is not allowed to vote</a>

<a id="ledgerAfterVote5"></a><a id="6214" href="Complex-Model.example.executedvotingexample.html#6214" class="Function">ledgerAfterVote5</a> <a id="6231" class="Symbol">:</a> <a id="6233" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a>
<a id="6240" href="Complex-Model.example.executedvotingexample.html#6214" class="Function">ledgerAfterVote5</a> <a id="6257" class="Symbol">=</a> <a id="6259" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6265" href="Complex-Model.example.executedvotingexample.html#5854" class="Function">resultAfterVote5</a>


<a id="checkCounterAfterVote5"></a><a id="6284" href="Complex-Model.example.executedvotingexample.html#6284" class="Function">checkCounterAfterVote5</a> <a id="6307" class="Symbol">:</a> <a id="6309" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="6320" href="Complex-Model.example.executedvotingexample.html#6284" class="Function">checkCounterAfterVote5</a> <a id="6343" class="Symbol">=</a> <a id="6345" href="Complex-Model.example.executedvotingexample.html#6214" class="Function">ledgerAfterVote5</a>  <a id="6363" class="Number">1</a> <a id="6365" class="Symbol">.</a><a id="6366" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="6379" class="String">&quot;counter&quot;</a> <a id="6389" class="Symbol">(</a><a id="6390" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="6394" class="Number">0</a><a id="6395" class="Symbol">)</a>
<a id="6397" class="Comment">-- evaluates to</a>
<a id="6413" class="Comment">-- theMsg (nat 0)</a>
<a id="6431" class="Comment">-- so the counter is still zero</a>


<a id="6465" class="Comment">----------------------------- Sixth test  using &quot;vote&quot; (who is allowed to vote)</a>
<a id="6545" class="Comment">-- using function &quot;vote&quot;</a>

<a id="resultAfterVote3"></a><a id="6571" href="Complex-Model.example.executedvotingexample.html#6571" class="Function">resultAfterVote3</a> <a id="6588" class="Symbol">:</a> <a id="6590" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a> <a id="6597" href="Data.Product.html#1167" class="Function Operator">×</a>  <a id="6600" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="6618" href="Complex-Model.example.executedvotingexample.html#6571" class="Function">resultAfterVote3</a> <a id="6635" class="Symbol">=</a> <a id="6637" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html#32402" class="Function">evaluateTerminatingfinal</a> <a id="6662" href="Complex-Model.example.executedvotingexample.html#6214" class="Function">ledgerAfterVote5</a> <a id="6679" class="Number">1</a> <a id="6681" class="Number">3</a> <a id="6683" class="Number">1</a> <a id="6685" class="String">&quot;vote&quot;</a> <a id="6692" class="Symbol">(</a><a id="6693" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="6697" class="Number">0</a><a id="6698" class="Symbol">)</a> <a id="6700" class="Number">50</a>


<a id="resultReturnedVote3"></a><a id="6705" href="Complex-Model.example.executedvotingexample.html#6705" class="Function">resultReturnedVote3</a> <a id="6725" class="Symbol">:</a> <a id="6727" href="basicDataStructure.html#1708" class="Record">MsgOrErrorWithGas</a>
<a id="6745" href="Complex-Model.example.executedvotingexample.html#6705" class="Function">resultReturnedVote3</a> <a id="6765" class="Symbol">=</a> <a id="6767" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6773" href="Complex-Model.example.executedvotingexample.html#6571" class="Function">resultAfterVote3</a>
<a id="6790" class="Comment">-- evaluates to</a>
<a id="6806" class="Comment">-- theMsg (nat 1) , 37 gas</a>

<a id="ledgerAfterVote3"></a><a id="6834" href="Complex-Model.example.executedvotingexample.html#6834" class="Function">ledgerAfterVote3</a> <a id="6851" class="Symbol">:</a> <a id="6853" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a>
<a id="6860" href="Complex-Model.example.executedvotingexample.html#6834" class="Function">ledgerAfterVote3</a> <a id="6877" class="Symbol">=</a> <a id="6879" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6885" href="Complex-Model.example.executedvotingexample.html#6571" class="Function">resultAfterVote3</a>


<a id="6904" class="Comment">-- check the pure function with (nat 8) can vote for not</a>
<a id="checkVoter3"></a><a id="6961" href="Complex-Model.example.executedvotingexample.html#6961" class="Function">checkVoter3</a> <a id="6973" class="Symbol">:</a> <a id="6975" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="6986" href="Complex-Model.example.executedvotingexample.html#6961" class="Function">checkVoter3</a> <a id="6998" class="Symbol">=</a> <a id="7000" href="Complex-Model.example.executedvotingexample.html#6834" class="Function">ledgerAfterVote3</a> <a id="7017" class="Number">1</a> <a id="7019" class="Symbol">.</a><a id="7020" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="7033" class="String">&quot;checkVoter&quot;</a> <a id="7046" class="Symbol">(</a><a id="7047" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="7051" class="Number">3</a><a id="7052" class="Symbol">)</a>
<a id="7054" class="Comment">-- evaluates to</a>
<a id="7070" class="Comment">-- theMsg (nat 0) which means false and can no  longer vote because has voted</a>



<a id="7151" class="Comment">-- check the pure function with (nat 5) can vote or not</a>
<a id="checkVoter5"></a><a id="7207" href="Complex-Model.example.executedvotingexample.html#7207" class="Function">checkVoter5</a> <a id="7219" class="Symbol">:</a> <a id="7221" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="7232" href="Complex-Model.example.executedvotingexample.html#7207" class="Function">checkVoter5</a> <a id="7244" class="Symbol">=</a> <a id="7246" href="Complex-Model.example.executedvotingexample.html#6834" class="Function">ledgerAfterVote3</a> <a id="7263" class="Number">1</a> <a id="7265" class="Symbol">.</a><a id="7266" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="7279" class="String">&quot;checkVoter&quot;</a> <a id="7292" class="Symbol">(</a><a id="7293" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="7297" class="Number">5</a><a id="7298" class="Symbol">)</a>
<a id="7300" class="Comment">-- evaluates to</a>
<a id="7316" class="Comment">-- theMsg (nat 0) which means false and cannot vote</a>

<a id="7369" class="Comment">-- check the pure function with (nat 5) can vote or not</a>
<a id="checkVoter8"></a><a id="7425" href="Complex-Model.example.executedvotingexample.html#7425" class="Function">checkVoter8</a> <a id="7437" class="Symbol">:</a> <a id="7439" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="7450" href="Complex-Model.example.executedvotingexample.html#7425" class="Function">checkVoter8</a> <a id="7462" class="Symbol">=</a> <a id="7464" href="Complex-Model.example.executedvotingexample.html#6834" class="Function">ledgerAfterVote3</a> <a id="7481" class="Number">1</a> <a id="7483" class="Symbol">.</a><a id="7484" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="7497" class="String">&quot;checkVoter&quot;</a> <a id="7510" class="Symbol">(</a><a id="7511" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="7515" class="Number">8</a><a id="7516" class="Symbol">)</a>
<a id="7518" class="Comment">-- evaluates to</a>
<a id="7534" class="Comment">-- theMsg (nat 1) which means false and cannot vote</a>



<a id="checkCounterAfterVote3"></a><a id="7589" href="Complex-Model.example.executedvotingexample.html#7589" class="Function">checkCounterAfterVote3</a> <a id="7612" class="Symbol">:</a> <a id="7614" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="7625" href="Complex-Model.example.executedvotingexample.html#7589" class="Function">checkCounterAfterVote3</a> <a id="7648" class="Symbol">=</a> <a id="7650" href="Complex-Model.example.executedvotingexample.html#6834" class="Function">ledgerAfterVote3</a> <a id="7667" class="Number">1</a> <a id="7669" class="Symbol">.</a><a id="7670" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="7683" class="String">&quot;counter&quot;</a> <a id="7693" class="Symbol">(</a><a id="7694" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="7698" class="Number">0</a><a id="7699" class="Symbol">)</a>
<a id="7701" class="Comment">-- evaluates to</a>
<a id="7717" class="Comment">-- theMsg (nat 1)</a>
<a id="7735" class="Comment">-- so the counter is have 1</a>
</pre></body></html>