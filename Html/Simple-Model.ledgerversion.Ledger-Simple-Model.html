<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.ledgerversion.Ledger-Simple-Model</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a> <a id="55" class="Keyword">where</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="112" class="Keyword">using</a> <a id="118" class="Symbol">(</a><a id="119" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="122" class="Symbol">)</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Data.List.html" class="Module">Data.List</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="267" class="Keyword">hiding</a> <a id="274" class="Symbol">(</a><a id="275" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="280" class="Symbol">)</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.String.html" class="Module">Data.String</a> <a id="306" class="Keyword">hiding</a> <a id="313" class="Symbol">(</a><a id="314" href="Data.String.Base.html#2430" class="Function">length</a><a id="320" class="Symbol">)</a>

<a id="323" class="Comment">--library for simple model</a>
<a id="350" class="Keyword">open</a> <a id="355" class="Keyword">import</a> <a id="362" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>

<a id="431" class="Comment">-- main library</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>




<a id="484" class="Keyword">mutual</a>

  <a id="494" class="Comment">-- smart contract-comands:</a>
  <a id="523" class="Keyword">data</a> <a id="CCommands"></a><a id="528" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a> <a id="538" class="Symbol">:</a> <a id="540" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="544" class="Keyword">where</a>
    <a id="CCommands.updatec"></a><a id="554" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#554" class="InductiveConstructor">updatec</a> <a id="562" class="Symbol">:</a> <a id="564" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a> <a id="577" class="Symbol">→</a> <a id="579" class="Symbol">(</a><a id="580" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="584" class="Symbol">→</a> <a id="586" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="604" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a><a id="607" class="Symbol">)</a> <a id="609" class="Symbol">→</a> <a id="611" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a>
    <a id="CCommands.currentAddrLookupc"></a><a id="625" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#625" class="InductiveConstructor">currentAddrLookupc</a> <a id="644" class="Symbol">:</a> <a id="646" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a>
    <a id="CCommands.callAddrLookupc"></a><a id="660" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#660" class="InductiveConstructor">callAddrLookupc</a> <a id="676" class="Symbol">:</a> <a id="678" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a>
    <a id="CCommands.callc"></a><a id="692" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#692" class="InductiveConstructor">callc</a>   <a id="700" class="Symbol">:</a> <a id="702" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a> <a id="710" class="Symbol">→</a> <a id="712" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a> <a id="725" class="Symbol">→</a> <a id="727" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="731" class="Symbol">→</a> <a id="733" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a>
    <a id="CCommands.transferc"></a><a id="747" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#747" class="InductiveConstructor">transferc</a> <a id="757" class="Symbol">:</a> <a id="759" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#411" class="Function">Amount</a> <a id="766" class="Symbol">→</a> <a id="768" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a> <a id="776" class="Symbol">→</a>  <a id="779" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a>
    <a id="CCommands.getAmountc"></a><a id="793" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#793" class="InductiveConstructor">getAmountc</a> <a id="804" class="Symbol">:</a> <a id="806" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a> <a id="814" class="Symbol">→</a> <a id="816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a>

<a id="827" class="Comment">-- smart contract responses:</a>
  <a id="CResponse"></a><a id="858" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#858" class="Function">CResponse</a> <a id="868" class="Symbol">:</a> <a id="870" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a> <a id="880" class="Symbol">→</a> <a id="882" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="888" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#858" class="Function">CResponse</a> <a id="898" class="Symbol">(</a><a id="899" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#554" class="InductiveConstructor">updatec</a> <a id="907" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Bound">fname</a> <a id="913" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#913" class="Bound">fdef</a><a id="917" class="Symbol">)</a> <a id="919" class="Symbol">=</a> <a id="921" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="925" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#858" class="Function">CResponse</a> <a id="935" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#625" class="InductiveConstructor">currentAddrLookupc</a> <a id="954" class="Symbol">=</a> <a id="956" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>
  <a id="966" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#858" class="Function">CResponse</a> <a id="976" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#660" class="InductiveConstructor">callAddrLookupc</a> <a id="992" class="Symbol">=</a> <a id="994" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>
  <a id="1004" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#858" class="Function">CResponse</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#793" class="InductiveConstructor">getAmountc</a> <a id="1026" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1026" class="Bound">addr</a><a id="1030" class="Symbol">)</a> <a id="1032" class="Symbol">=</a> <a id="1034" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#411" class="Function">Amount</a>
  <a id="1043" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#858" class="Function">CResponse</a> <a id="1053" class="Symbol">(</a><a id="1054" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#692" class="InductiveConstructor">callc</a> <a id="1060" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1060" class="Bound">addr</a> <a id="1065" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1065" class="Bound">fname</a> <a id="1071" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1071" class="Bound">msg</a><a id="1074" class="Symbol">)</a> <a id="1076" class="Symbol">=</a> <a id="1078" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a>
  <a id="1084" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#858" class="Function">CResponse</a> <a id="1094" class="Symbol">(</a><a id="1095" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#747" class="InductiveConstructor">transferc</a> <a id="1105" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1105" class="Bound">amount</a> <a id="1112" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1112" class="Bound">addr</a><a id="1116" class="Symbol">)</a> <a id="1118" class="Symbol">=</a> <a id="1120" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>


<a id="1124" class="Comment">--SmartContractExec is datatype of what happens when a function is applied to its arguments.</a>

  <a id="1220" class="Keyword">data</a> <a id="SmartContractExec"></a><a id="1225" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1243" class="Symbol">(</a><a id="1244" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1244" class="Bound">A</a> <a id="1246" class="Symbol">:</a> <a id="1248" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1251" class="Symbol">)</a> <a id="1253" class="Symbol">:</a> <a id="1255" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1259" class="Keyword">where</a>
    <a id="SmartContractExec.return"></a><a id="1269" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a> <a id="1276" class="Symbol">:</a> <a id="1278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1244" class="Bound">A</a> <a id="1280" class="Symbol">→</a> <a id="1282" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1300" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1244" class="Bound">A</a>
    <a id="SmartContractExec.error"></a><a id="1306" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="InductiveConstructor">error</a>  <a id="1313" class="Symbol">:</a> <a id="1315" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#704" class="Datatype">ErrorMsg</a> <a id="1324" class="Symbol">→</a>  <a id="1327" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1345" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1244" class="Bound">A</a>
    <a id="SmartContractExec.exec"></a><a id="1351" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a>  <a id="1357" class="Symbol">:</a> <a id="1359" class="Symbol">(</a><a id="1360" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1360" class="Bound">c</a> <a id="1362" class="Symbol">:</a> <a id="1364" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#528" class="Datatype">CCommands</a><a id="1373" class="Symbol">)</a> <a id="1375" class="Symbol">→</a> <a id="1377" class="Symbol">(</a><a id="1378" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#858" class="Function">CResponse</a> <a id="1388" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1360" class="Bound">c</a> <a id="1390" class="Symbol">→</a> <a id="1392" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1410" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1244" class="Bound">A</a><a id="1411" class="Symbol">)</a> <a id="1413" class="Symbol">→</a> <a id="1415" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1433" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1244" class="Bound">A</a>




<a id="_&gt;&gt;=_"></a><a id="1439" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1439" class="Function Operator">_&gt;&gt;=_</a> <a id="1445" class="Symbol">:</a> <a id="1447" class="Symbol">{</a><a id="1448" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1448" class="Bound">A</a> <a id="1450" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1450" class="Bound">B</a> <a id="1452" class="Symbol">:</a> <a id="1454" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1457" class="Symbol">}</a> <a id="1459" class="Symbol">→</a> <a id="1461" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1479" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1448" class="Bound">A</a> <a id="1481" class="Symbol">→</a> <a id="1483" class="Symbol">(</a><a id="1484" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1448" class="Bound">A</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1506" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1450" class="Bound">B</a><a id="1507" class="Symbol">)</a> <a id="1509" class="Symbol">→</a> <a id="1511" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1529" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1450" class="Bound">B</a>
<a id="1531" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a> <a id="1538" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1538" class="Bound">x</a> <a id="1540" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1439" class="Function Operator">&gt;&gt;=</a> <a id="1544" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1544" class="Bound">q</a> <a id="1546" class="Symbol">=</a> <a id="1548" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1544" class="Bound">q</a> <a id="1550" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1538" class="Bound">x</a>
<a id="1552" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="InductiveConstructor">error</a> <a id="1558" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1558" class="Bound">x</a> <a id="1560" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1439" class="Function Operator">&gt;&gt;=</a> <a id="1564" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1564" class="Bound">q</a> <a id="1566" class="Symbol">=</a> <a id="1568" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="InductiveConstructor">error</a> <a id="1574" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1558" class="Bound">x</a>
<a id="1576" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="1581" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1581" class="Bound">c</a> <a id="1583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1583" class="Bound">x</a> <a id="1585" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1439" class="Function Operator">&gt;&gt;=</a> <a id="1589" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1589" class="Bound">q</a> <a id="1591" class="Symbol">=</a> <a id="1593" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="1598" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1581" class="Bound">c</a> <a id="1600" class="Symbol">(λ</a> <a id="1603" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1603" class="Bound">r</a> <a id="1605" class="Symbol">→</a> <a id="1607" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1583" class="Bound">x</a> <a id="1609" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1603" class="Bound">r</a> <a id="1611" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1439" class="Function Operator">&gt;&gt;=</a> <a id="1615" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1589" class="Bound">q</a><a id="1616" class="Symbol">)</a>


<a id="_&gt;&gt;_"></a><a id="1620" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1620" class="Function Operator">_&gt;&gt;_</a> <a id="1625" class="Symbol">:</a> <a id="1627" class="Symbol">{</a><a id="1628" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1628" class="Bound">A</a> <a id="1630" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1630" class="Bound">B</a> <a id="1632" class="Symbol">:</a> <a id="1634" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1637" class="Symbol">}</a> <a id="1639" class="Symbol">→</a> <a id="1641" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1659" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1628" class="Bound">A</a> <a id="1661" class="Symbol">→</a> <a id="1663" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1681" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1630" class="Bound">B</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1703" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1630" class="Bound">B</a>
<a id="1705" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a> <a id="1712" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1712" class="Bound">x</a> <a id="1714" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1620" class="Function Operator">&gt;&gt;</a> <a id="1717" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1717" class="Bound">q</a> <a id="1719" class="Symbol">=</a> <a id="1721" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1717" class="Bound">q</a>
<a id="1723" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="InductiveConstructor">error</a> <a id="1729" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1729" class="Bound">x</a> <a id="1731" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1620" class="Function Operator">&gt;&gt;</a> <a id="1734" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1734" class="Bound">q</a> <a id="1736" class="Symbol">=</a> <a id="1738" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="InductiveConstructor">error</a> <a id="1744" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1729" class="Bound">x</a>
<a id="1746" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="1751" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1751" class="Bound">c</a> <a id="1753" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1753" class="Bound">x</a> <a id="1755" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1620" class="Function Operator">&gt;&gt;</a> <a id="1758" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1758" class="Bound">q</a> <a id="1760" class="Symbol">=</a> <a id="1762" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="1767" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1751" class="Bound">c</a> <a id="1769" class="Symbol">(λ</a> <a id="1772" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1772" class="Bound">r</a> <a id="1774" class="Symbol">→</a> <a id="1776" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1753" class="Bound">x</a> <a id="1778" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1772" class="Bound">r</a> <a id="1780" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1620" class="Function Operator">&gt;&gt;</a> <a id="1783" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1758" class="Bound">q</a><a id="1784" class="Symbol">)</a>



<a id="1789" class="Comment">-- Definition of simple contract</a>
<a id="1822" class="Keyword">record</a> <a id="Contract"></a><a id="1829" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1829" class="Record">Contract</a> <a id="1838" class="Symbol">:</a> <a id="1840" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1844" class="Keyword">where</a>
  <a id="1852" class="Keyword">constructor</a> <a id="contract"></a><a id="1864" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1864" class="InductiveConstructor">contract</a>
  <a id="1875" class="Keyword">field</a>
    <a id="Contract.amount"></a><a id="1885" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a>   <a id="1894" class="Symbol">:</a> <a id="1896" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#411" class="Function">Amount</a>
    <a id="Contract.fun"></a><a id="1907" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1907" class="Field">fun</a>  <a id="1912" class="Symbol">:</a> <a id="1914" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a> <a id="1927" class="Symbol">→</a> <a id="1929" class="Symbol">(</a><a id="1930" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="1934" class="Symbol">→</a> <a id="1936" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="1954" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a><a id="1957" class="Symbol">)</a>

<a id="1960" class="Keyword">open</a> <a id="1965" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1829" class="Module">Contract</a> <a id="1974" class="Keyword">public</a>


<a id="1983" class="Comment">-- ledger</a>
<a id="Ledger"></a><a id="1993" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="2000" class="Symbol">:</a> <a id="2002" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2006" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="2013" class="Symbol">=</a> <a id="2015" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>  <a id="2024" class="Symbol">→</a> <a id="2026" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1829" class="Record">Contract</a>



<a id="2038" class="Comment">--- theses functions below we use them with do notation</a>

<a id="call"></a><a id="2095" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2095" class="Function">call</a> <a id="2100" class="Symbol">:</a> <a id="2102" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>  <a id="2111" class="Symbol">→</a> <a id="2113" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a> <a id="2126" class="Symbol">→</a> <a id="2128" class="Symbol">(</a><a id="2129" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="2133" class="Symbol">→</a> <a id="2135" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="2153" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a><a id="2156" class="Symbol">)</a>
<a id="2158" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2095" class="Function">call</a> <a id="2163" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2163" class="Bound">addr</a> <a id="2168" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2168" class="Bound">fname</a> <a id="2174" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2174" class="Bound">msg</a> <a id="2178" class="Symbol">=</a> <a id="2180" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="2185" class="Symbol">(</a><a id="2186" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#692" class="InductiveConstructor">callc</a> <a id="2192" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2163" class="Bound">addr</a> <a id="2197" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2168" class="Bound">fname</a> <a id="2203" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2174" class="Bound">msg</a><a id="2206" class="Symbol">)</a> <a id="2208" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a>

<a id="update"></a><a id="2216" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2216" class="Function">update</a> <a id="2223" class="Symbol">:</a> <a id="2225" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a> <a id="2238" class="Symbol">→</a> <a id="2240" class="Symbol">(</a><a id="2241" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="2245" class="Symbol">→</a> <a id="2247" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="2265" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a><a id="2268" class="Symbol">)</a> <a id="2270" class="Symbol">→</a> <a id="2272" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="2290" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="2292" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2216" class="Function">update</a> <a id="2299" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2299" class="Bound">fname</a> <a id="2305" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2305" class="Bound">fdef</a> <a id="2310" class="Symbol">=</a> <a id="2312" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="2317" class="Symbol">(</a><a id="2318" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#554" class="InductiveConstructor">updatec</a> <a id="2326" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2299" class="Bound">fname</a> <a id="2332" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2305" class="Bound">fdef</a><a id="2336" class="Symbol">)</a> <a id="2338" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a>

<a id="currentAddrLookup"></a><a id="2346" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2346" class="Function">currentAddrLookup</a> <a id="2364" class="Symbol">:</a> <a id="2366" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="2384" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>
<a id="2392" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2346" class="Function">currentAddrLookup</a> <a id="2410" class="Symbol">=</a> <a id="2412" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="2417" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#625" class="InductiveConstructor">currentAddrLookupc</a> <a id="2436" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a>

<a id="callAddrLookup"></a><a id="2444" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2444" class="Function">callAddrLookup</a> <a id="2459" class="Symbol">:</a> <a id="2461" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="2479" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>
<a id="2487" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2444" class="Function">callAddrLookup</a> <a id="2502" class="Symbol">=</a> <a id="2504" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="2509" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#660" class="InductiveConstructor">callAddrLookupc</a> <a id="2525" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a>

<a id="transfer"></a><a id="2533" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2533" class="Function">transfer</a> <a id="2542" class="Symbol">:</a> <a id="2544" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#411" class="Function">Amount</a> <a id="2551" class="Symbol">→</a> <a id="2553" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a> <a id="2561" class="Symbol">→</a> <a id="2563" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="2581" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="2583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2533" class="Function">transfer</a> <a id="2592" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2592" class="Bound">amount</a> <a id="2599" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2599" class="Bound">addr</a> <a id="2604" class="Symbol">=</a>  <a id="2607" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="InductiveConstructor">exec</a> <a id="2612" class="Symbol">(</a><a id="2613" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#747" class="InductiveConstructor">transferc</a> <a id="2623" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2592" class="Bound">amount</a> <a id="2630" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2599" class="Bound">addr</a><a id="2634" class="Symbol">)</a> <a id="2636" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a>



<a id="2646" class="Comment">-- definition of execution stack elements</a>
<a id="2688" class="Keyword">record</a> <a id="ExecStackEl"></a><a id="2695" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2695" class="Record">ExecStackEl</a> <a id="2707" class="Symbol">:</a> <a id="2709" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2713" class="Keyword">where</a>
  <a id="2721" class="Keyword">constructor</a> <a id="execStackEl"></a><a id="2733" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2733" class="InductiveConstructor">execStackEl</a>
  <a id="2747" class="Keyword">field</a>
    <a id="ExecStackEl.callAddress"></a><a id="2757" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2757" class="Field">callAddress</a>    <a id="2772" class="Symbol">:</a> <a id="2774" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>   <a id="2784" class="Comment">--address for the last call</a>
    <a id="ExecStackEl.currentAddress"></a><a id="2816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2816" class="Field">currentAddress</a> <a id="2831" class="Symbol">:</a> <a id="2833" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>   <a id="2843" class="Comment">--current address where we are in</a>
    <a id="ExecStackEl.continuation"></a><a id="2881" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2881" class="Field">continuation</a>   <a id="2896" class="Symbol">:</a> <a id="2898" class="Symbol">(</a><a id="2899" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="2903" class="Symbol">→</a> <a id="2905" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="2923" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a><a id="2926" class="Symbol">)</a>
<a id="2928" class="Keyword">open</a> <a id="2933" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2695" class="Module">ExecStackEl</a> <a id="2945" class="Keyword">public</a>



<a id="2955" class="Comment">-- defintion of execution stack function</a>
<a id="ExecutionStack"></a><a id="2996" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2996" class="Function">ExecutionStack</a> <a id="3011" class="Symbol">:</a> <a id="3013" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3017" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2996" class="Function">ExecutionStack</a> <a id="3032" class="Symbol">=</a> <a id="3034" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3039" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2695" class="Record">ExecStackEl</a>





<a id="3056" class="Comment">{- StateExecFun (state execution function) is an intermediate state when we are evaluating a function call
   in a contract
   it consists of
        - the ledger  (which might changed because of updates)
        - executionStack  contains partially evaluated calls to other contracts together with their addresses
        - the current address
        - and the currently partially evaluated function we are evaluating
-}</a>
<a id="3479" class="Keyword">record</a> <a id="StateExecFun"></a><a id="3486" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a> <a id="3499" class="Symbol">:</a> <a id="3501" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3505" class="Keyword">where</a>
  <a id="3513" class="Keyword">constructor</a> <a id="stateEF"></a><a id="3525" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a>
  <a id="3535" class="Keyword">field</a>
    <a id="StateExecFun.ledger"></a><a id="3545" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3545" class="Field">ledger</a> <a id="3552" class="Symbol">:</a> <a id="3554" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a>
    <a id="StateExecFun.executionStack"></a><a id="3565" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3565" class="Field">executionStack</a> <a id="3580" class="Symbol">:</a> <a id="3582" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2996" class="Function">ExecutionStack</a>
    <a id="StateExecFun.callAddress"></a><a id="3601" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3601" class="Field">callAddress</a>        <a id="3620" class="Symbol">:</a> <a id="3622" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>
    <a id="StateExecFun.currentAddress"></a><a id="3634" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3634" class="Field">currentAddress</a>        <a id="3656" class="Symbol">:</a> <a id="3658" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>  
    <a id="StateExecFun.nextstep"></a><a id="3672" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3672" class="Field">nextstep</a>       <a id="3687" class="Symbol">:</a> <a id="3689" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="3707" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a>
<a id="3711" class="Keyword">open</a> <a id="3716" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Module">StateExecFun</a> <a id="3729" class="Keyword">public</a>


<a id="3738" class="Comment">--update ledger</a>
<a id="updateLedger"></a><a id="3754" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3754" class="Function">updateLedger</a> <a id="3767" class="Symbol">:</a> <a id="3769" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="3776" class="Symbol">→</a>  <a id="3779" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>
               <a id="3802" class="Symbol">→</a> <a id="3804" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a> <a id="3817" class="Symbol">→</a> <a id="3819" class="Symbol">(</a><a id="3820" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="3824" class="Symbol">→</a> <a id="3826" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="3844" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a><a id="3847" class="Symbol">)</a>
               <a id="3864" class="Symbol">→</a> <a id="3866" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a>
<a id="3873" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3754" class="Function">updateLedger</a> <a id="3886" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3886" class="Bound">ledger</a> <a id="3893" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3893" class="Bound">changedAddr</a> <a id="3905" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3905" class="Bound">changedFname</a> <a id="3918" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3918" class="Bound">f</a> <a id="3920" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3920" class="Bound">a</a> <a id="3922" class="Symbol">.</a><a id="3923" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a> <a id="3930" class="Symbol">=</a> <a id="3932" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3886" class="Bound">ledger</a> <a id="3939" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3920" class="Bound">a</a> <a id="3941" class="Symbol">.</a><a id="3942" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a>
<a id="3949" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3754" class="Function">updateLedger</a> <a id="3962" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3962" class="Bound">ledger</a> <a id="3969" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3969" class="Bound">changedAddr</a> <a id="3981" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3981" class="Bound">changedFname</a> <a id="3994" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3994" class="Bound">f</a> <a id="3996" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3996" class="Bound">a</a> <a id="3998" class="Symbol">.</a><a id="3999" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1907" class="Field">fun</a> <a id="4003" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4003" class="Bound">fname</a>
         <a id="4018" class="Symbol">=</a> <a id="4020" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4023" class="Symbol">(</a><a id="4024" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3996" class="Bound">a</a> <a id="4026" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="4029" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3969" class="Bound">changedAddr</a><a id="4040" class="Symbol">)</a> <a id="4042" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="4044" class="Symbol">(</a><a id="4045" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4003" class="Bound">fname</a> <a id="4051" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#307" class="Function Operator">≡fun</a> <a id="4056" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3981" class="Bound">changedFname</a><a id="4068" class="Symbol">)</a>
            <a id="4082" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4087" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3994" class="Bound">f</a> <a id="4089" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4094" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3962" class="Bound">ledger</a> <a id="4101" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3996" class="Bound">a</a> <a id="4103" class="Symbol">.</a><a id="4104" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1907" class="Field">fun</a> <a id="4108" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4003" class="Bound">fname</a>

<a id="4115" class="Comment">--update ledger amount </a>
<a id="updateLedgerAmount"></a><a id="4139" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4139" class="Function">updateLedgerAmount</a> <a id="4158" class="Symbol">:</a> <a id="4160" class="Symbol">(</a><a id="4161" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4161" class="Bound">ledger</a> <a id="4168" class="Symbol">:</a> <a id="4170" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a><a id="4176" class="Symbol">)</a>
                 <a id="4195" class="Symbol">→</a> <a id="4197" class="Symbol">(</a><a id="4198" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4198" class="Bound">currentAddr</a> <a id="4210" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4210" class="Bound">destinationAddr</a> <a id="4226" class="Symbol">:</a> <a id="4228" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a><a id="4235" class="Symbol">)</a>
                    <a id="4257" class="Symbol">(</a><a id="4258" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4258" class="Bound">amount&#39;</a> <a id="4266" class="Symbol">:</a> <a id="4268" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#411" class="Function">Amount</a><a id="4274" class="Symbol">)</a>
                 <a id="4293" class="Symbol">→</a> <a id="4295" class="Symbol">(</a><a id="4296" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4296" class="Bound">correctAmount</a> <a id="4310" class="Symbol">:</a> <a id="4312" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4258" class="Bound">amount&#39;</a> <a id="4320" href="libraries.natCompare.html#436" class="Function Operator">≦r</a>  <a id="4324" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4161" class="Bound">ledger</a> <a id="4331" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4198" class="Bound">currentAddr</a> <a id="4343" class="Symbol">.</a><a id="4344" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a><a id="4350" class="Symbol">)</a>
                  <a id="4370" class="Symbol">→</a> <a id="4372" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a>
<a id="4379" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4139" class="Function">updateLedgerAmount</a> <a id="4398" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4398" class="Bound">ledger</a> <a id="4405" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4405" class="Bound">currentAddr</a> <a id="4417" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4417" class="Bound">destinationAddr</a> <a id="4433" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4433" class="Bound">amount&#39;</a> <a id="4441" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4441" class="Bound">correctAmount</a> <a id="4455" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4455" class="Bound">addr</a> <a id="4460" class="Symbol">.</a><a id="4461" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a> <a id="4468" class="Symbol">=</a>
     <a id="4475" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4478" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4455" class="Bound">addr</a> <a id="4483" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="4486" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4405" class="Bound">currentAddr</a>
     <a id="4503" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4508" href="libraries.natCompare.html#1454" class="Function">subtract</a> <a id="4517" class="Symbol">(</a><a id="4518" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4398" class="Bound">ledger</a> <a id="4525" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4405" class="Bound">currentAddr</a> <a id="4537" class="Symbol">.</a><a id="4538" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a><a id="4544" class="Symbol">)</a> <a id="4546" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4433" class="Bound">amount&#39;</a> <a id="4554" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4441" class="Bound">correctAmount</a>
     <a id="4573" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4578" class="Symbol">(</a><a id="4579" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4582" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4455" class="Bound">addr</a> <a id="4587" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="4590" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4417" class="Bound">destinationAddr</a>
     <a id="4611" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4616" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4398" class="Bound">ledger</a> <a id="4623" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4417" class="Bound">destinationAddr</a> <a id="4639" class="Symbol">.</a><a id="4640" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a> <a id="4647" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4649" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4433" class="Bound">amount&#39;</a>
     <a id="4662" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4667" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4398" class="Bound">ledger</a> <a id="4674" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4455" class="Bound">addr</a> <a id="4679" class="Symbol">.</a><a id="4680" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a><a id="4686" class="Symbol">)</a>
<a id="4688" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4139" class="Function">updateLedgerAmount</a> <a id="4707" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4707" class="Bound">ledger</a> <a id="4714" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4714" class="Bound">currentAddr</a> <a id="4726" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4726" class="Bound">newAddr</a> <a id="4734" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4734" class="Bound">amount&#39;</a> <a id="4742" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4742" class="Bound">correctAmount</a> <a id="4756" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4756" class="Bound">addr</a> <a id="4761" class="Symbol">.</a><a id="4762" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1907" class="Field">fun</a> <a id="4766" class="Symbol">=</a>
    <a id="4772" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4707" class="Bound">ledger</a> <a id="4779" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4756" class="Bound">addr</a> <a id="4784" class="Symbol">.</a><a id="4785" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1907" class="Field">fun</a>


<a id="4791" class="Comment">-- definition of execute transfer auxiliary</a>
<a id="executeTransferAux"></a><a id="4835" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4835" class="Function">executeTransferAux</a> <a id="4854" class="Symbol">:</a> <a id="4856" class="Symbol">(</a><a id="4857" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4857" class="Bound">oldLedger</a> <a id="4867" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4867" class="Bound">currentLedger</a> <a id="4881" class="Symbol">:</a> <a id="4883" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a><a id="4889" class="Symbol">)</a>
                  <a id="4909" class="Symbol">→</a> <a id="4911" class="Symbol">(</a><a id="4912" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4912" class="Bound">executionStack</a> <a id="4927" class="Symbol">:</a> <a id="4929" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2996" class="Function">ExecutionStack</a><a id="4943" class="Symbol">)</a>
                  <a id="4963" class="Symbol">→</a> <a id="4965" class="Symbol">(</a><a id="4966" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4966" class="Bound">callAddr</a> <a id="4975" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4975" class="Bound">currentAddr</a> <a id="4987" class="Symbol">:</a> <a id="4989" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a><a id="4996" class="Symbol">)</a>
                  <a id="5016" class="Symbol">→</a> <a id="5018" class="Symbol">(</a><a id="5019" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5019" class="Bound">amount&#39;</a> <a id="5027" class="Symbol">:</a> <a id="5029" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#411" class="Function">Amount</a><a id="5035" class="Symbol">)</a>
                  <a id="5055" class="Symbol">→</a> <a id="5057" class="Symbol">(</a><a id="5058" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5058" class="Bound">destinationAddr</a> <a id="5074" class="Symbol">:</a> <a id="5076" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a><a id="5083" class="Symbol">)</a>
                  <a id="5103" class="Symbol">→</a> <a id="5105" class="Symbol">(</a><a id="5106" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5106" class="Bound">cont</a> <a id="5111" class="Symbol">:</a> <a id="5113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="5131" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a><a id="5134" class="Symbol">)</a>
                  <a id="5154" class="Symbol">→</a> <a id="5156" class="Symbol">(</a><a id="5157" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5157" class="Bound">cp</a>  <a id="5161" class="Symbol">:</a> <a id="5163" href="libraries.natCompare.html#604" class="Datatype">OrderingLeq</a> <a id="5175" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5019" class="Bound">amount&#39;</a> <a id="5183" class="Symbol">(</a><a id="5184" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4867" class="Bound">currentLedger</a> <a id="5198" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4975" class="Bound">currentAddr</a> <a id="5210" class="Symbol">.</a><a id="5211" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a>  <a id="5219" class="Symbol">))</a>
                  <a id="5240" class="Symbol">→</a> <a id="5242" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a>
<a id="5255" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4835" class="Function">executeTransferAux</a> <a id="5274" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5274" class="Bound">oldLedger</a> <a id="5284" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5284" class="Bound">currentLedger</a> <a id="5298" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5298" class="Bound">executionStack</a> <a id="5313" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5313" class="Bound">callAddr</a> <a id="5322" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5322" class="Bound">currentAddr</a> <a id="5334" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5334" class="Bound">amount&#39;</a> <a id="5342" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5342" class="Bound">destinationAddr</a> <a id="5358" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5358" class="Bound">cont</a> <a id="5363" class="Symbol">(</a><a id="5364" href="libraries.natCompare.html#642" class="InductiveConstructor">leq</a> <a id="5368" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5368" class="Bound">x</a><a id="5369" class="Symbol">)</a> <a id="5371" class="Symbol">=</a>
          <a id="5383" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="5391" class="Symbol">(</a><a id="5392" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4139" class="Function">updateLedgerAmount</a> <a id="5411" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5284" class="Bound">currentLedger</a> <a id="5425" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5322" class="Bound">currentAddr</a> <a id="5437" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5342" class="Bound">destinationAddr</a> <a id="5453" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5334" class="Bound">amount&#39;</a> <a id="5461" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5368" class="Bound">x</a><a id="5462" class="Symbol">)</a>
             <a id="5477" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5298" class="Bound">executionStack</a> <a id="5492" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5313" class="Bound">callAddr</a> <a id="5501" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5322" class="Bound">currentAddr</a> <a id="5513" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5358" class="Bound">cont</a>

<a id="5519" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4835" class="Function">executeTransferAux</a> <a id="5538" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5538" class="Bound">oldLedger</a> <a id="5548" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5548" class="Bound">currentLedger</a> <a id="5562" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5562" class="Bound">executionStack</a> <a id="5577" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5577" class="Bound">callAddr</a> <a id="5586" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5586" class="Bound">currentAddr</a> <a id="5598" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5598" class="Bound">amount</a> <a id="5605" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5605" class="Bound">destinationAddr</a> <a id="5621" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5621" class="Bound">cont</a> <a id="5626" class="Symbol">(</a><a id="5627" href="libraries.natCompare.html#680" class="InductiveConstructor">greater</a> <a id="5635" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5635" class="Bound">x</a><a id="5636" class="Symbol">)</a> <a id="5638" class="Symbol">=</a>
         <a id="5649" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="5657" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5538" class="Bound">oldLedger</a> <a id="5667" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5562" class="Bound">executionStack</a> <a id="5682" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5577" class="Bound">callAddr</a> <a id="5691" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5586" class="Bound">currentAddr</a>
             <a id="5716" class="Symbol">(</a><a id="5717" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="InductiveConstructor">error</a> <a id="5723" class="Symbol">(</a><a id="5724" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#727" class="InductiveConstructor">strErr</a> <a id="5731" class="String">&quot;not enough money&quot;</a><a id="5749" class="Symbol">))</a>

<a id="5753" class="Comment">-- definition of execute transfer</a>
<a id="executeTransfer"></a><a id="5787" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5787" class="Function">executeTransfer</a> <a id="5803" class="Symbol">:</a> <a id="5805" class="Symbol">(</a><a id="5806" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5806" class="Bound">oldLedger</a> <a id="5816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5816" class="Bound">currentLedger</a> <a id="5830" class="Symbol">:</a> <a id="5832" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a><a id="5838" class="Symbol">)</a>
                  <a id="5858" class="Symbol">→</a> <a id="5860" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2996" class="Function">ExecutionStack</a>
                  <a id="5893" class="Symbol">→</a> <a id="5895" class="Symbol">(</a><a id="5896" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5896" class="Bound">callAddr</a> <a id="5905" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5905" class="Bound">currentAddr</a> <a id="5917" class="Symbol">:</a> <a id="5919" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a><a id="5926" class="Symbol">)</a>
                  <a id="5946" class="Symbol">→</a> <a id="5948" class="Symbol">(</a><a id="5949" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5949" class="Bound">amount&#39;</a> <a id="5957" class="Symbol">:</a> <a id="5959" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#411" class="Function">Amount</a><a id="5965" class="Symbol">)</a>
                  <a id="5985" class="Symbol">→</a> <a id="5987" class="Symbol">(</a><a id="5988" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5988" class="Bound">destinationAddr</a> <a id="6004" class="Symbol">:</a> <a id="6006" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a><a id="6013" class="Symbol">)</a>
                  <a id="6033" class="Symbol">→</a> <a id="6035" class="Symbol">(</a><a id="6036" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6036" class="Bound">cont</a> <a id="6041" class="Symbol">:</a> <a id="6043" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1225" class="Datatype">SmartContractExec</a> <a id="6061" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a><a id="6064" class="Symbol">)</a>
                  <a id="6084" class="Symbol">→</a> <a id="6086" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a>
<a id="6099" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5787" class="Function">executeTransfer</a> <a id="6115" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6115" class="Bound">oldLedger</a> <a id="6125" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6125" class="Bound">currentLedger</a> <a id="6139" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6139" class="Bound">exexecutionStack</a> <a id="6156" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6156" class="Bound">callAddr</a> <a id="6165" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6165" class="Bound">currentAddr</a> <a id="6177" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6177" class="Bound">amount&#39;</a> <a id="6185" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6185" class="Bound">destinationAddr</a> <a id="6201" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6201" class="Bound">cont</a>
                <a id="6222" class="Symbol">=</a> <a id="6224" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4835" class="Function">executeTransferAux</a> <a id="6243" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6115" class="Bound">oldLedger</a> <a id="6253" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6125" class="Bound">currentLedger</a> <a id="6267" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6139" class="Bound">exexecutionStack</a> <a id="6284" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6156" class="Bound">callAddr</a> <a id="6293" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6165" class="Bound">currentAddr</a> <a id="6305" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6177" class="Bound">amount&#39;</a>
                   <a id="6332" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6185" class="Bound">destinationAddr</a> <a id="6348" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6201" class="Bound">cont</a>  <a id="6354" class="Symbol">(</a><a id="6355" href="libraries.natCompare.html#861" class="Function">compareLeq</a> <a id="6366" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6177" class="Bound">amount&#39;</a> <a id="6374" class="Symbol">(</a><a id="6375" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6125" class="Bound">currentLedger</a> <a id="6389" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6165" class="Bound">currentAddr</a> <a id="6401" class="Symbol">.</a><a id="6402" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a>  <a id="6410" class="Symbol">))</a>

<a id="6414" class="Comment">-- definition of stepEF</a>
<a id="stepEF"></a><a id="6438" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="Function">stepEF</a> <a id="6445" class="Symbol">:</a> <a id="6447" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="6454" class="Symbol">→</a> <a id="6456" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a> <a id="6469" class="Symbol">→</a> <a id="6471" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a>
<a id="6484" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="Function">stepEF</a> <a id="6491" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6491" class="Bound">oldLedger</a> <a id="6501" class="Symbol">(</a><a id="6502" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="6510" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6510" class="Bound">currentLedger</a> <a id="6524" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6527" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6527" class="Bound">callAddr</a> <a id="6536" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6536" class="Bound">currentAddr</a> <a id="6548" class="Symbol">(</a><a id="6549" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a> <a id="6556" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6556" class="Bound">result</a><a id="6562" class="Symbol">))</a>
       <a id="6572" class="Symbol">=</a> <a id="6574" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="6582" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6510" class="Bound">currentLedger</a>  <a id="6597" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6600" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6527" class="Bound">callAddr</a> <a id="6609" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6536" class="Bound">currentAddr</a> <a id="6621" class="Symbol">(</a><a id="6622" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a> <a id="6629" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6556" class="Bound">result</a><a id="6635" class="Symbol">)</a>
<a id="6637" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="Function">stepEF</a> <a id="6644" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6644" class="Bound">oldLedger</a> <a id="6654" class="Symbol">(</a><a id="6655" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="6663" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6663" class="Bound">currentLedger</a> <a id="6677" class="Symbol">(</a><a id="6678" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6678" class="Bound">execSEl</a> <a id="6686" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6688" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6688" class="Bound">executionStack</a><a id="6702" class="Symbol">)</a> <a id="6704" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6704" class="Bound">callAddr</a> <a id="6713" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6713" class="Bound">currentAddr</a> <a id="6725" class="Symbol">(</a><a id="6726" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a> <a id="6733" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6733" class="Bound">result</a><a id="6739" class="Symbol">))</a>
       <a id="6749" class="Symbol">=</a> <a id="6751" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="6759" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6663" class="Bound">currentLedger</a> <a id="6773" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6688" class="Bound">executionStack</a> <a id="6788" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6704" class="Bound">callAddr</a>  <a id="6798" class="Symbol">(</a><a id="6799" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6678" class="Bound">execSEl</a> <a id="6807" class="Symbol">.</a><a id="6808" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2816" class="Field">currentAddress</a><a id="6822" class="Symbol">)</a> <a id="6824" class="Symbol">(</a><a id="6825" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6678" class="Bound">execSEl</a> <a id="6833" class="Symbol">.</a><a id="6834" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2881" class="Field">continuation</a> <a id="6847" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6733" class="Bound">result</a><a id="6853" class="Symbol">)</a>
<a id="6855" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="CatchallClause Function">stepEF</a><a id="6861" class="CatchallClause"> </a><a id="6862" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6862" class="CatchallClause Bound">oldLedger</a><a id="6871" class="CatchallClause"> </a><a id="6872" class="CatchallClause Symbol">(</a><a id="6873" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="6880" class="CatchallClause"> </a><a id="6881" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6881" class="CatchallClause Bound">currentLedger</a><a id="6894" class="CatchallClause"> </a><a id="6895" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6895" class="CatchallClause Bound">executionStack</a><a id="6909" class="CatchallClause"> </a><a id="6910" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6910" class="CatchallClause Bound">callAddr</a><a id="6918" class="CatchallClause"> </a><a id="6919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6919" class="CatchallClause Bound">currentAddr</a><a id="6930" class="CatchallClause"> </a><a id="6931" class="CatchallClause Symbol">(</a><a id="6932" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="CatchallClause InductiveConstructor">exec</a><a id="6936" class="CatchallClause"> </a><a id="6937" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#625" class="CatchallClause InductiveConstructor">currentAddrLookupc</a><a id="6955" class="CatchallClause"> </a><a id="6956" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6956" class="CatchallClause Bound">cont</a><a id="6960" class="CatchallClause Symbol">))</a>
       <a id="6970" class="Symbol">=</a> <a id="6972" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="6980" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6881" class="Bound">currentLedger</a> <a id="6994" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6895" class="Bound">executionStack</a> <a id="7009" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6910" class="Bound">callAddr</a> <a id="7018" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6919" class="Bound">currentAddr</a> <a id="7030" class="Symbol">(</a><a id="7031" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6956" class="Bound">cont</a> <a id="7036" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6919" class="Bound">currentAddr</a><a id="7047" class="Symbol">)</a>
<a id="7049" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="CatchallClause Function">stepEF</a><a id="7055" class="CatchallClause"> </a><a id="7056" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7056" class="CatchallClause Bound">oldLedger</a><a id="7065" class="CatchallClause"> </a><a id="7066" class="CatchallClause Symbol">(</a><a id="7067" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="7074" class="CatchallClause"> </a><a id="7075" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7075" class="CatchallClause Bound">currentLedger</a><a id="7088" class="CatchallClause"> </a><a id="7089" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7089" class="CatchallClause Bound">executionStack</a><a id="7103" class="CatchallClause"> </a><a id="7104" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7104" class="CatchallClause Bound">callAddr</a><a id="7112" class="CatchallClause"> </a><a id="7113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7113" class="CatchallClause Bound">currentAddr</a><a id="7124" class="CatchallClause"> </a><a id="7125" class="CatchallClause Symbol">(</a><a id="7126" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="CatchallClause InductiveConstructor">exec</a><a id="7130" class="CatchallClause"> </a><a id="7131" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#660" class="CatchallClause InductiveConstructor">callAddrLookupc</a><a id="7146" class="CatchallClause"> </a><a id="7147" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7147" class="CatchallClause Bound">cont</a><a id="7151" class="CatchallClause Symbol">))</a>
       <a id="7161" class="Symbol">=</a> <a id="7163" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="7171" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7075" class="Bound">currentLedger</a> <a id="7185" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7089" class="Bound">executionStack</a> <a id="7200" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7104" class="Bound">callAddr</a> <a id="7209" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7113" class="Bound">currentAddr</a> <a id="7221" class="Symbol">(</a><a id="7222" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7147" class="Bound">cont</a> <a id="7227" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7104" class="Bound">callAddr</a><a id="7235" class="Symbol">)</a>
<a id="7237" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="CatchallClause Function">stepEF</a><a id="7243" class="CatchallClause"> </a><a id="7244" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7244" class="CatchallClause Bound">oldLedger</a><a id="7253" class="CatchallClause"> </a><a id="7254" class="CatchallClause Symbol">(</a><a id="7255" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="7262" class="CatchallClause"> </a><a id="7263" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7263" class="CatchallClause Bound">currentLedger</a><a id="7276" class="CatchallClause"> </a><a id="7277" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7277" class="CatchallClause Bound">executionStack</a><a id="7291" class="CatchallClause"> </a><a id="7292" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7292" class="CatchallClause Bound">callAddr</a><a id="7300" class="CatchallClause"> </a><a id="7301" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7301" class="CatchallClause Bound">currentAddr</a>
                            <a id="7341" class="CatchallClause Symbol">(</a><a id="7342" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="CatchallClause InductiveConstructor">exec</a><a id="7346" class="CatchallClause"> </a><a id="7347" class="CatchallClause Symbol">(</a><a id="7348" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#554" class="CatchallClause InductiveConstructor">updatec</a><a id="7355" class="CatchallClause"> </a><a id="7356" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7356" class="CatchallClause Bound">changedFname</a><a id="7368" class="CatchallClause"> </a><a id="7369" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7369" class="CatchallClause Bound">changedFdef</a><a id="7380" class="CatchallClause Symbol">)</a><a id="7381" class="CatchallClause"> </a><a id="7382" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7382" class="CatchallClause Bound">cont</a><a id="7386" class="CatchallClause Symbol">))</a>
       <a id="7396" class="Symbol">=</a> <a id="7398" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="7406" class="Symbol">(</a><a id="7407" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3754" class="Function">updateLedger</a> <a id="7420" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7263" class="Bound">currentLedger</a> <a id="7434" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7301" class="Bound">currentAddr</a> <a id="7446" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7356" class="Bound">changedFname</a> <a id="7459" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7369" class="Bound">changedFdef</a><a id="7470" class="Symbol">)</a>
                   <a id="7491" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7277" class="Bound">executionStack</a> <a id="7506" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7292" class="Bound">callAddr</a> <a id="7515" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7301" class="Bound">currentAddr</a> <a id="7527" class="Symbol">(</a><a id="7528" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7382" class="Bound">cont</a> <a id="7533" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="7535" class="Symbol">)</a>
<a id="7537" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="CatchallClause Function">stepEF</a><a id="7543" class="CatchallClause"> </a><a id="7544" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7544" class="CatchallClause Bound">oldLedger</a><a id="7553" class="CatchallClause"> </a><a id="7554" class="CatchallClause Symbol">(</a><a id="7555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="7562" class="CatchallClause"> </a><a id="7563" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7563" class="CatchallClause Bound">currentLedger</a><a id="7576" class="CatchallClause"> </a><a id="7577" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7577" class="CatchallClause Bound">executionStack</a><a id="7591" class="CatchallClause"> </a><a id="7592" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7592" class="CatchallClause Bound">oldCalladdr</a><a id="7603" class="CatchallClause"> </a><a id="7604" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7604" class="CatchallClause Bound">oldCurrentAddr</a><a id="7618" class="CatchallClause"> </a><a id="7619" class="CatchallClause Symbol">(</a><a id="7620" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="CatchallClause InductiveConstructor">exec</a><a id="7624" class="CatchallClause"> </a><a id="7625" class="CatchallClause Symbol">(</a><a id="7626" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#692" class="CatchallClause InductiveConstructor">callc</a><a id="7631" class="CatchallClause"> </a><a id="7632" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7632" class="CatchallClause Bound">newaddr</a><a id="7639" class="CatchallClause"> </a><a id="7640" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7640" class="CatchallClause Bound">fname</a><a id="7645" class="CatchallClause"> </a><a id="7646" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7646" class="CatchallClause Bound">msg</a><a id="7649" class="CatchallClause Symbol">)</a><a id="7650" class="CatchallClause"> </a><a id="7651" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7651" class="CatchallClause Bound">cont</a><a id="7655" class="CatchallClause Symbol">))</a>
       <a id="7665" class="Symbol">=</a> <a id="7667" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="7675" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7563" class="Bound">currentLedger</a> <a id="7689" class="Symbol">(</a><a id="7690" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2733" class="InductiveConstructor">execStackEl</a> <a id="7702" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7592" class="Bound">oldCalladdr</a> <a id="7714" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7604" class="Bound">oldCurrentAddr</a> <a id="7729" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7651" class="Bound">cont</a>  <a id="7735" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7737" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7577" class="Bound">executionStack</a><a id="7751" class="Symbol">)</a>  <a id="7754" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7604" class="Bound">oldCurrentAddr</a> <a id="7769" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7632" class="Bound">newaddr</a>
                   <a id="7796" class="Symbol">(</a><a id="7797" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7563" class="Bound">currentLedger</a> <a id="7811" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7632" class="Bound">newaddr</a> <a id="7819" class="Symbol">.</a><a id="7820" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1907" class="Field">fun</a> <a id="7824" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7640" class="Bound">fname</a> <a id="7830" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7646" class="Bound">msg</a><a id="7833" class="Symbol">)</a>

<a id="7836" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="CatchallClause Function">stepEF</a><a id="7842" class="CatchallClause"> </a><a id="7843" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7843" class="CatchallClause Bound">oldLedger</a><a id="7852" class="CatchallClause"> </a><a id="7853" class="CatchallClause Symbol">(</a><a id="7854" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="7861" class="CatchallClause"> </a><a id="7862" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7862" class="CatchallClause Bound">currentLedger</a><a id="7875" class="CatchallClause"> </a><a id="7876" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7876" class="CatchallClause Bound">executionStack</a><a id="7890" class="CatchallClause"> </a><a id="7891" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7891" class="CatchallClause Bound">callAddr</a><a id="7899" class="CatchallClause"> </a><a id="7900" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7900" class="CatchallClause Bound">currentAddr</a><a id="7911" class="CatchallClause"> </a><a id="7912" class="CatchallClause Symbol">(</a><a id="7913" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="CatchallClause InductiveConstructor">exec</a><a id="7917" class="CatchallClause"> </a><a id="7918" class="CatchallClause Symbol">(</a><a id="7919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#747" class="CatchallClause InductiveConstructor">transferc</a><a id="7928" class="CatchallClause"> </a><a id="7929" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7929" class="CatchallClause Bound">amount</a><a id="7935" class="CatchallClause"> </a><a id="7936" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7936" class="CatchallClause Bound">destinationAddr</a><a id="7951" class="CatchallClause"> </a><a id="7952" class="CatchallClause Symbol">)</a><a id="7953" class="CatchallClause"> </a><a id="7954" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7954" class="CatchallClause Bound">cont</a><a id="7958" class="CatchallClause Symbol">))</a>
       <a id="7968" class="Symbol">=</a> <a id="7970" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5787" class="Function">executeTransfer</a> <a id="7986" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7843" class="Bound">oldLedger</a> <a id="7996" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7862" class="Bound">currentLedger</a> <a id="8010" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7876" class="Bound">executionStack</a> <a id="8025" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7891" class="Bound">callAddr</a> <a id="8034" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7900" class="Bound">currentAddr</a> <a id="8046" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7929" class="Bound">amount</a> <a id="8053" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7936" class="Bound">destinationAddr</a> <a id="8069" class="Symbol">(</a><a id="8070" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7954" class="Bound">cont</a> <a id="8075" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="8077" class="Symbol">)</a> 
<a id="8080" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="CatchallClause Function">stepEF</a><a id="8086" class="CatchallClause"> </a><a id="8087" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8087" class="CatchallClause Bound">oldLedger</a><a id="8096" class="CatchallClause"> </a><a id="8097" class="CatchallClause Symbol">(</a><a id="8098" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="8105" class="CatchallClause"> </a><a id="8106" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8106" class="CatchallClause Bound">currentLedger</a><a id="8119" class="CatchallClause"> </a><a id="8120" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8120" class="CatchallClause Bound">executionStack</a><a id="8134" class="CatchallClause"> </a><a id="8135" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8135" class="CatchallClause Bound">callAddr</a><a id="8143" class="CatchallClause"> </a><a id="8144" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8144" class="CatchallClause Bound">currentAddr</a><a id="8155" class="CatchallClause"> </a><a id="8156" class="CatchallClause Symbol">(</a><a id="8157" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1351" class="CatchallClause InductiveConstructor">exec</a><a id="8161" class="CatchallClause"> </a><a id="8162" class="CatchallClause Symbol">(</a><a id="8163" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#793" class="CatchallClause InductiveConstructor">getAmountc</a><a id="8173" class="CatchallClause">  </a><a id="8175" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8175" class="CatchallClause Bound">addrLookedUp</a><a id="8187" class="CatchallClause Symbol">)</a><a id="8188" class="CatchallClause"> </a><a id="8189" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8189" class="CatchallClause Bound">cont</a><a id="8193" class="CatchallClause Symbol">))</a>
       <a id="8203" class="Symbol">=</a> <a id="8205" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="8213" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8106" class="Bound">currentLedger</a> <a id="8227" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8120" class="Bound">executionStack</a> <a id="8242" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8135" class="Bound">callAddr</a> <a id="8251" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8144" class="Bound">currentAddr</a> <a id="8263" class="Symbol">(</a><a id="8264" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8189" class="Bound">cont</a> <a id="8269" class="Symbol">(</a><a id="8270" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8106" class="Bound">currentLedger</a> <a id="8284" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8175" class="Bound">addrLookedUp</a> <a id="8297" class="Symbol">.</a><a id="8298" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1885" class="Field">amount</a><a id="8304" class="Symbol">))</a>
<a id="8307" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="CatchallClause Function">stepEF</a><a id="8313" class="CatchallClause"> </a><a id="8314" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8314" class="CatchallClause Bound">oldLedger</a><a id="8323" class="CatchallClause"> </a><a id="8324" class="CatchallClause Symbol">(</a><a id="8325" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="8332" class="CatchallClause"> </a><a id="8333" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8333" class="CatchallClause Bound">currentLedger</a><a id="8346" class="CatchallClause"> </a><a id="8347" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8347" class="CatchallClause Bound">executionStack</a><a id="8361" class="CatchallClause"> </a><a id="8362" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8362" class="CatchallClause Bound">callAddr</a><a id="8370" class="CatchallClause"> </a><a id="8371" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8371" class="CatchallClause Bound">currentAddr</a><a id="8382" class="CatchallClause"> </a><a id="8383" class="CatchallClause Symbol">(</a><a id="8384" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="CatchallClause InductiveConstructor">error</a><a id="8389" class="CatchallClause"> </a><a id="8390" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8390" class="CatchallClause Bound">errorMsg</a><a id="8398" class="CatchallClause Symbol">))</a>
       <a id="8408" class="Symbol">=</a> <a id="8410" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="8418" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8314" class="Bound">oldLedger</a> <a id="8428" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8347" class="Bound">executionStack</a> <a id="8443" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8362" class="Bound">callAddr</a> <a id="8452" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8371" class="Bound">currentAddr</a> <a id="8464" class="Symbol">(</a><a id="8465" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="InductiveConstructor">error</a> <a id="8471" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8390" class="Bound">errorMsg</a><a id="8479" class="Symbol">)</a>


<a id="8483" class="Comment">-- definition of stepEFntimes</a>
<a id="stepEFntimes"></a><a id="8513" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8513" class="Function">stepEFntimes</a> <a id="8526" class="Symbol">:</a> <a id="8528" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="8535" class="Symbol">→</a> <a id="8537" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a> <a id="8550" class="Symbol">→</a> <a id="8552" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="8554" class="Symbol">→</a> <a id="8556" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a>
<a id="8569" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8513" class="Function">stepEFntimes</a> <a id="8582" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8582" class="Bound">oldLedger</a> <a id="8592" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8592" class="Bound">ledgerstateexecfun</a> <a id="8611" class="Number">0</a>
             <a id="8626" class="Symbol">=</a> <a id="8628" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8592" class="Bound">ledgerstateexecfun</a>
<a id="8647" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8513" class="Function">stepEFntimes</a> <a id="8660" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8660" class="Bound">oldLedger</a> <a id="8670" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8670" class="Bound">ledgerstateexecfun</a> <a id="8689" class="Symbol">(</a><a id="8690" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8694" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8694" class="Bound">n</a><a id="8695" class="Symbol">)</a>
      <a id="8703" class="Symbol">=</a> <a id="8705" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="Function">stepEF</a> <a id="8712" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8660" class="Bound">oldLedger</a> <a id="8722" class="Symbol">(</a><a id="8723" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8513" class="Function">stepEFntimes</a> <a id="8736" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8660" class="Bound">oldLedger</a> <a id="8746" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8670" class="Bound">ledgerstateexecfun</a> <a id="8765" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8694" class="Bound">n</a><a id="8766" class="Symbol">)</a>



<a id="stepLedgerFunntimes"></a><a id="8771" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8771" class="Function">stepLedgerFunntimes</a> <a id="8791" class="Symbol">:</a> <a id="8793" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="8800" class="Symbol">→</a> <a id="8802" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>
                      <a id="8832" class="Symbol">→</a> <a id="8834" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a> <a id="8842" class="Symbol">→</a> <a id="8844" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a>
                      <a id="8879" class="Symbol">→</a> <a id="8881" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="8885" class="Symbol">→</a> <a id="8887" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="8889" class="Symbol">→</a> <a id="8891" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a>
<a id="8904" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8771" class="Function">stepLedgerFunntimes</a> <a id="8924" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8924" class="Bound">ledger</a> <a id="8931" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8931" class="Bound">callAddr</a> <a id="8940" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8940" class="Bound">currentAddr</a> <a id="8952" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8952" class="Bound">funname</a> <a id="8960" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8960" class="Bound">msg</a> <a id="8964" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8964" class="Bound">n</a>
        <a id="8974" class="Symbol">=</a> <a id="8976" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8513" class="Function">stepEFntimes</a> <a id="8989" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8924" class="Bound">ledger</a> <a id="8996" class="Symbol">(</a><a id="8997" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="9005" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8924" class="Bound">ledger</a> <a id="9012" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9015" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8931" class="Bound">callAddr</a> <a id="9024" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8940" class="Bound">currentAddr</a>
        <a id="9044" class="Symbol">(</a><a id="9045" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8924" class="Bound">ledger</a> <a id="9052" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8940" class="Bound">currentAddr</a> <a id="9064" class="Symbol">.</a><a id="9065" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1907" class="Field">fun</a> <a id="9069" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8952" class="Bound">funname</a> <a id="9077" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8960" class="Bound">msg</a><a id="9080" class="Symbol">))</a> <a id="9083" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8964" class="Bound">n</a>


<a id="stepLedgerFunntimesList"></a><a id="9087" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9087" class="Function">stepLedgerFunntimesList</a> <a id="9111" class="Symbol">:</a> <a id="9113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="9120" class="Symbol">→</a> <a id="9122" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a>
                          <a id="9156" class="Symbol">→</a>  <a id="9159" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a> <a id="9167" class="Symbol">→</a> <a id="9169" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a>
                          <a id="9208" class="Symbol">→</a> <a id="9210" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="9214" class="Symbol">→</a> <a id="9216" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="9218" class="Symbol">→</a> <a id="9220" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="9225" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a>
<a id="9238" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9087" class="Function">stepLedgerFunntimesList</a> <a id="9262" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9262" class="Bound">ledger</a> <a id="9269" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9269" class="Bound">callAddr</a> <a id="9278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9278" class="Bound">currentAddr</a> <a id="9290" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9290" class="Bound">funname</a> <a id="9298" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9298" class="Bound">msg</a> <a id="9302" class="Number">0</a> <a id="9304" class="Symbol">=</a> <a id="9306" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="9309" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9087" class="Function">stepLedgerFunntimesList</a> <a id="9333" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9333" class="Bound">ledger</a> <a id="9340" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9340" class="Bound">callAddr</a> <a id="9349" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9349" class="Bound">currentAddr</a> <a id="9361" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9361" class="Bound">funname</a> <a id="9369" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9369" class="Bound">msg</a> <a id="9373" class="Symbol">(</a><a id="9374" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9378" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9378" class="Bound">n</a><a id="9379" class="Symbol">)</a>
        <a id="9389" class="Symbol">=</a> <a id="9391" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8771" class="Function">stepLedgerFunntimes</a> <a id="9411" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9333" class="Bound">ledger</a> <a id="9418" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9340" class="Bound">callAddr</a> <a id="9427" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9349" class="Bound">currentAddr</a> <a id="9439" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9361" class="Bound">funname</a> <a id="9447" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9369" class="Bound">msg</a> <a id="9451" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9378" class="Bound">n</a> <a id="9453" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>
          <a id="9465" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9087" class="Function">stepLedgerFunntimesList</a> <a id="9489" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9333" class="Bound">ledger</a> <a id="9496" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9340" class="Bound">callAddr</a> <a id="9505" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9349" class="Bound">currentAddr</a> <a id="9517" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9361" class="Bound">funname</a> <a id="9525" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9369" class="Bound">msg</a> <a id="9529" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9378" class="Bound">n</a>



<a id="9534" class="Symbol">{-#</a> <a id="9538" class="Keyword">NON_TERMINATING</a> <a id="9554" class="Symbol">#-}</a>
<a id="evaluateNonTerminatingAux"></a><a id="9558" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9558" class="Function">evaluateNonTerminatingAux</a> <a id="9584" class="Symbol">:</a> <a id="9586" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="9593" class="Symbol">→</a> <a id="9595" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3486" class="Record">StateExecFun</a> <a id="9608" class="Symbol">→</a> <a id="9610" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#764" class="Datatype">NatOrError</a>
<a id="9621" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9558" class="Function">evaluateNonTerminatingAux</a> <a id="9647" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9647" class="Bound">oldledger</a> <a id="9657" class="Symbol">(</a><a id="9658" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="9666" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9666" class="Bound">currentLedger</a> <a id="9680" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9683" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9683" class="Bound">callAddr</a> <a id="9692" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9692" class="Bound">currentAddr</a> <a id="9704" class="Symbol">(</a><a id="9705" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="InductiveConstructor">return</a> <a id="9712" class="Symbol">(</a><a id="9713" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#593" class="InductiveConstructor">nat</a> <a id="9717" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9717" class="Bound">n</a><a id="9718" class="Symbol">)))</a> <a id="9722" class="Symbol">=</a> <a id="9724" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#788" class="InductiveConstructor">nat</a> <a id="9728" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9717" class="Bound">n</a>
<a id="9730" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9558" class="CatchallClause Function">evaluateNonTerminatingAux</a><a id="9755" class="CatchallClause"> </a><a id="9756" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9756" class="CatchallClause Bound">oldledger</a><a id="9765" class="CatchallClause"> </a><a id="9766" class="CatchallClause Symbol">(</a><a id="9767" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="9774" class="CatchallClause"> </a><a id="9775" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9775" class="CatchallClause Bound">currentLedger</a><a id="9788" class="CatchallClause"> </a><a id="9789" href="Agda.Builtin.List.html#185" class="CatchallClause InductiveConstructor">[]</a><a id="9791" class="CatchallClause"> </a><a id="9792" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9792" class="CatchallClause Bound">callAddr</a><a id="9800" class="CatchallClause"> </a><a id="9801" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9801" class="CatchallClause Bound">currentAddr</a><a id="9812" class="CatchallClause"> </a><a id="9813" class="CatchallClause Symbol">(</a><a id="9814" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1269" class="CatchallClause InductiveConstructor">return</a><a id="9820" class="CatchallClause"> </a><a id="9821" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9821" class="CatchallClause Bound">otherwise</a><a id="9830" class="CatchallClause Symbol">))</a> <a id="9833" class="Symbol">=</a> <a id="9835" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#810" class="InductiveConstructor">err</a> <a id="9839" class="Symbol">(</a><a id="9840" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#727" class="InductiveConstructor">strErr</a> <a id="9847" class="String">&quot;result returned not nat&quot;</a><a id="9872" class="Symbol">)</a>
<a id="9874" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9558" class="CatchallClause Function">evaluateNonTerminatingAux</a><a id="9899" class="CatchallClause"> </a><a id="9900" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9900" class="CatchallClause Bound">oldledger</a><a id="9909" class="CatchallClause"> </a><a id="9910" class="CatchallClause Symbol">(</a><a id="9911" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="CatchallClause InductiveConstructor">stateEF</a><a id="9918" class="CatchallClause"> </a><a id="9919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9919" class="CatchallClause Bound">currentLedger</a><a id="9932" class="CatchallClause"> </a><a id="9933" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9933" class="CatchallClause Bound">s</a><a id="9934" class="CatchallClause"> </a><a id="9935" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9935" class="CatchallClause Bound">callAddr</a><a id="9943" class="CatchallClause"> </a><a id="9944" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9944" class="CatchallClause Bound">currentAddr</a><a id="9955" class="CatchallClause"> </a><a id="9956" class="CatchallClause Symbol">(</a><a id="9957" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="CatchallClause InductiveConstructor">error</a><a id="9962" class="CatchallClause"> </a><a id="9963" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9963" class="CatchallClause Bound">msg</a><a id="9966" class="CatchallClause Symbol">))</a> <a id="9969" class="Symbol">=</a> <a id="9971" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#810" class="InductiveConstructor">err</a> <a id="9975" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9963" class="Bound">msg</a>
<a id="9979" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9558" class="CatchallClause Function">evaluateNonTerminatingAux</a><a id="10004" class="CatchallClause"> </a><a id="10005" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10005" class="CatchallClause Bound">oldledger</a><a id="10014" class="CatchallClause"> </a><a id="10015" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10015" class="CatchallClause Bound">evals</a> <a id="10021" class="Symbol">=</a> <a id="10023" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9558" class="Function">evaluateNonTerminatingAux</a> <a id="10049" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10005" class="Bound">oldledger</a> <a id="10059" class="Symbol">(</a><a id="10060" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6438" class="Function">stepEF</a>  <a id="10068" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10005" class="Bound">oldledger</a> <a id="10078" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10015" class="Bound">evals</a><a id="10083" class="Symbol">)</a>

<a id="evaluateNonTerminating"></a><a id="10086" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10086" class="Function">evaluateNonTerminating</a> <a id="10109" class="Symbol">:</a> <a id="10111" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1993" class="Function">Ledger</a> <a id="10118" class="Symbol">→</a> <a id="10120" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a> <a id="10128" class="Symbol">→</a>  <a id="10131" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#438" class="Function">Address</a> <a id="10139" class="Symbol">→</a> <a id="10141" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#222" class="Function">FunctionName</a> <a id="10154" class="Symbol">→</a> <a id="10156" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#574" class="Datatype">Msg</a> <a id="10160" class="Symbol">→</a> <a id="10162" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#764" class="Datatype">NatOrError</a>
<a id="10173" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10086" class="Function">evaluateNonTerminating</a> <a id="10196" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10196" class="Bound">ledger</a> <a id="10203" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10203" class="Bound">callAddr</a> <a id="10212" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10212" class="Bound">currentAddr</a>  <a id="10225" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10225" class="Bound">funname</a> <a id="10233" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10233" class="Bound">msg</a>
            <a id="10249" class="Symbol">=</a>  <a id="10252" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9558" class="Function">evaluateNonTerminatingAux</a> <a id="10278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10196" class="Bound">ledger</a>
            <a id="10297" class="Symbol">(</a><a id="10298" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3525" class="InductiveConstructor">stateEF</a> <a id="10306" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10196" class="Bound">ledger</a> <a id="10313" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10316" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10203" class="Bound">callAddr</a> <a id="10325" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10212" class="Bound">currentAddr</a> <a id="10337" class="Symbol">(</a><a id="10338" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10196" class="Bound">ledger</a> <a id="10345" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10212" class="Bound">currentAddr</a> <a id="10357" class="Symbol">.</a><a id="10358" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1907" class="Field">fun</a> <a id="10362" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10225" class="Bound">funname</a> <a id="10370" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10233" class="Bound">msg</a><a id="10373" class="Symbol">))</a>




</pre></body></html>