<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.votingexample-single-candidate</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.votingexample-single-candidate.html" class="Module">Complex-Model.example.votingexample-single-candidate</a>  <a id="94" class="Keyword">where</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Data.List.html" class="Module">Data.List</a>
<a id="122" class="Keyword">open</a> <a id="127" class="Keyword">import</a> <a id="134" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> 
<a id="150" class="Keyword">open</a> <a id="155" class="Keyword">import</a> <a id="162" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="Data.Product.html" class="Module">Data.Product</a> <a id="205" class="Keyword">renaming</a> <a id="214" class="Symbol">(</a><a id="215" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="219" class="Symbol">to</a> <a id="222" class="InductiveConstructor Operator">_,,_</a> <a id="227" class="Symbol">)</a>
<a id="229" class="Keyword">open</a> <a id="234" class="Keyword">import</a> <a id="241" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="252" class="Keyword">hiding</a> <a id="259" class="Symbol">(</a><a id="260" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="265" class="Symbol">)</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> 
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="320" class="Keyword">open</a> <a id="325" class="Keyword">import</a> <a id="332" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="346" class="Keyword">hiding</a> <a id="353" class="Symbol">(</a><a id="354" href="Data.Fin.Base.html#5934" class="Function Operator">_+_</a><a id="357" class="Symbol">;</a> <a id="359" href="Data.Fin.Base.html#6064" class="Function Operator">_-_</a><a id="362" class="Symbol">)</a>
<a id="364" class="Keyword">import</a> <a id="371" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="409" class="Symbol">as</a> <a id="412" class="Module">Eq</a>
<a id="415" class="Keyword">open</a> <a id="420" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="423" class="Keyword">using</a> <a id="429" class="Symbol">(</a><a id="430" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a> <a id="434" class="Symbol">;</a> <a id="436" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="441" class="Symbol">;</a> <a id="443" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="447" class="Symbol">;</a> <a id="449" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a><a id="453" class="Symbol">)</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="484" class="Keyword">using</a> <a id="490" class="Symbol">(</a><a id="491" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="494" class="Symbol">;</a> <a id="496" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="499" class="Symbol">)</a>
<a id="501" class="Keyword">open</a> <a id="506" class="Keyword">import</a> <a id="513" href="Data.String.html" class="Module">Data.String</a> <a id="525" class="Keyword">hiding</a> <a id="532" class="Symbol">(</a><a id="533" href="Data.String.Base.html#2468" class="Function">length</a><a id="539" class="Symbol">;</a> <a id="541" href="Data.String.Base.html#1605" class="Primitive">show</a><a id="545" class="Symbol">)</a> <a id="547" class="Keyword">renaming</a> <a id="556" class="Symbol">(</a><a id="557" href="Data.String.Base.html#2404" class="Function Operator">_++_</a> <a id="562" class="Symbol">to</a> <a id="565" class="Function Operator">_++str_</a><a id="572" class="Symbol">)</a>

<a id="575" class="Comment">--our work</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a>  <a id="599" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="620" class="Keyword">open</a> <a id="625" class="Keyword">import</a> <a id="632" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="681" href="constantparameters.html#969" class="Function">exampleParameters</a>
<a id="699" class="Keyword">open</a> <a id="704" class="Keyword">import</a> <a id="711" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="753" class="Keyword">open</a> <a id="758" class="Keyword">import</a> <a id="765" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="784" class="Keyword">open</a> <a id="789" class="Keyword">import</a> <a id="796" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>



<a id="821" class="Comment">--initial function</a>
<a id="initialfun"></a><a id="840" href="Complex-Model.example.votingexample-single-candidate.html#840" class="Function">initialfun</a> <a id="851" class="Symbol">:</a> <a id="853" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="857" class="Symbol">→</a> <a id="859" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="870" href="Complex-Model.example.votingexample-single-candidate.html#840" class="Function">initialfun</a> <a id="881" class="Symbol">(</a><a id="882" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="886" href="Complex-Model.example.votingexample-single-candidate.html#886" class="Bound">n</a><a id="887" class="Symbol">)</a> <a id="889" class="Symbol">=</a> <a id="891" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="898" class="Symbol">(</a><a id="899" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="903" class="Number">0</a><a id="904" class="Symbol">)</a>
<a id="906" href="Complex-Model.example.votingexample-single-candidate.html#840" class="CatchallClause Function">initialfun</a><a id="916" class="CatchallClause"> </a><a id="917" href="Complex-Model.example.votingexample-single-candidate.html#917" class="CatchallClause Bound">owmsg</a>   <a id="925" class="Symbol">=</a> <a id="927" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="931" class="Symbol">(</a><a id="932" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="939" class="String">&quot; The message is not a number &quot;</a><a id="970" class="Symbol">)</a>


<a id="974" class="Comment">--increment function</a>
<a id="incrementAux"></a><a id="995" href="Complex-Model.example.votingexample-single-candidate.html#995" class="Function">incrementAux</a> <a id="1008" class="Symbol">:</a> <a id="1010" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="1021" class="Symbol">→</a> <a id="1023" href="Complex-Model.ccomand.ccommands-cresponse.html#1514" class="Datatype">SmartContractExec</a> <a id="1041" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="1045" href="Complex-Model.example.votingexample-single-candidate.html#995" class="Function">incrementAux</a> <a id="1058" class="Symbol">(</a><a id="1059" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1066" class="Symbol">(</a><a id="1067" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1071" href="Complex-Model.example.votingexample-single-candidate.html#1071" class="Bound">n</a><a id="1072" class="Symbol">))</a> <a id="1075" class="Symbol">=</a> <a id="1077" class="Symbol">(</a><a id="1078" href="Complex-Model.ccomand.ccommands-cresponse.html#1656" class="InductiveConstructor">exec</a> <a id="1083" class="Symbol">(</a><a id="1084" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="1092" class="String">&quot;counter&quot;</a> <a id="1102" class="Symbol">(λ</a> <a id="1105" href="Complex-Model.example.votingexample-single-candidate.html#1105" class="Bound">_</a> <a id="1107" class="Symbol">→</a> <a id="1109" class="Symbol">λ</a> <a id="1111" href="Complex-Model.example.votingexample-single-candidate.html#1111" class="Bound">msg</a> <a id="1115" class="Symbol">→</a> <a id="1117" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1124" class="Symbol">(</a><a id="1125" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1129" class="Symbol">(</a><a id="1130" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1134" href="Complex-Model.example.votingexample-single-candidate.html#1071" class="Bound">n</a><a id="1135" class="Symbol">)))</a> <a id="1139" class="Symbol">λ</a> <a id="1141" href="Complex-Model.example.votingexample-single-candidate.html#1141" class="Bound">oldFun</a> <a id="1148" href="Complex-Model.example.votingexample-single-candidate.html#1148" class="Bound">oldcost</a> <a id="1156" href="Complex-Model.example.votingexample-single-candidate.html#1156" class="Bound">msg</a> <a id="1160" class="Symbol">→</a> <a id="1162" class="Number">1</a><a id="1163" class="Symbol">)</a>
                                                         <a id="1222" class="Symbol">(λ</a> <a id="1225" href="Complex-Model.example.votingexample-single-candidate.html#1225" class="Bound">n</a> <a id="1227" class="Symbol">→</a> <a id="1229" class="Number">1</a><a id="1230" class="Symbol">))</a> <a id="1233" class="Symbol">λ</a> <a id="1235" href="Complex-Model.example.votingexample-single-candidate.html#1235" class="Bound">x</a> <a id="1237" class="Symbol">→</a> <a id="1239" href="Complex-Model.ccomand.ccommands-cresponse.html#1558" class="InductiveConstructor">return</a> <a id="1246" class="Number">1</a> <a id="1248" class="Symbol">(</a><a id="1249" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1253" class="Symbol">(</a><a id="1254" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1258" href="Complex-Model.example.votingexample-single-candidate.html#1071" class="Bound">n</a><a id="1259" class="Symbol">))</a>
<a id="1262" href="Complex-Model.example.votingexample-single-candidate.html#995" class="CatchallClause Function">incrementAux</a><a id="1274" class="CatchallClause"> </a><a id="1275" href="Complex-Model.example.votingexample-single-candidate.html#1275" class="CatchallClause Bound">ow</a> <a id="1278" class="Symbol">=</a> <a id="1280" href="Complex-Model.ccomand.ccommands-cresponse.html#1599" class="InductiveConstructor">error</a> <a id="1286" class="Symbol">(</a><a id="1287" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1294" class="String">&quot;counter returns not a number&quot;</a><a id="1324" class="Symbol">)</a> <a id="1326" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="1328" class="Number">0</a> <a id="1330" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1333" class="Number">0</a> <a id="1335" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="1337" class="String">&quot;increment&quot;</a> <a id="1349" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="1351" class="Symbol">(</a><a id="1352" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1356" class="Number">0</a><a id="1357" class="Symbol">)</a> <a id="1359" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>



<a id="1365" class="Comment">--add voter function</a>
<a id="addVoterAux"></a><a id="1386" href="Complex-Model.example.votingexample-single-candidate.html#1386" class="Function">addVoterAux</a> <a id="1398" class="Symbol">:</a> <a id="1400" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1404" class="Symbol">→</a> <a id="1406" class="Symbol">(</a><a id="1407" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1411" class="Symbol">→</a> <a id="1413" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1423" class="Symbol">)</a> <a id="1425" class="Symbol">→</a> <a id="1427" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1431" class="Symbol">→</a> <a id="1433" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="1444" href="Complex-Model.example.votingexample-single-candidate.html#1386" class="Function">addVoterAux</a> <a id="1456" class="Symbol">(</a><a id="1457" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1461" href="Complex-Model.example.votingexample-single-candidate.html#1461" class="Bound">newaddr</a><a id="1468" class="Symbol">)</a> <a id="1470" href="Complex-Model.example.votingexample-single-candidate.html#1470" class="Bound">oldCheckVoter</a> <a id="1484" class="Symbol">(</a><a id="1485" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1489" href="Complex-Model.example.votingexample-single-candidate.html#1489" class="Bound">addr</a><a id="1493" class="Symbol">)</a> <a id="1495" class="Symbol">=</a> <a id="1497" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="1500" href="Complex-Model.example.votingexample-single-candidate.html#1461" class="Bound">newaddr</a> <a id="1508" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="1511" href="Complex-Model.example.votingexample-single-candidate.html#1489" class="Bound">addr</a> <a id="1516" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="1521" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1528" class="Symbol">(</a><a id="1529" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1533" class="Number">1</a><a id="1534" class="Symbol">)</a> <a id="1536" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="1541" href="Complex-Model.example.votingexample-single-candidate.html#1470" class="Bound">oldCheckVoter</a> <a id="1555" class="Symbol">(</a><a id="1556" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1560" href="Complex-Model.example.votingexample-single-candidate.html#1489" class="Bound">addr</a><a id="1564" class="Symbol">)</a>
<a id="1566" href="Complex-Model.example.votingexample-single-candidate.html#1386" class="CatchallClause Function">addVoterAux</a><a id="1577" class="CatchallClause"> </a><a id="1578" href="Complex-Model.example.votingexample-single-candidate.html#1578" class="CatchallClause Bound">ow</a><a id="1580" class="CatchallClause"> </a><a id="1581" href="Complex-Model.example.votingexample-single-candidate.html#1581" class="CatchallClause Bound">ow&#39;</a><a id="1584" class="CatchallClause"> </a><a id="1585" href="Complex-Model.example.votingexample-single-candidate.html#1585" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1590" class="Symbol">=</a> <a id="1592" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="1596" class="Symbol">(</a><a id="1597" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1604" class="String">&quot; You cannot add voter &quot;</a><a id="1628" class="Symbol">)</a>



<a id="1633" class="Comment">--delete voter function</a>
<a id="deleteVoterAux"></a><a id="1657" href="Complex-Model.example.votingexample-single-candidate.html#1657" class="Function">deleteVoterAux</a> <a id="1672" class="Symbol">:</a> <a id="1674" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1678" class="Symbol">→</a> <a id="1680" class="Symbol">(</a><a id="1681" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1685" class="Symbol">→</a> <a id="1687" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1697" class="Symbol">)</a> <a id="1699" class="Symbol">→</a> <a id="1701" class="Symbol">(</a><a id="1702" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1706" class="Symbol">→</a> <a id="1708" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1718" class="Symbol">)</a>
<a id="1720" href="Complex-Model.example.votingexample-single-candidate.html#1657" class="Function">deleteVoterAux</a> <a id="1735" class="Symbol">(</a><a id="1736" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1740" href="Complex-Model.example.votingexample-single-candidate.html#1740" class="Bound">newaddr</a><a id="1747" class="Symbol">)</a> <a id="1749" href="Complex-Model.example.votingexample-single-candidate.html#1749" class="Bound">oldCheckVoter</a> <a id="1763" class="Symbol">(</a><a id="1764" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1768" href="Complex-Model.example.votingexample-single-candidate.html#1768" class="Bound">addr</a><a id="1772" class="Symbol">)</a> <a id="1774" class="Symbol">=</a> <a id="1776" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="1779" href="Complex-Model.example.votingexample-single-candidate.html#1740" class="Bound">newaddr</a> <a id="1787" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="1790" href="Complex-Model.example.votingexample-single-candidate.html#1768" class="Bound">addr</a> <a id="1795" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="1800" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1807" class="Symbol">(</a><a id="1808" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1812" class="Number">0</a><a id="1813" class="Symbol">)</a> <a id="1815" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="1820" href="Complex-Model.example.votingexample-single-candidate.html#1749" class="Bound">oldCheckVoter</a> <a id="1834" class="Symbol">(</a><a id="1835" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1839" href="Complex-Model.example.votingexample-single-candidate.html#1768" class="Bound">addr</a><a id="1843" class="Symbol">)</a>
<a id="1845" href="Complex-Model.example.votingexample-single-candidate.html#1657" class="CatchallClause Function">deleteVoterAux</a><a id="1859" class="CatchallClause"> </a><a id="1860" href="Complex-Model.example.votingexample-single-candidate.html#1860" class="CatchallClause Bound">ow</a><a id="1862" class="CatchallClause"> </a><a id="1863" href="Complex-Model.example.votingexample-single-candidate.html#1863" class="CatchallClause Bound">ow&#39;</a><a id="1866" class="CatchallClause"> </a><a id="1867" href="Complex-Model.example.votingexample-single-candidate.html#1867" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1872" class="Symbol">=</a> <a id="1874" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="1878" class="Symbol">(</a><a id="1879" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1886" class="String">&quot; You cannot delete voter &quot;</a><a id="1913" class="Symbol">)</a>



<a id="1918" class="Comment">-- the function below we use it in case to check voter is allowed to vote or not</a>
<a id="1999" class="Comment">-- in case nat 0 or otherwise it will return error and not allow to vote</a>
<a id="2072" class="Comment">-- in case suc (nat n) it will allow to vote and it will call incrementAux to increment the counter</a>
<a id="voteAux"></a><a id="2172" href="Complex-Model.example.votingexample-single-candidate.html#2172" class="Function">voteAux</a> <a id="2180" class="Symbol">:</a> <a id="2182" href="basicDataStructure.html#387" class="Function">Address</a> <a id="2190" class="Symbol">→</a> <a id="2192" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="2203" class="Symbol">→</a> <a id="2205" href="Complex-Model.ccomand.ccommands-cresponse.html#1514" class="Datatype">SmartContractExec</a> <a id="2223" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="2227" href="Complex-Model.example.votingexample-single-candidate.html#2172" class="Function">voteAux</a> <a id="2235" href="Complex-Model.example.votingexample-single-candidate.html#2235" class="Bound">addr</a> <a id="2240" class="Symbol">(</a><a id="2241" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2248" class="Symbol">(</a><a id="2249" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2253" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="2257" class="Symbol">))</a>    <a id="2263" class="Symbol">=</a> <a id="2265" href="Complex-Model.ccomand.ccommands-cresponse.html#1599" class="InductiveConstructor">error</a> <a id="2271" class="Symbol">(</a><a id="2272" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2279" class="String">&quot;The voter is not allowed to vote&quot;</a><a id="2313" class="Symbol">)</a>
                                    <a id="2351" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2353" class="Number">0</a> <a id="2355" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2358" class="Number">0</a> <a id="2360" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2362" class="String">&quot;Voter is not allowed to vote&quot;</a> <a id="2393" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2395" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2399" class="Number">0</a> <a id="2401" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2404" href="Complex-Model.example.votingexample-single-candidate.html#2172" class="Function">voteAux</a> <a id="2412" href="Complex-Model.example.votingexample-single-candidate.html#2412" class="Bound">addr</a> <a id="2417" class="Symbol">(</a><a id="2418" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2425" class="Symbol">(</a><a id="2426" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2430" class="Symbol">(</a><a id="2431" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2435" href="Complex-Model.example.votingexample-single-candidate.html#2435" class="Bound">n</a><a id="2436" class="Symbol">)))</a> <a id="2440" class="Symbol">=</a> <a id="2442" href="Complex-Model.ccomand.ccommands-cresponse.html#1656" class="InductiveConstructor">exec</a> <a id="2447" class="Symbol">(</a><a id="2448" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="2456" class="String">&quot;checkVoter&quot;</a> <a id="2469" class="Symbol">(</a><a id="2470" href="Complex-Model.example.votingexample-single-candidate.html#1657" class="Function">deleteVoterAux</a> <a id="2485" class="Symbol">(</a><a id="2486" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2490" href="Complex-Model.example.votingexample-single-candidate.html#2412" class="Bound">addr</a><a id="2494" class="Symbol">))</a> <a id="2497" class="Symbol">λ</a> <a id="2499" href="Complex-Model.example.votingexample-single-candidate.html#2499" class="Bound">oldFun</a> <a id="2506" href="Complex-Model.example.votingexample-single-candidate.html#2506" class="Bound">oldcost</a> <a id="2514" href="Complex-Model.example.votingexample-single-candidate.html#2514" class="Bound">msg</a> <a id="2518" class="Symbol">→</a> <a id="2520" class="Number">1</a><a id="2521" class="Symbol">)</a> <a id="2523" class="Symbol">(λ</a> <a id="2526" href="Complex-Model.example.votingexample-single-candidate.html#2526" class="Bound">_</a> <a id="2528" class="Symbol">→</a> <a id="2530" class="Number">1</a><a id="2531" class="Symbol">)</a>
                                    <a id="2569" class="Symbol">(λ</a> <a id="2572" href="Complex-Model.example.votingexample-single-candidate.html#2572" class="Bound">x</a> <a id="2574" class="Symbol">→</a> <a id="2576" href="Complex-Model.ccomand.ccommands-cresponse.html#1656" class="InductiveConstructor">exec</a> <a id="2581" class="Symbol">(</a><a id="2582" href="Complex-Model.ccomand.ccommands-cresponse.html#770" class="InductiveConstructor">callPure</a> <a id="2591" class="Number">1</a> <a id="2593" class="String">&quot;counter&quot;</a> <a id="2603" class="Symbol">(</a><a id="2604" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2608" class="Number">0</a><a id="2609" class="Symbol">))</a> <a id="2612" class="Symbol">(λ</a> <a id="2615" href="Complex-Model.example.votingexample-single-candidate.html#2615" class="Bound">result</a> <a id="2622" class="Symbol">→</a> <a id="2624" class="Number">1</a><a id="2625" class="Symbol">)</a>
                                    <a id="2663" class="Symbol">λ</a> <a id="2665" href="Complex-Model.example.votingexample-single-candidate.html#2665" class="Bound">msg</a> <a id="2669" class="Symbol">→</a> <a id="2671" href="Complex-Model.example.votingexample-single-candidate.html#995" class="Function">incrementAux</a> <a id="2684" href="Complex-Model.example.votingexample-single-candidate.html#2665" class="Bound">msg</a><a id="2687" class="Symbol">)</a>
<a id="2689" href="Complex-Model.example.votingexample-single-candidate.html#2172" class="CatchallClause Function">voteAux</a><a id="2696" class="CatchallClause"> </a><a id="2697" href="Complex-Model.example.votingexample-single-candidate.html#2697" class="CatchallClause Bound">addr</a><a id="2701" class="CatchallClause"> </a><a id="2702" class="CatchallClause Symbol">(</a><a id="2703" href="basicDataStructure.html#1452" class="CatchallClause InductiveConstructor">theMsg</a><a id="2709" class="CatchallClause"> </a><a id="2710" href="Complex-Model.example.votingexample-single-candidate.html#2710" class="CatchallClause Bound">ow</a><a id="2712" class="CatchallClause Symbol">)</a>   <a id="2716" class="Symbol">=</a> <a id="2718" href="Complex-Model.ccomand.ccommands-cresponse.html#1599" class="InductiveConstructor">error</a> <a id="2724" class="Symbol">(</a><a id="2725" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2732" class="String">&quot;The message is not a number&quot;</a><a id="2761" class="Symbol">)</a>
                             <a id="2792" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2794" class="Number">0</a> <a id="2796" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2799" class="Number">0</a> <a id="2801" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2803" class="String">&quot;Voter is not allowed to vote&quot;</a> <a id="2834" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2836" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2840" class="Number">0</a> <a id="2842" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2845" href="Complex-Model.example.votingexample-single-candidate.html#2172" class="Function">voteAux</a> <a id="2853" href="Complex-Model.example.votingexample-single-candidate.html#2853" class="Bound">addr</a> <a id="2858" class="Symbol">(</a><a id="2859" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2863" href="Complex-Model.example.votingexample-single-candidate.html#2863" class="Bound">x</a><a id="2864" class="Symbol">)</a> <a id="2866" class="Symbol">=</a> <a id="2868" href="Complex-Model.ccomand.ccommands-cresponse.html#1599" class="InductiveConstructor">error</a> <a id="2874" class="Symbol">(</a><a id="2875" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2882" class="String">&quot; Undefined &quot;</a><a id="2895" class="Symbol">)</a>
                       <a id="2920" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2922" class="Number">0</a> <a id="2924" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2927" class="Number">0</a> <a id="2929" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2931" class="String">&quot;The message is undefined&quot;</a> <a id="2958" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2960" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2964" class="Number">0</a> <a id="2966" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>




<a id="2973" class="Comment">-----define our ledger</a>

<a id="testLedger"></a><a id="2997" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="3008" class="Symbol">:</a> <a id="3010" href="libraries.Mainlibrary.html#1099" class="Function">Ledger</a>
<a id="3017" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="3028" class="Number">1</a> <a id="3030" class="Symbol">.</a><a id="3031" href="libraries.Mainlibrary.html#797" class="Field">amount</a> <a id="3038" class="Symbol">=</a> <a id="3040" class="Number">100</a>                                                                                        

<a id="3133" class="Comment">-- in case to add voter</a>
<a id="3157" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="3168" class="Number">1</a> <a id="3170" class="Symbol">.</a><a id="3171" href="libraries.Mainlibrary.html#819" class="Field">fun</a> <a id="3175" class="String">&quot;addVoter&quot;</a> <a id="3186" href="Complex-Model.example.votingexample-single-candidate.html#3186" class="Bound">msg</a>  <a id="3191" class="Symbol">=</a> <a id="3193" href="Complex-Model.ccomand.ccommands-cresponse.html#1656" class="InductiveConstructor">exec</a> <a id="3198" class="Symbol">(</a><a id="3199" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="3207" class="String">&quot;checkVoter&quot;</a>
                                    <a id="3256" class="Symbol">(</a><a id="3257" href="Complex-Model.example.votingexample-single-candidate.html#1386" class="Function">addVoterAux</a> <a id="3269" href="Complex-Model.example.votingexample-single-candidate.html#3186" class="Bound">msg</a><a id="3272" class="Symbol">)</a> <a id="3274" class="Symbol">λ</a> <a id="3276" href="Complex-Model.example.votingexample-single-candidate.html#3276" class="Bound">oldFun</a> <a id="3283" href="Complex-Model.example.votingexample-single-candidate.html#3283" class="Bound">oldcost</a> <a id="3291" href="Complex-Model.example.votingexample-single-candidate.html#3291" class="Bound">msg</a> <a id="3295" class="Symbol">→</a> <a id="3297" class="Number">1</a><a id="3298" class="Symbol">)(λ</a> <a id="3302" href="Complex-Model.example.votingexample-single-candidate.html#3302" class="Bound">_</a> <a id="3304" class="Symbol">→</a> <a id="3306" class="Number">1</a><a id="3307" class="Symbol">)</a>
                                    <a id="3345" class="Symbol">λ</a> <a id="3347" href="Complex-Model.example.votingexample-single-candidate.html#3347" class="Bound">_</a> <a id="3349" class="Symbol">→</a> <a id="3351" href="Complex-Model.ccomand.ccommands-cresponse.html#1558" class="InductiveConstructor">return</a> <a id="3358" class="Number">1</a> <a id="3360" href="Complex-Model.example.votingexample-single-candidate.html#3186" class="Bound">msg</a>                                           
<a id="3407" class="Comment">-- in case to delete voter</a>
<a id="3434" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="3445" class="Number">1</a> <a id="3447" class="Symbol">.</a><a id="3448" href="libraries.Mainlibrary.html#819" class="Field">fun</a> <a id="3452" class="String">&quot;deleteVoter&quot;</a> <a id="3466" href="Complex-Model.example.votingexample-single-candidate.html#3466" class="Bound">msg</a> <a id="3470" class="Symbol">=</a> <a id="3472" href="Complex-Model.ccomand.ccommands-cresponse.html#1656" class="InductiveConstructor">exec</a> <a id="3477" class="Symbol">(</a><a id="3478" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="3486" class="String">&quot;checkVoter&quot;</a> <a id="3499" class="Symbol">(</a><a id="3500" href="Complex-Model.example.votingexample-single-candidate.html#1657" class="Function">deleteVoterAux</a> <a id="3515" href="Complex-Model.example.votingexample-single-candidate.html#3466" class="Bound">msg</a><a id="3518" class="Symbol">)</a> <a id="3520" class="Symbol">λ</a> <a id="3522" href="Complex-Model.example.votingexample-single-candidate.html#3522" class="Bound">oldFun</a> <a id="3529" href="Complex-Model.example.votingexample-single-candidate.html#3529" class="Bound">oldcost</a> <a id="3537" href="Complex-Model.example.votingexample-single-candidate.html#3537" class="Bound">msg</a> <a id="3541" class="Symbol">→</a> <a id="3543" class="Number">1</a><a id="3544" class="Symbol">)</a>
                                      <a id="3584" class="Symbol">(λ</a> <a id="3587" href="Complex-Model.example.votingexample-single-candidate.html#3587" class="Bound">_</a> <a id="3589" class="Symbol">→</a> <a id="3591" class="Number">1</a><a id="3592" class="Symbol">)</a> <a id="3594" class="Symbol">λ</a> <a id="3596" href="Complex-Model.example.votingexample-single-candidate.html#3596" class="Bound">_</a> <a id="3598" class="Symbol">→</a> <a id="3600" href="Complex-Model.ccomand.ccommands-cresponse.html#1558" class="InductiveConstructor">return</a> <a id="3607" class="Number">1</a> <a id="3609" href="Complex-Model.example.votingexample-single-candidate.html#3466" class="Bound">msg</a>
<a id="3613" class="Comment">-- in case to vote</a>
<a id="3632" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="3643" class="Number">1</a> <a id="3645" class="Symbol">.</a><a id="3646" href="libraries.Mainlibrary.html#819" class="Field">fun</a> <a id="3650" class="String">&quot;vote&quot;</a> <a id="3657" href="Complex-Model.example.votingexample-single-candidate.html#3657" class="Bound">msg</a> <a id="3661" class="Symbol">=</a> <a id="3663" href="Complex-Model.ccomand.ccommands-cresponse.html#1656" class="InductiveConstructor">exec</a> <a id="3668" href="Complex-Model.ccomand.ccommands-cresponse.html#683" class="InductiveConstructor">callAddrLookupc</a>  <a id="3685" class="Symbol">(λ</a> <a id="3688" href="Complex-Model.example.votingexample-single-candidate.html#3688" class="Bound">_</a> <a id="3690" class="Symbol">→</a> <a id="3692" class="Number">1</a><a id="3693" class="Symbol">)</a>
                               <a id="3726" class="Symbol">λ</a> <a id="3728" href="Complex-Model.example.votingexample-single-candidate.html#3728" class="Bound">addr</a> <a id="3733" class="Symbol">→</a> <a id="3735" href="Complex-Model.ccomand.ccommands-cresponse.html#1656" class="InductiveConstructor">exec</a> <a id="3740" class="Symbol">(</a><a id="3741" href="Complex-Model.ccomand.ccommands-cresponse.html#770" class="InductiveConstructor">callPure</a> <a id="3750" href="Complex-Model.example.votingexample-single-candidate.html#3728" class="Bound">addr</a> <a id="3755" class="String">&quot;checkVoter&quot;</a> <a id="3768" class="Symbol">(</a><a id="3769" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3773" href="Complex-Model.example.votingexample-single-candidate.html#3728" class="Bound">addr</a><a id="3777" class="Symbol">))</a>
                               <a id="3811" class="Symbol">(λ</a> <a id="3814" href="Complex-Model.example.votingexample-single-candidate.html#3814" class="Bound">_</a> <a id="3816" class="Symbol">→</a> <a id="3818" class="Number">1</a><a id="3819" class="Symbol">)</a> <a id="3821" class="Symbol">λ</a> <a id="3823" href="Complex-Model.example.votingexample-single-candidate.html#3823" class="Bound">check</a> <a id="3829" class="Symbol">→</a> <a id="3831" href="Complex-Model.example.votingexample-single-candidate.html#2172" class="Function">voteAux</a> <a id="3839" href="Complex-Model.example.votingexample-single-candidate.html#3728" class="Bound">addr</a> <a id="3844" href="Complex-Model.example.votingexample-single-candidate.html#3823" class="Bound">check</a>
<a id="3850" class="Comment">-- in case to check voter</a>
<a id="3876" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="3887" class="Number">1</a> <a id="3889" class="Symbol">.</a><a id="3890" href="libraries.Mainlibrary.html#875" class="Field">purefunction</a> <a id="3903" class="String">&quot;checkVoter&quot;</a> <a id="3916" href="Complex-Model.example.votingexample-single-candidate.html#3916" class="Bound">msg</a> <a id="3920" class="Symbol">=</a> <a id="3922" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3929" class="Symbol">(</a><a id="3930" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3934" class="Number">0</a><a id="3935" class="Symbol">)</a>

<a id="3938" class="Comment">-- in case to increment our counter</a>
<a id="3974" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="3985" class="Number">1</a> <a id="3987" class="Symbol">.</a><a id="3988" href="libraries.Mainlibrary.html#875" class="Field">purefunction</a> <a id="4001" class="String">&quot;counter&quot;</a> <a id="4011" href="Complex-Model.example.votingexample-single-candidate.html#4011" class="Bound">msg</a> <a id="4015" class="Symbol">=</a> <a id="4017" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="4024" class="Symbol">(</a><a id="4025" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="4029" class="Number">0</a><a id="4030" class="Symbol">)</a>

<a id="4033" class="Comment">-- the pure function cost to checkvoter</a>
<a id="4073" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="4084" class="Number">1</a> <a id="4086" class="Symbol">.</a><a id="4087" href="libraries.Mainlibrary.html#1019" class="Field">purefunctionCost</a> <a id="4104" class="String">&quot;checkVoter&quot;</a> <a id="4117" href="Complex-Model.example.votingexample-single-candidate.html#4117" class="Bound">msg</a> <a id="4121" class="Symbol">=</a> <a id="4123" class="Number">1</a>

<a id="4126" class="Comment">-- define a ledger for address 3 with amount only</a>
<a id="4176" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="Function">testLedger</a> <a id="4187" class="Number">3</a> <a id="4189" class="Symbol">.</a><a id="4190" href="libraries.Mainlibrary.html#797" class="Field">amount</a> <a id="4197" class="Symbol">=</a> <a id="4199" class="Number">100</a>

<a id="4204" class="Comment">-- for other cases</a>
<a id="4223" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="CatchallClause Function">testLedger</a><a id="4233" class="CatchallClause"> </a><a id="4234" href="Complex-Model.example.votingexample-single-candidate.html#4234" class="CatchallClause Bound">ow</a><a id="4236" class="CatchallClause"> </a><a id="4237" class="CatchallClause Symbol">.</a><a id="4238" href="libraries.Mainlibrary.html#797" class="CatchallClause Field">amount</a> <a id="4245" class="Symbol">=</a> <a id="4247" class="Number">0</a>
<a id="4249" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="CatchallClause Function">testLedger</a><a id="4259" class="CatchallClause"> </a><a id="4260" href="Complex-Model.example.votingexample-single-candidate.html#4260" class="CatchallClause Bound">ow</a><a id="4262" class="CatchallClause"> </a><a id="4263" class="CatchallClause Symbol">.</a><a id="4264" href="libraries.Mainlibrary.html#819" class="CatchallClause Field">fun</a><a id="4267" class="CatchallClause"> </a><a id="4268" href="Complex-Model.example.votingexample-single-candidate.html#4268" class="CatchallClause Bound">ow&#39;</a><a id="4271" class="CatchallClause"> </a><a id="4272" href="Complex-Model.example.votingexample-single-candidate.html#4272" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4277" class="Symbol">=</a> <a id="4279" href="Complex-Model.ccomand.ccommands-cresponse.html#1599" class="InductiveConstructor">error</a> <a id="4285" class="Symbol">(</a><a id="4286" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4293" class="String">&quot;Undefined&quot;</a><a id="4304" class="Symbol">)</a> <a id="4306" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="4308" href="Complex-Model.example.votingexample-single-candidate.html#4260" class="Bound">ow</a> <a id="4311" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="4314" href="Complex-Model.example.votingexample-single-candidate.html#4260" class="Bound">ow</a> <a id="4317" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="4319" href="Complex-Model.example.votingexample-single-candidate.html#4268" class="Bound">ow&#39;</a> <a id="4323" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="4325" href="Complex-Model.example.votingexample-single-candidate.html#4272" class="Bound">ow&#39;&#39;</a> <a id="4330" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="4333" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="CatchallClause Function">testLedger</a><a id="4343" class="CatchallClause"> </a><a id="4344" href="Complex-Model.example.votingexample-single-candidate.html#4344" class="CatchallClause Bound">ow</a><a id="4346" class="CatchallClause"> </a><a id="4347" class="CatchallClause Symbol">.</a><a id="4348" href="libraries.Mainlibrary.html#875" class="CatchallClause Field">purefunction</a><a id="4360" class="CatchallClause"> </a><a id="4361" href="Complex-Model.example.votingexample-single-candidate.html#4361" class="CatchallClause Bound">ow&#39;</a><a id="4364" class="CatchallClause"> </a><a id="4365" href="Complex-Model.example.votingexample-single-candidate.html#4365" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4370" class="Symbol">=</a> <a id="4372" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="4376" class="Symbol">(</a><a id="4377" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4384" class="String">&quot;Undefined&quot;</a><a id="4395" class="Symbol">)</a>
<a id="4397" href="Complex-Model.example.votingexample-single-candidate.html#2997" class="CatchallClause Function">testLedger</a><a id="4407" class="CatchallClause"> </a><a id="4408" href="Complex-Model.example.votingexample-single-candidate.html#4408" class="CatchallClause Bound">ow</a><a id="4410" class="CatchallClause"> </a><a id="4411" class="CatchallClause Symbol">.</a><a id="4412" href="libraries.Mainlibrary.html#1019" class="CatchallClause Field">purefunctionCost</a><a id="4428" class="CatchallClause"> </a><a id="4429" href="Complex-Model.example.votingexample-single-candidate.html#4429" class="CatchallClause Bound">ow&#39;</a><a id="4432" class="CatchallClause"> </a><a id="4433" href="Complex-Model.example.votingexample-single-candidate.html#4433" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4438" class="Symbol">=</a> <a id="4440" class="Number">1</a>

</pre></body></html>