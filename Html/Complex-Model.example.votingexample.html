<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.votingexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.votingexample.html" class="Module">Complex-Model.example.votingexample</a>  <a id="77" class="Keyword">where</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.List.html" class="Module">Data.List</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> 
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Product.html" class="Module">Data.Product</a> <a id="188" class="Keyword">renaming</a> <a id="197" class="Symbol">(</a><a id="198" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="202" class="Symbol">to</a> <a id="205" class="InductiveConstructor Operator">_,,_</a> <a id="210" class="Symbol">)</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="235" class="Keyword">hiding</a> <a id="242" class="Symbol">(</a><a id="243" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="248" class="Symbol">)</a>
<a id="250" class="Keyword">open</a> <a id="255" class="Keyword">import</a> <a id="262" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> 
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.Fin.Base.html#5404" class="Function Operator">_+_</a><a id="340" class="Symbol">;</a> <a id="342" href="Data.Fin.Base.html#5540" class="Function Operator">_-_</a><a id="345" class="Symbol">)</a>
<a id="347" class="Keyword">import</a> <a id="354" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="392" class="Symbol">as</a> <a id="395" class="Module">Eq</a>
<a id="398" class="Keyword">open</a> <a id="403" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="406" class="Keyword">using</a> <a id="412" class="Symbol">(</a><a id="413" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="417" class="Symbol">;</a> <a id="419" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="424" class="Symbol">;</a> <a id="426" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="430" class="Symbol">;</a> <a id="432" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">open</a> <a id="443" class="Keyword">import</a> <a id="450" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="467" class="Keyword">using</a> <a id="473" class="Symbol">(</a><a id="474" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="477" class="Symbol">;</a> <a id="479" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Data.String.html" class="Module">Data.String</a> <a id="508" class="Keyword">hiding</a> <a id="515" class="Symbol">(</a><a id="516" href="Data.String.Base.html#2430" class="Function">length</a><a id="522" class="Symbol">;</a> <a id="524" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="528" class="Symbol">)</a> <a id="530" class="Keyword">renaming</a> <a id="539" class="Symbol">(</a><a id="540" href="Data.String.Base.html#2366" class="Function Operator">_++_</a> <a id="545" class="Symbol">to</a> <a id="548" class="Function Operator">_++str_</a><a id="555" class="Symbol">)</a>

<a id="558" class="Comment">--our work</a>
<a id="569" class="Keyword">open</a> <a id="574" class="Keyword">import</a>  <a id="582" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="664" href="constantparameters.html#969" class="Function">exampleParameters</a>
<a id="682" class="Keyword">open</a> <a id="687" class="Keyword">import</a> <a id="694" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="736" class="Keyword">open</a> <a id="741" class="Keyword">import</a> <a id="748" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a>
<a id="799" class="Keyword">open</a> <a id="804" class="Keyword">import</a> <a id="811" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>



<a id="836" class="Comment">--initial function</a>
<a id="initialfun"></a><a id="855" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="866" class="Symbol">:</a> <a id="868" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="872" class="Symbol">→</a> <a id="874" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="885" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="896" class="Symbol">(</a><a id="897" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="901" href="Complex-Model.example.votingexample.html#901" class="Bound">n</a><a id="902" class="Symbol">)</a> <a id="904" class="Symbol">=</a> <a id="906" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="913" class="Symbol">(</a><a id="914" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="918" class="Number">0</a><a id="919" class="Symbol">)</a>
<a id="921" href="Complex-Model.example.votingexample.html#855" class="CatchallClause Function">initialfun</a><a id="931" class="CatchallClause"> </a><a id="932" href="Complex-Model.example.votingexample.html#932" class="CatchallClause Bound">owmsg</a>   <a id="940" class="Symbol">=</a> <a id="942" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="946" class="Symbol">(</a><a id="947" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="954" class="String">&quot; The message is not a number &quot;</a><a id="985" class="Symbol">)</a>


<a id="updateCounterAux2"></a><a id="989" href="Complex-Model.example.votingexample.html#989" class="Function">updateCounterAux2</a> <a id="1007" class="Symbol">:</a> <a id="1009" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="1016" class="Symbol">→</a> <a id="1018" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1022" class="Symbol">→</a> <a id="1024" href="Complex-Model.ccomand.ccommands-cresponse.html#1661" class="Function">FunDef</a>
<a id="1031" href="Complex-Model.example.votingexample.html#989" class="Function">updateCounterAux2</a> <a id="1049" href="Complex-Model.example.votingexample.html#1049" class="Bound">s</a> <a id="1051" class="Symbol">(</a><a id="1052" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1056" href="Complex-Model.example.votingexample.html#1056" class="Bound">n</a><a id="1057" class="Symbol">)</a> <a id="1059" href="Complex-Model.example.votingexample.html#1059" class="Bound">msg₁</a> <a id="1064" class="Symbol">=</a> <a id="1066" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="1071" class="Symbol">(</a><a id="1072" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="1080" class="String">&quot;counter&quot;</a> <a id="1090" class="Symbol">(λ</a> <a id="1093" href="Complex-Model.example.votingexample.html#1093" class="Bound">x</a> <a id="1095" href="Complex-Model.example.votingexample.html#1095" class="Bound">x₁</a> <a id="1098" class="Symbol">→</a> <a id="1100" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="1111" class="Symbol">(</a><a id="1112" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1116" href="Complex-Model.example.votingexample.html#1056" class="Bound">n</a><a id="1117" class="Symbol">))</a> <a id="1120" class="Symbol">λ</a> <a id="1122" href="Complex-Model.example.votingexample.html#1122" class="Bound">x</a> <a id="1124" class="Symbol">→</a> <a id="1126" class="Number">1</a><a id="1127" class="Symbol">)</a> <a id="1129" class="Symbol">(λ</a> <a id="1132" href="Complex-Model.example.votingexample.html#1132" class="Bound">_</a> <a id="1134" class="Symbol">→</a> <a id="1136" class="Number">1</a><a id="1137" class="Symbol">)</a>
                                 <a id="1172" class="Symbol">λ</a> <a id="1174" href="Complex-Model.example.votingexample.html#1174" class="Bound">result</a> <a id="1181" class="Symbol">→</a>  <a id="1184" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1191" class="Number">1</a> <a id="1193" class="Symbol">(</a><a id="1194" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1198" class="Symbol">(</a><a id="1199" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1203" href="Complex-Model.example.votingexample.html#1056" class="Bound">n</a> <a id="1205" class="Symbol">))</a> 
<a id="1209" href="Complex-Model.example.votingexample.html#989" class="CatchallClause Function">updateCounterAux2</a><a id="1226" class="CatchallClause"> </a><a id="1227" href="Complex-Model.example.votingexample.html#1227" class="CatchallClause Bound">s</a><a id="1228" class="CatchallClause"> </a><a id="1229" href="Complex-Model.example.votingexample.html#1229" class="CatchallClause Bound">otherwise</a><a id="1238" class="CatchallClause"> </a><a id="1239" href="Complex-Model.example.votingexample.html#1239" class="CatchallClause Bound">msg₂</a> <a id="1244" class="Symbol">=</a> <a id="1246" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1253" class="Number">1</a> <a id="1255" class="Symbol">(</a><a id="1256" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1260" class="Number">17</a><a id="1262" class="Symbol">)</a>


<a id="1266" class="Comment">--increment function</a>
<a id="1287" class="Comment">-- incrementAux (theMsg (nat n)) sets the counter to n + 1</a>
<a id="1346" class="Comment">--</a>
<a id="1349" class="Comment">-- it would be clearer to define a setCounter function</a>
<a id="1404" class="Comment">--  setCounter (theMsg (nat n)) sets the counter to n</a>
<a id="incrementAux"></a><a id="1458" href="Complex-Model.example.votingexample.html#1458" class="Function">incrementAux</a> <a id="1471" class="Symbol">:</a> <a id="1473" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="1491" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="1495" href="Complex-Model.example.votingexample.html#1458" class="Function">incrementAux</a> <a id="1508" class="Symbol">(</a><a id="1509" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1516" class="Symbol">(</a><a id="1517" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1521" href="Complex-Model.example.votingexample.html#1521" class="Bound">n</a><a id="1522" class="Symbol">))</a> <a id="1525" class="Symbol">=</a> <a id="1527" class="Symbol">(</a><a id="1528" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="1533" class="Symbol">(</a><a id="1534" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="1542" class="String">&quot;counter&quot;</a> <a id="1552" class="Symbol">(λ</a> <a id="1555" href="Complex-Model.example.votingexample.html#1555" class="Bound">_</a> <a id="1557" class="Symbol">→</a> <a id="1559" class="Symbol">λ</a> <a id="1561" href="Complex-Model.example.votingexample.html#1561" class="Bound">msg</a> <a id="1565" class="Symbol">→</a> <a id="1567" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1574" class="Symbol">(</a><a id="1575" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1579" class="Symbol">(</a><a id="1580" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1584" href="Complex-Model.example.votingexample.html#1521" class="Bound">n</a><a id="1585" class="Symbol">)))</a> <a id="1589" class="Symbol">λ</a> <a id="1591" href="Complex-Model.example.votingexample.html#1591" class="Bound">f</a> <a id="1593" class="Symbol">→</a> <a id="1595" class="Number">1</a><a id="1596" class="Symbol">)</a>
                                                         <a id="1655" class="Symbol">(λ</a> <a id="1658" href="Complex-Model.example.votingexample.html#1658" class="Bound">n</a> <a id="1660" class="Symbol">→</a> <a id="1662" class="Number">1</a><a id="1663" class="Symbol">))</a> <a id="1666" class="Symbol">λ</a> <a id="1668" href="Complex-Model.example.votingexample.html#1668" class="Bound">x</a> <a id="1670" class="Symbol">→</a> <a id="1672" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1679" class="Number">1</a> <a id="1681" class="Symbol">(</a><a id="1682" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1686" class="Symbol">(</a><a id="1687" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1691" href="Complex-Model.example.votingexample.html#1521" class="Bound">n</a><a id="1692" class="Symbol">))</a>
<a id="1695" href="Complex-Model.example.votingexample.html#1458" class="CatchallClause Function">incrementAux</a><a id="1707" class="CatchallClause"> </a><a id="1708" href="Complex-Model.example.votingexample.html#1708" class="CatchallClause Bound">ow</a> <a id="1711" class="Symbol">=</a> <a id="1713" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="1719" class="Symbol">(</a><a id="1720" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1727" class="String">&quot;counter returns not a number&quot;</a><a id="1757" class="Symbol">)</a> <a id="1759" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="1761" class="Number">0</a> <a id="1763" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1766" class="Number">0</a> <a id="1768" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="1770" class="String">&quot;increment&quot;</a> <a id="1782" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="1784" class="Symbol">(</a><a id="1785" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1789" class="Number">0</a><a id="1790" class="Symbol">)</a> <a id="1792" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>



<a id="1798" class="Comment">--add voter function</a>
<a id="addVoterAux"></a><a id="1819" href="Complex-Model.example.votingexample.html#1819" class="Function">addVoterAux</a> <a id="1831" class="Symbol">:</a> <a id="1833" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1837" class="Symbol">→</a> <a id="1839" class="Symbol">(</a><a id="1840" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1844" class="Symbol">→</a> <a id="1846" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1856" class="Symbol">)</a> <a id="1858" class="Symbol">→</a> <a id="1860" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1864" class="Symbol">→</a> <a id="1866" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="1877" href="Complex-Model.example.votingexample.html#1819" class="Function">addVoterAux</a> <a id="1889" class="Symbol">(</a><a id="1890" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1894" href="Complex-Model.example.votingexample.html#1894" class="Bound">newaddr</a><a id="1901" class="Symbol">)</a> <a id="1903" href="Complex-Model.example.votingexample.html#1903" class="Bound">oldCheckVoter</a> <a id="1917" class="Symbol">(</a><a id="1918" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1922" href="Complex-Model.example.votingexample.html#1922" class="Bound">addr</a><a id="1926" class="Symbol">)</a> <a id="1928" class="Symbol">=</a> <a id="1930" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1933" href="Complex-Model.example.votingexample.html#1894" class="Bound">newaddr</a> <a id="1941" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1944" href="Complex-Model.example.votingexample.html#1922" class="Bound">addr</a> <a id="1949" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1954" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1961" class="Symbol">(</a><a id="1962" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1966" class="Number">1</a><a id="1967" class="Symbol">)</a> <a id="1969" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1974" href="Complex-Model.example.votingexample.html#1903" class="Bound">oldCheckVoter</a> <a id="1988" class="Symbol">(</a><a id="1989" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1993" href="Complex-Model.example.votingexample.html#1922" class="Bound">addr</a><a id="1997" class="Symbol">)</a>
<a id="1999" href="Complex-Model.example.votingexample.html#1819" class="CatchallClause Function">addVoterAux</a><a id="2010" class="CatchallClause"> </a><a id="2011" href="Complex-Model.example.votingexample.html#2011" class="CatchallClause Bound">ow</a><a id="2013" class="CatchallClause"> </a><a id="2014" href="Complex-Model.example.votingexample.html#2014" class="CatchallClause Bound">ow&#39;</a><a id="2017" class="CatchallClause"> </a><a id="2018" href="Complex-Model.example.votingexample.html#2018" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="2023" class="Symbol">=</a> <a id="2025" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2029" class="Symbol">(</a><a id="2030" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2037" class="String">&quot; You cannot add voter &quot;</a><a id="2061" class="Symbol">)</a>



<a id="2066" class="Comment">--delete voter function</a>
<a id="deleteVoterAux"></a><a id="2090" href="Complex-Model.example.votingexample.html#2090" class="Function">deleteVoterAux</a> <a id="2105" class="Symbol">:</a> <a id="2107" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="2111" class="Symbol">→</a> <a id="2113" class="Symbol">(</a><a id="2114" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="2118" class="Symbol">→</a> <a id="2120" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="2130" class="Symbol">)</a> <a id="2132" class="Symbol">→</a> <a id="2134" class="Symbol">(</a><a id="2135" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="2139" class="Symbol">→</a> <a id="2141" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="2151" class="Symbol">)</a>
<a id="2153" href="Complex-Model.example.votingexample.html#2090" class="Function">deleteVoterAux</a> <a id="2168" class="Symbol">(</a><a id="2169" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2173" href="Complex-Model.example.votingexample.html#2173" class="Bound">newaddr</a><a id="2180" class="Symbol">)</a> <a id="2182" href="Complex-Model.example.votingexample.html#2182" class="Bound">oldCheckVoter</a> <a id="2196" class="Symbol">(</a><a id="2197" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2201" href="Complex-Model.example.votingexample.html#2201" class="Bound">addr</a><a id="2205" class="Symbol">)</a> <a id="2207" class="Symbol">=</a> <a id="2209" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2212" href="Complex-Model.example.votingexample.html#2173" class="Bound">newaddr</a> <a id="2220" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="2223" href="Complex-Model.example.votingexample.html#2201" class="Bound">addr</a> <a id="2228" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2233" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2240" class="Symbol">(</a><a id="2241" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2245" class="Number">0</a><a id="2246" class="Symbol">)</a> <a id="2248" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2253" href="Complex-Model.example.votingexample.html#2182" class="Bound">oldCheckVoter</a> <a id="2267" class="Symbol">(</a><a id="2268" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2272" href="Complex-Model.example.votingexample.html#2201" class="Bound">addr</a><a id="2276" class="Symbol">)</a>
<a id="2278" href="Complex-Model.example.votingexample.html#2090" class="CatchallClause Function">deleteVoterAux</a><a id="2292" class="CatchallClause"> </a><a id="2293" href="Complex-Model.example.votingexample.html#2293" class="CatchallClause Bound">ow</a><a id="2295" class="CatchallClause"> </a><a id="2296" href="Complex-Model.example.votingexample.html#2296" class="CatchallClause Bound">ow&#39;</a><a id="2299" class="CatchallClause"> </a><a id="2300" href="Complex-Model.example.votingexample.html#2300" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="2305" class="Symbol">=</a> <a id="2307" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2311" class="Symbol">(</a><a id="2312" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2319" class="String">&quot; You cannot delete voter &quot;</a><a id="2346" class="Symbol">)</a>



<a id="2351" class="Comment">-- the function below we use it in case to check voter is allowed to vote or not </a>
<a id="voteAux"></a><a id="2433" href="Complex-Model.example.votingexample.html#2433" class="Function">voteAux</a> <a id="2441" class="Symbol">:</a> <a id="2443" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="2454" class="Symbol">→</a> <a id="2456" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="2461" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="2465" class="Comment">{- first case: the voter is NOT allowed to vote -}</a>
<a id="2516" href="Complex-Model.example.votingexample.html#2433" class="Function">voteAux</a> <a id="2524" class="Symbol">(</a><a id="2525" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2532" class="Symbol">(</a><a id="2533" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2537" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="2541" class="Symbol">))</a> <a id="2544" class="Symbol">=</a> <a id="2546" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="2552" class="Symbol">(</a><a id="2553" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2560" class="String">&quot;The message is zero&quot;</a><a id="2581" class="Symbol">)</a> <a id="2583" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2585" class="Number">0</a> <a id="2587" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2590" class="Number">0</a> <a id="2592" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2594" class="String">&quot; Voter is not allowed to vote &quot;</a> <a id="2627" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2629" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2633" class="Number">0</a> <a id="2635" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2638" class="Comment">{- first case: the voter is allowed to vote -}</a>
<a id="2685" href="Complex-Model.example.votingexample.html#2433" class="Function">voteAux</a> <a id="2693" class="Symbol">(</a><a id="2694" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2701" class="Symbol">(</a><a id="2702" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2706" class="Symbol">(</a><a id="2707" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2711" href="Complex-Model.example.votingexample.html#2711" class="Bound">n</a><a id="2712" class="Symbol">)))</a> <a id="2716" class="Symbol">=</a> <a id="2718" class="Symbol">(</a><a id="2719" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="2724" class="Symbol">(</a><a id="2725" href="Complex-Model.ccomand.ccommands-cresponse.html#730" class="InductiveConstructor">callPure</a> <a id="2734" class="Number">5</a> <a id="2736" class="String">&quot;counter&quot;</a> <a id="2746" class="Symbol">(</a><a id="2747" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2751" class="Number">0</a><a id="2752" class="Symbol">))</a> <a id="2755" class="Symbol">(λ</a> <a id="2758" href="Complex-Model.example.votingexample.html#2758" class="Bound">result</a> <a id="2765" class="Symbol">→</a> <a id="2767" class="Number">1</a><a id="2768" class="Symbol">))</a>
                                  <a id="2805" class="Symbol">λ</a> <a id="2807" href="Complex-Model.example.votingexample.html#2807" class="Bound">msg</a> <a id="2811" class="Symbol">→</a> <a id="2813" href="Complex-Model.example.votingexample.html#1458" class="Function">incrementAux</a> <a id="2826" href="Complex-Model.example.votingexample.html#2807" class="Bound">msg</a>
  <a id="2832" class="Comment">{- values before  need to be revised, you need to add more arguments to voteAux0  -}</a>
<a id="2917" href="Complex-Model.example.votingexample.html#2433" class="CatchallClause Function">voteAux</a><a id="2924" class="CatchallClause"> </a><a id="2925" class="CatchallClause Symbol">(</a><a id="2926" href="basicDataStructure.html#1452" class="CatchallClause InductiveConstructor">theMsg</a><a id="2932" class="CatchallClause"> </a><a id="2933" href="Complex-Model.example.votingexample.html#2933" class="CatchallClause Bound">ow</a><a id="2935" class="CatchallClause Symbol">)</a> <a id="2937" class="Symbol">=</a> <a id="2939" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="2945" class="Symbol">(</a><a id="2946" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2953" class="String">&quot; The message is not a number &quot;</a><a id="2984" class="Symbol">)</a> <a id="2986" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2988" class="Number">0</a> <a id="2990" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2993" class="Number">0</a> <a id="2995" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2997" class="String">&quot; Voter is not allowed to vote &quot;</a> <a id="3030" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="3032" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3036" class="Number">0</a> <a id="3038" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
  <a id="3043" class="Comment">{- values before  need to be revised, you need to add more arguments to voteAux0  -}</a>
<a id="3128" href="Complex-Model.example.votingexample.html#2433" class="Function">voteAux</a> <a id="3136" class="Symbol">(</a><a id="3137" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="3141" href="Complex-Model.example.votingexample.html#3141" class="Bound">x</a><a id="3142" class="Symbol">)</a> <a id="3144" class="Symbol">=</a> <a id="3146" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="3152" class="Symbol">(</a><a id="3153" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="3160" class="String">&quot; Undefined &quot;</a><a id="3173" class="Symbol">)</a> <a id="3175" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="3177" class="Number">0</a> <a id="3179" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="3182" class="Number">0</a> <a id="3184" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="3186" class="String">&quot; The message is undefined &quot;</a> <a id="3215" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="3217" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3221" class="Number">0</a> <a id="3223" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>






<a id="testLedger"></a><a id="3232" href="Complex-Model.example.votingexample.html#3232" class="Function">testLedger</a> <a id="3243" class="Symbol">:</a> <a id="3245" href="libraries.Mainlibrary.html#1044" class="Function">Ledger</a>
<a id="3252" href="Complex-Model.example.votingexample.html#3232" class="Function">testLedger</a> <a id="3263" class="Number">1</a> <a id="3265" class="Symbol">.</a><a id="3266" href="libraries.Mainlibrary.html#808" class="Field">amount</a> <a id="3273" class="Symbol">=</a> <a id="3275" class="Number">100</a>                                                                                        

<a id="3368" class="Comment">-- in case to add voter</a>
<a id="3392" href="Complex-Model.example.votingexample.html#3232" class="Function">testLedger</a> <a id="3403" class="Number">1</a> <a id="3405" class="Symbol">.</a><a id="3406" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3410" class="String">&quot;addVoter&quot;</a> <a id="3421" href="Complex-Model.example.votingexample.html#3421" class="Bound">msg</a>  <a id="3426" class="Symbol">=</a> <a id="3428" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="3433" class="Symbol">(</a><a id="3434" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="3442" class="String">&quot;checkVoter&quot;</a>
                                    <a id="3491" class="Symbol">(</a><a id="3492" href="Complex-Model.example.votingexample.html#1819" class="Function">addVoterAux</a> <a id="3504" href="Complex-Model.example.votingexample.html#3421" class="Bound">msg</a><a id="3507" class="Symbol">)</a> <a id="3509" class="Symbol">λ</a> <a id="3511" href="Complex-Model.example.votingexample.html#3511" class="Bound">_</a> <a id="3513" class="Symbol">→</a> <a id="3515" class="Number">1</a><a id="3516" class="Symbol">)(λ</a> <a id="3520" href="Complex-Model.example.votingexample.html#3520" class="Bound">_</a> <a id="3522" class="Symbol">→</a> <a id="3524" class="Number">1</a><a id="3525" class="Symbol">)</a>
                                    <a id="3563" class="Symbol">λ</a> <a id="3565" href="Complex-Model.example.votingexample.html#3565" class="Bound">_</a> <a id="3567" class="Symbol">→</a> <a id="3569" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="3576" class="Number">1</a> <a id="3578" href="Complex-Model.example.votingexample.html#3421" class="Bound">msg</a>                                           
<a id="3625" class="Comment">-- in case to delete voter</a>
<a id="3652" href="Complex-Model.example.votingexample.html#3232" class="Function">testLedger</a> <a id="3663" class="Number">1</a> <a id="3665" class="Symbol">.</a><a id="3666" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3670" class="String">&quot;deleteVoter&quot;</a> <a id="3684" href="Complex-Model.example.votingexample.html#3684" class="Bound">msg</a> <a id="3688" class="Symbol">=</a> <a id="3690" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="3695" class="Symbol">(</a><a id="3696" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="3704" class="String">&quot;checkVoter&quot;</a> <a id="3717" class="Symbol">(</a><a id="3718" href="Complex-Model.example.votingexample.html#2090" class="Function">deleteVoterAux</a> <a id="3733" href="Complex-Model.example.votingexample.html#3684" class="Bound">msg</a><a id="3736" class="Symbol">)</a> <a id="3738" class="Symbol">λ</a> <a id="3740" href="Complex-Model.example.votingexample.html#3740" class="Bound">_</a> <a id="3742" class="Symbol">→</a> <a id="3744" class="Number">1</a><a id="3745" class="Symbol">)</a>
                                      <a id="3785" class="Symbol">(λ</a> <a id="3788" href="Complex-Model.example.votingexample.html#3788" class="Bound">_</a> <a id="3790" class="Symbol">→</a> <a id="3792" class="Number">1</a><a id="3793" class="Symbol">)</a> <a id="3795" class="Symbol">λ</a> <a id="3797" href="Complex-Model.example.votingexample.html#3797" class="Bound">_</a> <a id="3799" class="Symbol">→</a> <a id="3801" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="3808" class="Number">1</a> <a id="3810" href="Complex-Model.example.votingexample.html#3684" class="Bound">msg</a>
<a id="3814" class="Comment">-- in case to vote</a>
<a id="3833" href="Complex-Model.example.votingexample.html#3232" class="Function">testLedger</a> <a id="3844" class="Number">1</a> <a id="3846" class="Symbol">.</a><a id="3847" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3851" class="String">&quot;vote&quot;</a> <a id="3858" href="Complex-Model.example.votingexample.html#3858" class="Bound">msg</a> <a id="3862" class="Symbol">=</a> <a id="3864" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="3869" href="Complex-Model.ccomand.ccommands-cresponse.html#643" class="InductiveConstructor">callAddrLookupc</a>  <a id="3886" class="Symbol">(λ</a> <a id="3889" href="Complex-Model.example.votingexample.html#3889" class="Bound">_</a> <a id="3891" class="Symbol">→</a> <a id="3893" class="Number">1</a><a id="3894" class="Symbol">)</a>
                               <a id="3927" class="Symbol">λ</a> <a id="3929" href="Complex-Model.example.votingexample.html#3929" class="Bound">addr</a> <a id="3934" class="Symbol">→</a> <a id="3936" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="3941" class="Symbol">(</a><a id="3942" href="Complex-Model.ccomand.ccommands-cresponse.html#730" class="InductiveConstructor">callPure</a> <a id="3951" href="Complex-Model.example.votingexample.html#3929" class="Bound">addr</a> <a id="3956" class="String">&quot;checkVoter&quot;</a> <a id="3969" class="Symbol">(</a><a id="3970" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3974" href="Complex-Model.example.votingexample.html#3929" class="Bound">addr</a><a id="3978" class="Symbol">))</a>
                               <a id="4012" class="Symbol">(λ</a> <a id="4015" href="Complex-Model.example.votingexample.html#4015" class="Bound">_</a> <a id="4017" class="Symbol">→</a> <a id="4019" class="Number">1</a><a id="4020" class="Symbol">)</a> <a id="4022" class="Symbol">λ</a> <a id="4024" href="Complex-Model.example.votingexample.html#4024" class="Bound">check</a> <a id="4030" class="Symbol">→</a> <a id="4032" href="Complex-Model.example.votingexample.html#2433" class="Function">voteAux</a> <a id="4040" href="Complex-Model.example.votingexample.html#4024" class="Bound">check</a>
<a id="4046" class="Comment">-- in case to check voter</a>
<a id="4072" href="Complex-Model.example.votingexample.html#3232" class="Function">testLedger</a> <a id="4083" class="Number">1</a> <a id="4085" class="Symbol">.</a><a id="4086" href="libraries.Mainlibrary.html#865" class="Field">purefunction</a> <a id="4099" class="String">&quot;checkVoter&quot;</a> <a id="4112" href="Complex-Model.example.votingexample.html#4112" class="Bound">msg</a> <a id="4116" class="Symbol">=</a> <a id="4118" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="4125" class="Symbol">(</a><a id="4126" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="4130" class="Number">0</a><a id="4131" class="Symbol">)</a>

<a id="4134" class="Comment">-- for other cases</a>
<a id="4153" href="Complex-Model.example.votingexample.html#3232" class="CatchallClause Function">testLedger</a><a id="4163" class="CatchallClause"> </a><a id="4164" href="Complex-Model.example.votingexample.html#4164" class="CatchallClause Bound">ow</a><a id="4166" class="CatchallClause"> </a><a id="4167" class="CatchallClause Symbol">.</a><a id="4168" href="libraries.Mainlibrary.html#808" class="CatchallClause Field">amount</a> <a id="4175" class="Symbol">=</a> <a id="4177" class="Number">0</a>
<a id="4179" href="Complex-Model.example.votingexample.html#3232" class="CatchallClause Function">testLedger</a><a id="4189" class="CatchallClause"> </a><a id="4190" href="Complex-Model.example.votingexample.html#4190" class="CatchallClause Bound">ow</a><a id="4192" class="CatchallClause"> </a><a id="4193" class="CatchallClause Symbol">.</a><a id="4194" href="libraries.Mainlibrary.html#830" class="CatchallClause Field">fun</a><a id="4197" class="CatchallClause"> </a><a id="4198" href="Complex-Model.example.votingexample.html#4198" class="CatchallClause Bound">ow&#39;</a><a id="4201" class="CatchallClause"> </a><a id="4202" href="Complex-Model.example.votingexample.html#4202" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4207" class="Symbol">=</a> <a id="4209" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="4215" class="Symbol">(</a><a id="4216" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4223" class="String">&quot;Undefined&quot;</a><a id="4234" class="Symbol">)</a> <a id="4236" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="4238" href="Complex-Model.example.votingexample.html#4190" class="Bound">ow</a> <a id="4241" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="4244" href="Complex-Model.example.votingexample.html#4190" class="Bound">ow</a> <a id="4247" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="4249" href="Complex-Model.example.votingexample.html#4198" class="Bound">ow&#39;</a> <a id="4253" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="4255" href="Complex-Model.example.votingexample.html#4202" class="Bound">ow&#39;&#39;</a> <a id="4260" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="4263" href="Complex-Model.example.votingexample.html#3232" class="CatchallClause Function">testLedger</a><a id="4273" class="CatchallClause"> </a><a id="4274" href="Complex-Model.example.votingexample.html#4274" class="CatchallClause Bound">ow</a><a id="4276" class="CatchallClause"> </a><a id="4277" class="CatchallClause Symbol">.</a><a id="4278" href="libraries.Mainlibrary.html#865" class="CatchallClause Field">purefunction</a><a id="4290" class="CatchallClause"> </a><a id="4291" href="Complex-Model.example.votingexample.html#4291" class="CatchallClause Bound">ow&#39;</a><a id="4294" class="CatchallClause"> </a><a id="4295" href="Complex-Model.example.votingexample.html#4295" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4300" class="Symbol">=</a> <a id="4302" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="4306" class="Symbol">(</a><a id="4307" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4314" class="String">&quot;Undefined&quot;</a><a id="4325" class="Symbol">)</a>


</pre></body></html>