<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.votingexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.votingexample.html" class="Module">Complex-Model.example.votingexample</a>  <a id="77" class="Keyword">where</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.List.html" class="Module">Data.List</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> 
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Product.html" class="Module">Data.Product</a> <a id="188" class="Keyword">renaming</a> <a id="197" class="Symbol">(</a><a id="198" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="202" class="Symbol">to</a> <a id="205" class="InductiveConstructor Operator">_,,_</a> <a id="210" class="Symbol">)</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="235" class="Keyword">hiding</a> <a id="242" class="Symbol">(</a><a id="243" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="248" class="Symbol">)</a>
<a id="250" class="Keyword">open</a> <a id="255" class="Keyword">import</a> <a id="262" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> 
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.Fin.Base.html#5404" class="Function Operator">_+_</a><a id="340" class="Symbol">;</a> <a id="342" href="Data.Fin.Base.html#5540" class="Function Operator">_-_</a><a id="345" class="Symbol">)</a>
<a id="347" class="Keyword">import</a> <a id="354" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="392" class="Symbol">as</a> <a id="395" class="Module">Eq</a>
<a id="398" class="Keyword">open</a> <a id="403" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="406" class="Keyword">using</a> <a id="412" class="Symbol">(</a><a id="413" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="417" class="Symbol">;</a> <a id="419" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="424" class="Symbol">;</a> <a id="426" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="430" class="Symbol">;</a> <a id="432" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">open</a> <a id="443" class="Keyword">import</a> <a id="450" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="467" class="Keyword">using</a> <a id="473" class="Symbol">(</a><a id="474" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="477" class="Symbol">;</a> <a id="479" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Data.String.html" class="Module">Data.String</a> <a id="508" class="Keyword">hiding</a> <a id="515" class="Symbol">(</a><a id="516" href="Data.String.Base.html#2430" class="Function">length</a><a id="522" class="Symbol">;</a> <a id="524" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="528" class="Symbol">)</a> <a id="530" class="Keyword">renaming</a> <a id="539" class="Symbol">(</a><a id="540" href="Data.String.Base.html#2366" class="Function Operator">_++_</a> <a id="545" class="Symbol">to</a> <a id="548" class="Function Operator">_++str_</a><a id="555" class="Symbol">)</a>

<a id="558" class="Comment">--our work</a>
<a id="569" class="Keyword">open</a> <a id="574" class="Keyword">import</a>  <a id="582" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="664" href="constantparameters.html#969" class="Function">exampleParameters</a>
<a id="682" class="Keyword">open</a> <a id="687" class="Keyword">import</a> <a id="694" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="736" class="Keyword">open</a> <a id="741" class="Keyword">import</a> <a id="748" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>



<a id="804" class="Comment">--initial function</a>
<a id="initialfun"></a><a id="823" href="Complex-Model.example.votingexample.html#823" class="Function">initialfun</a> <a id="834" class="Symbol">:</a> <a id="836" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="840" class="Symbol">→</a> <a id="842" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="853" href="Complex-Model.example.votingexample.html#823" class="Function">initialfun</a> <a id="864" class="Symbol">(</a><a id="865" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="869" href="Complex-Model.example.votingexample.html#869" class="Bound">n</a><a id="870" class="Symbol">)</a> <a id="872" class="Symbol">=</a> <a id="874" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="881" class="Symbol">(</a><a id="882" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="886" class="Number">0</a><a id="887" class="Symbol">)</a>
<a id="889" href="Complex-Model.example.votingexample.html#823" class="CatchallClause Function">initialfun</a><a id="899" class="CatchallClause"> </a><a id="900" href="Complex-Model.example.votingexample.html#900" class="CatchallClause Bound">owmsg</a>   <a id="908" class="Symbol">=</a> <a id="910" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="914" class="Symbol">(</a><a id="915" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="922" class="String">&quot; The message is not a number &quot;</a><a id="953" class="Symbol">)</a>


<a id="957" class="Comment">--increment function</a>
<a id="incrementAux"></a><a id="978" href="Complex-Model.example.votingexample.html#978" class="Function">incrementAux</a> <a id="991" class="Symbol">:</a> <a id="993" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="1004" class="Symbol">→</a> <a id="1006" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="1024" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="1028" href="Complex-Model.example.votingexample.html#978" class="Function">incrementAux</a> <a id="1041" class="Symbol">(</a><a id="1042" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1049" class="Symbol">(</a><a id="1050" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1054" href="Complex-Model.example.votingexample.html#1054" class="Bound">n</a><a id="1055" class="Symbol">))</a> <a id="1058" class="Symbol">=</a> <a id="1060" class="Symbol">(</a><a id="1061" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="1066" class="Symbol">(</a><a id="1067" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="1075" class="String">&quot;counter&quot;</a> <a id="1085" class="Symbol">(λ</a> <a id="1088" href="Complex-Model.example.votingexample.html#1088" class="Bound">_</a> <a id="1090" class="Symbol">→</a> <a id="1092" class="Symbol">λ</a> <a id="1094" href="Complex-Model.example.votingexample.html#1094" class="Bound">msg</a> <a id="1098" class="Symbol">→</a> <a id="1100" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1107" class="Symbol">(</a><a id="1108" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1112" class="Symbol">(</a><a id="1113" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1117" href="Complex-Model.example.votingexample.html#1054" class="Bound">n</a><a id="1118" class="Symbol">)))</a> <a id="1122" class="Symbol">λ</a> <a id="1124" href="Complex-Model.example.votingexample.html#1124" class="Bound">f</a> <a id="1126" class="Symbol">→</a> <a id="1128" class="Number">1</a><a id="1129" class="Symbol">)</a>
                                                         <a id="1188" class="Symbol">(λ</a> <a id="1191" href="Complex-Model.example.votingexample.html#1191" class="Bound">n</a> <a id="1193" class="Symbol">→</a> <a id="1195" class="Number">1</a><a id="1196" class="Symbol">))</a> <a id="1199" class="Symbol">λ</a> <a id="1201" href="Complex-Model.example.votingexample.html#1201" class="Bound">x</a> <a id="1203" class="Symbol">→</a> <a id="1205" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="1212" class="Number">1</a> <a id="1214" class="Symbol">(</a><a id="1215" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1219" class="Symbol">(</a><a id="1220" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1224" href="Complex-Model.example.votingexample.html#1054" class="Bound">n</a><a id="1225" class="Symbol">))</a>
<a id="1228" href="Complex-Model.example.votingexample.html#978" class="CatchallClause Function">incrementAux</a><a id="1240" class="CatchallClause"> </a><a id="1241" href="Complex-Model.example.votingexample.html#1241" class="CatchallClause Bound">ow</a> <a id="1244" class="Symbol">=</a> <a id="1246" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="1252" class="Symbol">(</a><a id="1253" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1260" class="String">&quot;counter returns not a number&quot;</a><a id="1290" class="Symbol">)</a> <a id="1292" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="1294" class="Number">0</a> <a id="1296" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1299" class="Number">0</a> <a id="1301" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="1303" class="String">&quot;increment&quot;</a> <a id="1315" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="1317" class="Symbol">(</a><a id="1318" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1322" class="Number">0</a><a id="1323" class="Symbol">)</a> <a id="1325" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>



<a id="1331" class="Comment">--add voter function</a>
<a id="addVoterAux"></a><a id="1352" href="Complex-Model.example.votingexample.html#1352" class="Function">addVoterAux</a> <a id="1364" class="Symbol">:</a> <a id="1366" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1370" class="Symbol">→</a> <a id="1372" class="Symbol">(</a><a id="1373" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1377" class="Symbol">→</a> <a id="1379" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1389" class="Symbol">)</a> <a id="1391" class="Symbol">→</a> <a id="1393" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1397" class="Symbol">→</a> <a id="1399" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="1410" href="Complex-Model.example.votingexample.html#1352" class="Function">addVoterAux</a> <a id="1422" class="Symbol">(</a><a id="1423" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1427" href="Complex-Model.example.votingexample.html#1427" class="Bound">newaddr</a><a id="1434" class="Symbol">)</a> <a id="1436" href="Complex-Model.example.votingexample.html#1436" class="Bound">oldCheckVoter</a> <a id="1450" class="Symbol">(</a><a id="1451" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1455" href="Complex-Model.example.votingexample.html#1455" class="Bound">addr</a><a id="1459" class="Symbol">)</a> <a id="1461" class="Symbol">=</a> <a id="1463" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1466" href="Complex-Model.example.votingexample.html#1427" class="Bound">newaddr</a> <a id="1474" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1477" href="Complex-Model.example.votingexample.html#1455" class="Bound">addr</a> <a id="1482" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1487" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1494" class="Symbol">(</a><a id="1495" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1499" class="Number">1</a><a id="1500" class="Symbol">)</a> <a id="1502" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1507" href="Complex-Model.example.votingexample.html#1436" class="Bound">oldCheckVoter</a> <a id="1521" class="Symbol">(</a><a id="1522" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1526" href="Complex-Model.example.votingexample.html#1455" class="Bound">addr</a><a id="1530" class="Symbol">)</a>
<a id="1532" href="Complex-Model.example.votingexample.html#1352" class="CatchallClause Function">addVoterAux</a><a id="1543" class="CatchallClause"> </a><a id="1544" href="Complex-Model.example.votingexample.html#1544" class="CatchallClause Bound">ow</a><a id="1546" class="CatchallClause"> </a><a id="1547" href="Complex-Model.example.votingexample.html#1547" class="CatchallClause Bound">ow&#39;</a><a id="1550" class="CatchallClause"> </a><a id="1551" href="Complex-Model.example.votingexample.html#1551" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1556" class="Symbol">=</a> <a id="1558" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="1562" class="Symbol">(</a><a id="1563" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1570" class="String">&quot; You cannot add voter &quot;</a><a id="1594" class="Symbol">)</a>



<a id="1599" class="Comment">--delete voter function</a>
<a id="deleteVoterAux"></a><a id="1623" href="Complex-Model.example.votingexample.html#1623" class="Function">deleteVoterAux</a> <a id="1638" class="Symbol">:</a> <a id="1640" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1644" class="Symbol">→</a> <a id="1646" class="Symbol">(</a><a id="1647" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1651" class="Symbol">→</a> <a id="1653" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1663" class="Symbol">)</a> <a id="1665" class="Symbol">→</a> <a id="1667" class="Symbol">(</a><a id="1668" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1672" class="Symbol">→</a> <a id="1674" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1684" class="Symbol">)</a>
<a id="1686" href="Complex-Model.example.votingexample.html#1623" class="Function">deleteVoterAux</a> <a id="1701" class="Symbol">(</a><a id="1702" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1706" href="Complex-Model.example.votingexample.html#1706" class="Bound">newaddr</a><a id="1713" class="Symbol">)</a> <a id="1715" href="Complex-Model.example.votingexample.html#1715" class="Bound">oldCheckVoter</a> <a id="1729" class="Symbol">(</a><a id="1730" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1734" href="Complex-Model.example.votingexample.html#1734" class="Bound">addr</a><a id="1738" class="Symbol">)</a> <a id="1740" class="Symbol">=</a> <a id="1742" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1745" href="Complex-Model.example.votingexample.html#1706" class="Bound">newaddr</a> <a id="1753" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1756" href="Complex-Model.example.votingexample.html#1734" class="Bound">addr</a> <a id="1761" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1766" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1773" class="Symbol">(</a><a id="1774" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1778" class="Number">0</a><a id="1779" class="Symbol">)</a> <a id="1781" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1786" href="Complex-Model.example.votingexample.html#1715" class="Bound">oldCheckVoter</a> <a id="1800" class="Symbol">(</a><a id="1801" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1805" href="Complex-Model.example.votingexample.html#1734" class="Bound">addr</a><a id="1809" class="Symbol">)</a>
<a id="1811" href="Complex-Model.example.votingexample.html#1623" class="CatchallClause Function">deleteVoterAux</a><a id="1825" class="CatchallClause"> </a><a id="1826" href="Complex-Model.example.votingexample.html#1826" class="CatchallClause Bound">ow</a><a id="1828" class="CatchallClause"> </a><a id="1829" href="Complex-Model.example.votingexample.html#1829" class="CatchallClause Bound">ow&#39;</a><a id="1832" class="CatchallClause"> </a><a id="1833" href="Complex-Model.example.votingexample.html#1833" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1838" class="Symbol">=</a> <a id="1840" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="1844" class="Symbol">(</a><a id="1845" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1852" class="String">&quot; You cannot delete voter &quot;</a><a id="1879" class="Symbol">)</a>



<a id="1884" class="Comment">-- the function below we use it in case to check voter is allowed to vote or not</a>
<a id="1965" class="Comment">-- in case nat 0 or otherwise it will return error and not allow to vote</a>
<a id="2038" class="Comment">-- in case suc (nat n) it will allow to vote and it will call incrementAux to increment the counter</a>
<a id="voteAux"></a><a id="2138" href="Complex-Model.example.votingexample.html#2138" class="Function">voteAux</a> <a id="2146" class="Symbol">:</a> <a id="2148" href="basicDataStructure.html#387" class="Function">Address</a> <a id="2156" class="Symbol">→</a> <a id="2158" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="2169" class="Symbol">→</a> <a id="2171" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="2189" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="2193" href="Complex-Model.example.votingexample.html#2138" class="Function">voteAux</a> <a id="2201" href="Complex-Model.example.votingexample.html#2201" class="Bound">addr</a> <a id="2206" class="Symbol">(</a><a id="2207" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2214" class="Symbol">(</a><a id="2215" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2219" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="2223" class="Symbol">))</a>    <a id="2229" class="Symbol">=</a> <a id="2231" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="2237" class="Symbol">(</a><a id="2238" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2245" class="String">&quot;The voter is not allowed to vote&quot;</a><a id="2279" class="Symbol">)</a>
                                    <a id="2317" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2319" class="Number">0</a> <a id="2321" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2324" class="Number">0</a> <a id="2326" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2328" class="String">&quot;Voter is not allowed to vote&quot;</a> <a id="2359" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2361" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2365" class="Number">0</a> <a id="2367" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2370" href="Complex-Model.example.votingexample.html#2138" class="Function">voteAux</a> <a id="2378" href="Complex-Model.example.votingexample.html#2378" class="Bound">addr</a> <a id="2383" class="Symbol">(</a><a id="2384" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2391" class="Symbol">(</a><a id="2392" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2396" class="Symbol">(</a><a id="2397" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2401" href="Complex-Model.example.votingexample.html#2401" class="Bound">n</a><a id="2402" class="Symbol">)))</a> <a id="2406" class="Symbol">=</a> <a id="2408" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="2413" class="Symbol">(</a><a id="2414" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="2422" class="String">&quot;checkVoter&quot;</a> <a id="2435" class="Symbol">(</a><a id="2436" href="Complex-Model.example.votingexample.html#1623" class="Function">deleteVoterAux</a> <a id="2451" class="Symbol">(</a><a id="2452" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2456" href="Complex-Model.example.votingexample.html#2378" class="Bound">addr</a><a id="2460" class="Symbol">))</a> <a id="2463" class="Symbol">λ</a> <a id="2465" href="Complex-Model.example.votingexample.html#2465" class="Bound">_</a> <a id="2467" class="Symbol">→</a> <a id="2469" class="Number">1</a><a id="2470" class="Symbol">)</a> <a id="2472" class="Symbol">(λ</a> <a id="2475" href="Complex-Model.example.votingexample.html#2475" class="Bound">_</a> <a id="2477" class="Symbol">→</a> <a id="2479" class="Number">1</a><a id="2480" class="Symbol">)</a>
                                    <a id="2518" class="Symbol">(λ</a> <a id="2521" href="Complex-Model.example.votingexample.html#2521" class="Bound">x</a> <a id="2523" class="Symbol">→</a> <a id="2525" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="2530" class="Symbol">(</a><a id="2531" href="Complex-Model.ccomand.ccommands-cresponse.html#731" class="InductiveConstructor">callPure</a> <a id="2540" class="Number">1</a> <a id="2542" class="String">&quot;counter&quot;</a> <a id="2552" class="Symbol">(</a><a id="2553" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2557" class="Number">0</a><a id="2558" class="Symbol">))</a> <a id="2561" class="Symbol">(λ</a> <a id="2564" href="Complex-Model.example.votingexample.html#2564" class="Bound">result</a> <a id="2571" class="Symbol">→</a> <a id="2573" class="Number">1</a><a id="2574" class="Symbol">)</a>
                                    <a id="2612" class="Symbol">λ</a> <a id="2614" href="Complex-Model.example.votingexample.html#2614" class="Bound">msg</a> <a id="2618" class="Symbol">→</a> <a id="2620" href="Complex-Model.example.votingexample.html#978" class="Function">incrementAux</a> <a id="2633" href="Complex-Model.example.votingexample.html#2614" class="Bound">msg</a><a id="2636" class="Symbol">)</a>
<a id="2638" href="Complex-Model.example.votingexample.html#2138" class="CatchallClause Function">voteAux</a><a id="2645" class="CatchallClause"> </a><a id="2646" href="Complex-Model.example.votingexample.html#2646" class="CatchallClause Bound">addr</a><a id="2650" class="CatchallClause"> </a><a id="2651" class="CatchallClause Symbol">(</a><a id="2652" href="basicDataStructure.html#1452" class="CatchallClause InductiveConstructor">theMsg</a><a id="2658" class="CatchallClause"> </a><a id="2659" href="Complex-Model.example.votingexample.html#2659" class="CatchallClause Bound">ow</a><a id="2661" class="CatchallClause Symbol">)</a>   <a id="2665" class="Symbol">=</a> <a id="2667" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="2673" class="Symbol">(</a><a id="2674" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2681" class="String">&quot;The message is not a number&quot;</a><a id="2710" class="Symbol">)</a>
                             <a id="2741" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2743" class="Number">0</a> <a id="2745" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2748" class="Number">0</a> <a id="2750" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2752" class="String">&quot;Voter is not allowed to vote&quot;</a> <a id="2783" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2785" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2789" class="Number">0</a> <a id="2791" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2794" href="Complex-Model.example.votingexample.html#2138" class="Function">voteAux</a> <a id="2802" href="Complex-Model.example.votingexample.html#2802" class="Bound">addr</a> <a id="2807" class="Symbol">(</a><a id="2808" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2812" href="Complex-Model.example.votingexample.html#2812" class="Bound">x</a><a id="2813" class="Symbol">)</a> <a id="2815" class="Symbol">=</a> <a id="2817" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="2823" class="Symbol">(</a><a id="2824" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2831" class="String">&quot; Undefined &quot;</a><a id="2844" class="Symbol">)</a>
                       <a id="2869" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2871" class="Number">0</a> <a id="2873" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2876" class="Number">0</a> <a id="2878" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2880" class="String">&quot;The message is undefined&quot;</a> <a id="2907" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2909" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2913" class="Number">0</a> <a id="2915" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>




<a id="2922" class="Comment">-----define our ledger</a>

<a id="testLedger"></a><a id="2946" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="2957" class="Symbol">:</a> <a id="2959" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a>
<a id="2966" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="2977" class="Number">1</a> <a id="2979" class="Symbol">.</a><a id="2980" href="libraries.Mainlibrary.html#808" class="Field">amount</a> <a id="2987" class="Symbol">=</a> <a id="2989" class="Number">100</a>                                                                                        

<a id="3082" class="Comment">-- in case to add voter</a>
<a id="3106" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="3117" class="Number">1</a> <a id="3119" class="Symbol">.</a><a id="3120" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3124" class="String">&quot;addVoter&quot;</a> <a id="3135" href="Complex-Model.example.votingexample.html#3135" class="Bound">msg</a>  <a id="3140" class="Symbol">=</a> <a id="3142" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="3147" class="Symbol">(</a><a id="3148" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="3156" class="String">&quot;checkVoter&quot;</a>
                                    <a id="3205" class="Symbol">(</a><a id="3206" href="Complex-Model.example.votingexample.html#1352" class="Function">addVoterAux</a> <a id="3218" href="Complex-Model.example.votingexample.html#3135" class="Bound">msg</a><a id="3221" class="Symbol">)</a> <a id="3223" class="Symbol">λ</a> <a id="3225" href="Complex-Model.example.votingexample.html#3225" class="Bound">_</a> <a id="3227" class="Symbol">→</a> <a id="3229" class="Number">1</a><a id="3230" class="Symbol">)(λ</a> <a id="3234" href="Complex-Model.example.votingexample.html#3234" class="Bound">_</a> <a id="3236" class="Symbol">→</a> <a id="3238" class="Number">1</a><a id="3239" class="Symbol">)</a>
                                    <a id="3277" class="Symbol">λ</a> <a id="3279" href="Complex-Model.example.votingexample.html#3279" class="Bound">_</a> <a id="3281" class="Symbol">→</a> <a id="3283" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="3290" class="Number">1</a> <a id="3292" href="Complex-Model.example.votingexample.html#3135" class="Bound">msg</a>                                           
<a id="3339" class="Comment">-- in case to delete voter</a>
<a id="3366" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="3377" class="Number">1</a> <a id="3379" class="Symbol">.</a><a id="3380" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3384" class="String">&quot;deleteVoter&quot;</a> <a id="3398" href="Complex-Model.example.votingexample.html#3398" class="Bound">msg</a> <a id="3402" class="Symbol">=</a> <a id="3404" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="3409" class="Symbol">(</a><a id="3410" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="3418" class="String">&quot;checkVoter&quot;</a> <a id="3431" class="Symbol">(</a><a id="3432" href="Complex-Model.example.votingexample.html#1623" class="Function">deleteVoterAux</a> <a id="3447" href="Complex-Model.example.votingexample.html#3398" class="Bound">msg</a><a id="3450" class="Symbol">)</a> <a id="3452" class="Symbol">λ</a> <a id="3454" href="Complex-Model.example.votingexample.html#3454" class="Bound">_</a> <a id="3456" class="Symbol">→</a> <a id="3458" class="Number">1</a><a id="3459" class="Symbol">)</a>
                                      <a id="3499" class="Symbol">(λ</a> <a id="3502" href="Complex-Model.example.votingexample.html#3502" class="Bound">_</a> <a id="3504" class="Symbol">→</a> <a id="3506" class="Number">1</a><a id="3507" class="Symbol">)</a> <a id="3509" class="Symbol">λ</a> <a id="3511" href="Complex-Model.example.votingexample.html#3511" class="Bound">_</a> <a id="3513" class="Symbol">→</a> <a id="3515" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="3522" class="Number">1</a> <a id="3524" href="Complex-Model.example.votingexample.html#3398" class="Bound">msg</a>
<a id="3528" class="Comment">-- in case to vote</a>
<a id="3547" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="3558" class="Number">1</a> <a id="3560" class="Symbol">.</a><a id="3561" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3565" class="String">&quot;vote&quot;</a> <a id="3572" href="Complex-Model.example.votingexample.html#3572" class="Bound">msg</a> <a id="3576" class="Symbol">=</a> <a id="3578" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="3583" href="Complex-Model.ccomand.ccommands-cresponse.html#644" class="InductiveConstructor">callAddrLookupc</a>  <a id="3600" class="Symbol">(λ</a> <a id="3603" href="Complex-Model.example.votingexample.html#3603" class="Bound">_</a> <a id="3605" class="Symbol">→</a> <a id="3607" class="Number">1</a><a id="3608" class="Symbol">)</a>
                               <a id="3641" class="Symbol">λ</a> <a id="3643" href="Complex-Model.example.votingexample.html#3643" class="Bound">addr</a> <a id="3648" class="Symbol">→</a> <a id="3650" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="3655" class="Symbol">(</a><a id="3656" href="Complex-Model.ccomand.ccommands-cresponse.html#731" class="InductiveConstructor">callPure</a> <a id="3665" href="Complex-Model.example.votingexample.html#3643" class="Bound">addr</a> <a id="3670" class="String">&quot;checkVoter&quot;</a> <a id="3683" class="Symbol">(</a><a id="3684" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3688" href="Complex-Model.example.votingexample.html#3643" class="Bound">addr</a><a id="3692" class="Symbol">))</a>
                               <a id="3726" class="Symbol">(λ</a> <a id="3729" href="Complex-Model.example.votingexample.html#3729" class="Bound">_</a> <a id="3731" class="Symbol">→</a> <a id="3733" class="Number">1</a><a id="3734" class="Symbol">)</a> <a id="3736" class="Symbol">λ</a> <a id="3738" href="Complex-Model.example.votingexample.html#3738" class="Bound">check</a> <a id="3744" class="Symbol">→</a> <a id="3746" href="Complex-Model.example.votingexample.html#2138" class="Function">voteAux</a> <a id="3754" href="Complex-Model.example.votingexample.html#3643" class="Bound">addr</a> <a id="3759" href="Complex-Model.example.votingexample.html#3738" class="Bound">check</a>
<a id="3765" class="Comment">-- in case to check voter</a>
<a id="3791" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="3802" class="Number">1</a> <a id="3804" class="Symbol">.</a><a id="3805" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="3818" class="String">&quot;checkVoter&quot;</a> <a id="3831" href="Complex-Model.example.votingexample.html#3831" class="Bound">msg</a> <a id="3835" class="Symbol">=</a> <a id="3837" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3844" class="Symbol">(</a><a id="3845" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3849" class="Number">0</a><a id="3850" class="Symbol">)</a>

<a id="3853" class="Comment">-- in case to increment our counter</a>
<a id="3889" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="3900" class="Number">1</a> <a id="3902" class="Symbol">.</a><a id="3903" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="3916" class="String">&quot;counter&quot;</a> <a id="3926" href="Complex-Model.example.votingexample.html#3926" class="Bound">msg</a> <a id="3930" class="Symbol">=</a> <a id="3932" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3939" class="Symbol">(</a><a id="3940" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3944" class="Number">0</a><a id="3945" class="Symbol">)</a>

<a id="3948" class="Comment">-- define a ledger for address 3 with amount only</a>
<a id="3998" href="Complex-Model.example.votingexample.html#2946" class="Function">testLedger</a> <a id="4009" class="Number">3</a> <a id="4011" class="Symbol">.</a><a id="4012" href="libraries.Mainlibrary.html#808" class="Field">amount</a> <a id="4019" class="Symbol">=</a> <a id="4021" class="Number">100</a>

<a id="4026" class="Comment">-- for other cases</a>
<a id="4045" href="Complex-Model.example.votingexample.html#2946" class="CatchallClause Function">testLedger</a><a id="4055" class="CatchallClause"> </a><a id="4056" href="Complex-Model.example.votingexample.html#4056" class="CatchallClause Bound">ow</a><a id="4058" class="CatchallClause"> </a><a id="4059" class="CatchallClause Symbol">.</a><a id="4060" href="libraries.Mainlibrary.html#808" class="CatchallClause Field">amount</a> <a id="4067" class="Symbol">=</a> <a id="4069" class="Number">0</a>
<a id="4071" href="Complex-Model.example.votingexample.html#2946" class="CatchallClause Function">testLedger</a><a id="4081" class="CatchallClause"> </a><a id="4082" href="Complex-Model.example.votingexample.html#4082" class="CatchallClause Bound">ow</a><a id="4084" class="CatchallClause"> </a><a id="4085" class="CatchallClause Symbol">.</a><a id="4086" href="libraries.Mainlibrary.html#830" class="CatchallClause Field">fun</a><a id="4089" class="CatchallClause"> </a><a id="4090" href="Complex-Model.example.votingexample.html#4090" class="CatchallClause Bound">ow&#39;</a><a id="4093" class="CatchallClause"> </a><a id="4094" href="Complex-Model.example.votingexample.html#4094" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4099" class="Symbol">=</a> <a id="4101" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="4107" class="Symbol">(</a><a id="4108" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4115" class="String">&quot;Undefined&quot;</a><a id="4126" class="Symbol">)</a> <a id="4128" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="4130" href="Complex-Model.example.votingexample.html#4082" class="Bound">ow</a> <a id="4133" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="4136" href="Complex-Model.example.votingexample.html#4082" class="Bound">ow</a> <a id="4139" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="4141" href="Complex-Model.example.votingexample.html#4090" class="Bound">ow&#39;</a> <a id="4145" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="4147" href="Complex-Model.example.votingexample.html#4094" class="Bound">ow&#39;&#39;</a> <a id="4152" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="4155" href="Complex-Model.example.votingexample.html#2946" class="CatchallClause Function">testLedger</a><a id="4165" class="CatchallClause"> </a><a id="4166" href="Complex-Model.example.votingexample.html#4166" class="CatchallClause Bound">ow</a><a id="4168" class="CatchallClause"> </a><a id="4169" class="CatchallClause Symbol">.</a><a id="4170" href="libraries.Mainlibrary.html#886" class="CatchallClause Field">purefunction</a><a id="4182" class="CatchallClause"> </a><a id="4183" href="Complex-Model.example.votingexample.html#4183" class="CatchallClause Bound">ow&#39;</a><a id="4186" class="CatchallClause"> </a><a id="4187" href="Complex-Model.example.votingexample.html#4187" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4192" class="Symbol">=</a> <a id="4194" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="4198" class="Symbol">(</a><a id="4199" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4206" class="String">&quot;Undefined&quot;</a><a id="4217" class="Symbol">)</a>


</pre></body></html>