<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.votingexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.votingexample.html" class="Module">Complex-Model.example.votingexample</a>  <a id="77" class="Keyword">where</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.List.html" class="Module">Data.List</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> 
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Product.html" class="Module">Data.Product</a> <a id="188" class="Keyword">renaming</a> <a id="197" class="Symbol">(</a><a id="198" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="202" class="Symbol">to</a> <a id="205" class="InductiveConstructor Operator">_,,_</a> <a id="210" class="Symbol">)</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="235" class="Keyword">hiding</a> <a id="242" class="Symbol">(</a><a id="243" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="248" class="Symbol">)</a>
<a id="250" class="Keyword">open</a> <a id="255" class="Keyword">import</a> <a id="262" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> 
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.Fin.Base.html#5404" class="Function Operator">_+_</a><a id="340" class="Symbol">;</a> <a id="342" href="Data.Fin.Base.html#5540" class="Function Operator">_-_</a><a id="345" class="Symbol">)</a>
<a id="347" class="Keyword">import</a> <a id="354" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="392" class="Symbol">as</a> <a id="395" class="Module">Eq</a>
<a id="398" class="Keyword">open</a> <a id="403" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="406" class="Keyword">using</a> <a id="412" class="Symbol">(</a><a id="413" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="417" class="Symbol">;</a> <a id="419" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="424" class="Symbol">;</a> <a id="426" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="430" class="Symbol">;</a> <a id="432" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">open</a> <a id="443" class="Keyword">import</a> <a id="450" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="467" class="Keyword">using</a> <a id="473" class="Symbol">(</a><a id="474" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="477" class="Symbol">;</a> <a id="479" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Data.String.html" class="Module">Data.String</a> <a id="508" class="Keyword">hiding</a> <a id="515" class="Symbol">(</a><a id="516" href="Data.String.Base.html#2430" class="Function">length</a><a id="522" class="Symbol">;</a> <a id="524" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="528" class="Symbol">)</a> <a id="530" class="Keyword">renaming</a> <a id="539" class="Symbol">(</a><a id="540" href="Data.String.Base.html#2366" class="Function Operator">_++_</a> <a id="545" class="Symbol">to</a> <a id="548" class="Function Operator">_++str_</a><a id="555" class="Symbol">)</a>

<a id="558" class="Comment">--our work</a>
<a id="569" class="Keyword">open</a> <a id="574" class="Keyword">import</a>  <a id="582" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="664" href="constantparameters.html#969" class="Function">exampleParameters</a>
<a id="682" class="Keyword">open</a> <a id="687" class="Keyword">import</a> <a id="694" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="736" class="Keyword">open</a> <a id="741" class="Keyword">import</a> <a id="748" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a>
<a id="799" class="Keyword">open</a> <a id="804" class="Keyword">import</a> <a id="811" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>



<a id="836" class="Comment">--initial function</a>
<a id="initialfun"></a><a id="855" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="866" class="Symbol">:</a> <a id="868" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="872" class="Symbol">→</a> <a id="874" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="885" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="896" class="Symbol">(</a><a id="897" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="901" href="Complex-Model.example.votingexample.html#901" class="Bound">n</a><a id="902" class="Symbol">)</a> <a id="904" class="Symbol">=</a> <a id="906" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="913" class="Symbol">(</a><a id="914" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="918" class="Number">0</a><a id="919" class="Symbol">)</a>
<a id="921" href="Complex-Model.example.votingexample.html#855" class="CatchallClause Function">initialfun</a><a id="931" class="CatchallClause"> </a><a id="932" href="Complex-Model.example.votingexample.html#932" class="CatchallClause Bound">owmsg</a>   <a id="940" class="Symbol">=</a> <a id="942" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="946" class="Symbol">(</a><a id="947" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="954" class="String">&quot; The message is not a number &quot;</a><a id="985" class="Symbol">)</a>


<a id="updateCounterAux2"></a><a id="989" href="Complex-Model.example.votingexample.html#989" class="Function">updateCounterAux2</a> <a id="1007" class="Symbol">:</a> <a id="1009" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="1016" class="Symbol">→</a> <a id="1018" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1022" class="Symbol">→</a> <a id="1024" class="Symbol">(</a><a id="1025" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1029" class="Symbol">→</a> <a id="1031" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="1049" href="basicDataStructure.html#488" class="Datatype">Msg</a><a id="1052" class="Symbol">)</a>
<a id="1054" href="Complex-Model.example.votingexample.html#989" class="Function">updateCounterAux2</a> <a id="1072" href="Complex-Model.example.votingexample.html#1072" class="Bound">s</a> <a id="1074" class="Symbol">(</a><a id="1075" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1079" href="Complex-Model.example.votingexample.html#1079" class="Bound">n</a><a id="1080" class="Symbol">)</a> <a id="1082" href="Complex-Model.example.votingexample.html#1082" class="Bound">msg₁</a> <a id="1087" class="Symbol">=</a> <a id="1089" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="1094" class="Symbol">(</a><a id="1095" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="1103" class="String">&quot;counter&quot;</a> <a id="1113" class="Symbol">(λ</a> <a id="1116" href="Complex-Model.example.votingexample.html#1116" class="Bound">x</a> <a id="1118" href="Complex-Model.example.votingexample.html#1118" class="Bound">x₁</a> <a id="1121" class="Symbol">→</a> <a id="1123" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="1134" class="Symbol">(</a><a id="1135" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1139" href="Complex-Model.example.votingexample.html#1079" class="Bound">n</a><a id="1140" class="Symbol">))</a> <a id="1143" class="Symbol">λ</a> <a id="1145" href="Complex-Model.example.votingexample.html#1145" class="Bound">x</a> <a id="1147" class="Symbol">→</a> <a id="1149" class="Number">1</a><a id="1150" class="Symbol">)</a> <a id="1152" class="Symbol">(λ</a> <a id="1155" href="Complex-Model.example.votingexample.html#1155" class="Bound">_</a> <a id="1157" class="Symbol">→</a> <a id="1159" class="Number">1</a><a id="1160" class="Symbol">)</a>
                                 <a id="1195" class="Symbol">λ</a> <a id="1197" href="Complex-Model.example.votingexample.html#1197" class="Bound">result</a> <a id="1204" class="Symbol">→</a>  <a id="1207" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="1214" class="Number">1</a> <a id="1216" class="Symbol">(</a><a id="1217" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1221" class="Symbol">(</a><a id="1222" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1226" href="Complex-Model.example.votingexample.html#1079" class="Bound">n</a> <a id="1228" class="Symbol">))</a> 
<a id="1232" href="Complex-Model.example.votingexample.html#989" class="CatchallClause Function">updateCounterAux2</a><a id="1249" class="CatchallClause"> </a><a id="1250" href="Complex-Model.example.votingexample.html#1250" class="CatchallClause Bound">s</a><a id="1251" class="CatchallClause"> </a><a id="1252" href="Complex-Model.example.votingexample.html#1252" class="CatchallClause Bound">otherwise</a><a id="1261" class="CatchallClause"> </a><a id="1262" href="Complex-Model.example.votingexample.html#1262" class="CatchallClause Bound">msg₂</a> <a id="1267" class="Symbol">=</a> <a id="1269" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="1276" class="Number">1</a> <a id="1278" class="Symbol">(</a><a id="1279" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1283" class="Number">17</a><a id="1285" class="Symbol">)</a>


<a id="1289" class="Comment">--increment function</a>
<a id="incrementAux"></a><a id="1310" href="Complex-Model.example.votingexample.html#1310" class="Function">incrementAux</a> <a id="1323" class="Symbol">:</a> <a id="1325" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="1336" class="Symbol">→</a> <a id="1338" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="1356" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="1360" href="Complex-Model.example.votingexample.html#1310" class="Function">incrementAux</a> <a id="1373" class="Symbol">(</a><a id="1374" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1381" class="Symbol">(</a><a id="1382" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1386" href="Complex-Model.example.votingexample.html#1386" class="Bound">n</a><a id="1387" class="Symbol">))</a> <a id="1390" class="Symbol">=</a> <a id="1392" class="Symbol">(</a><a id="1393" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="1398" class="Symbol">(</a><a id="1399" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="1407" class="String">&quot;counter&quot;</a> <a id="1417" class="Symbol">(λ</a> <a id="1420" href="Complex-Model.example.votingexample.html#1420" class="Bound">_</a> <a id="1422" class="Symbol">→</a> <a id="1424" class="Symbol">λ</a> <a id="1426" href="Complex-Model.example.votingexample.html#1426" class="Bound">msg</a> <a id="1430" class="Symbol">→</a> <a id="1432" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1439" class="Symbol">(</a><a id="1440" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1444" class="Symbol">(</a><a id="1445" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1449" href="Complex-Model.example.votingexample.html#1386" class="Bound">n</a><a id="1450" class="Symbol">)))</a> <a id="1454" class="Symbol">λ</a> <a id="1456" href="Complex-Model.example.votingexample.html#1456" class="Bound">f</a> <a id="1458" class="Symbol">→</a> <a id="1460" class="Number">1</a><a id="1461" class="Symbol">)</a>
                                                         <a id="1520" class="Symbol">(λ</a> <a id="1523" href="Complex-Model.example.votingexample.html#1523" class="Bound">n</a> <a id="1525" class="Symbol">→</a> <a id="1527" class="Number">1</a><a id="1528" class="Symbol">))</a> <a id="1531" class="Symbol">λ</a> <a id="1533" href="Complex-Model.example.votingexample.html#1533" class="Bound">x</a> <a id="1535" class="Symbol">→</a> <a id="1537" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="1544" class="Number">1</a> <a id="1546" class="Symbol">(</a><a id="1547" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1551" class="Symbol">(</a><a id="1552" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1556" href="Complex-Model.example.votingexample.html#1386" class="Bound">n</a><a id="1557" class="Symbol">))</a>
<a id="1560" href="Complex-Model.example.votingexample.html#1310" class="CatchallClause Function">incrementAux</a><a id="1572" class="CatchallClause"> </a><a id="1573" href="Complex-Model.example.votingexample.html#1573" class="CatchallClause Bound">ow</a> <a id="1576" class="Symbol">=</a> <a id="1578" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">error</a> <a id="1584" class="Symbol">(</a><a id="1585" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1592" class="String">&quot;counter returns not a number&quot;</a><a id="1622" class="Symbol">)</a> <a id="1624" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="1626" class="Number">0</a> <a id="1628" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1631" class="Number">0</a> <a id="1633" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="1635" class="String">&quot;increment&quot;</a> <a id="1647" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="1649" class="Symbol">(</a><a id="1650" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1654" class="Number">0</a><a id="1655" class="Symbol">)</a> <a id="1657" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>



<a id="1663" class="Comment">--add voter function</a>
<a id="addVoterAux"></a><a id="1684" href="Complex-Model.example.votingexample.html#1684" class="Function">addVoterAux</a> <a id="1696" class="Symbol">:</a> <a id="1698" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1702" class="Symbol">→</a> <a id="1704" class="Symbol">(</a><a id="1705" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1709" class="Symbol">→</a> <a id="1711" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1721" class="Symbol">)</a> <a id="1723" class="Symbol">→</a> <a id="1725" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1729" class="Symbol">→</a> <a id="1731" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="1742" href="Complex-Model.example.votingexample.html#1684" class="Function">addVoterAux</a> <a id="1754" class="Symbol">(</a><a id="1755" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1759" href="Complex-Model.example.votingexample.html#1759" class="Bound">newaddr</a><a id="1766" class="Symbol">)</a> <a id="1768" href="Complex-Model.example.votingexample.html#1768" class="Bound">oldCheckVoter</a> <a id="1782" class="Symbol">(</a><a id="1783" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1787" href="Complex-Model.example.votingexample.html#1787" class="Bound">addr</a><a id="1791" class="Symbol">)</a> <a id="1793" class="Symbol">=</a> <a id="1795" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1798" href="Complex-Model.example.votingexample.html#1759" class="Bound">newaddr</a> <a id="1806" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1809" href="Complex-Model.example.votingexample.html#1787" class="Bound">addr</a> <a id="1814" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1819" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1826" class="Symbol">(</a><a id="1827" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1831" class="Number">1</a><a id="1832" class="Symbol">)</a> <a id="1834" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1839" href="Complex-Model.example.votingexample.html#1768" class="Bound">oldCheckVoter</a> <a id="1853" class="Symbol">(</a><a id="1854" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1858" href="Complex-Model.example.votingexample.html#1787" class="Bound">addr</a><a id="1862" class="Symbol">)</a>
<a id="1864" href="Complex-Model.example.votingexample.html#1684" class="CatchallClause Function">addVoterAux</a><a id="1875" class="CatchallClause"> </a><a id="1876" href="Complex-Model.example.votingexample.html#1876" class="CatchallClause Bound">ow</a><a id="1878" class="CatchallClause"> </a><a id="1879" href="Complex-Model.example.votingexample.html#1879" class="CatchallClause Bound">ow&#39;</a><a id="1882" class="CatchallClause"> </a><a id="1883" href="Complex-Model.example.votingexample.html#1883" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1888" class="Symbol">=</a> <a id="1890" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="1894" class="Symbol">(</a><a id="1895" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1902" class="String">&quot; You cannot add voter &quot;</a><a id="1926" class="Symbol">)</a>



<a id="1931" class="Comment">--delete voter function</a>
<a id="deleteVoterAux"></a><a id="1955" href="Complex-Model.example.votingexample.html#1955" class="Function">deleteVoterAux</a> <a id="1970" class="Symbol">:</a> <a id="1972" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1976" class="Symbol">→</a> <a id="1978" class="Symbol">(</a><a id="1979" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1983" class="Symbol">→</a> <a id="1985" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1995" class="Symbol">)</a> <a id="1997" class="Symbol">→</a> <a id="1999" class="Symbol">(</a><a id="2000" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="2004" class="Symbol">→</a> <a id="2006" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="2016" class="Symbol">)</a>
<a id="2018" href="Complex-Model.example.votingexample.html#1955" class="Function">deleteVoterAux</a> <a id="2033" class="Symbol">(</a><a id="2034" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2038" href="Complex-Model.example.votingexample.html#2038" class="Bound">newaddr</a><a id="2045" class="Symbol">)</a> <a id="2047" href="Complex-Model.example.votingexample.html#2047" class="Bound">oldCheckVoter</a> <a id="2061" class="Symbol">(</a><a id="2062" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2066" href="Complex-Model.example.votingexample.html#2066" class="Bound">addr</a><a id="2070" class="Symbol">)</a> <a id="2072" class="Symbol">=</a> <a id="2074" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2077" href="Complex-Model.example.votingexample.html#2038" class="Bound">newaddr</a> <a id="2085" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="2088" href="Complex-Model.example.votingexample.html#2066" class="Bound">addr</a> <a id="2093" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2098" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2105" class="Symbol">(</a><a id="2106" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2110" class="Number">0</a><a id="2111" class="Symbol">)</a> <a id="2113" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2118" href="Complex-Model.example.votingexample.html#2047" class="Bound">oldCheckVoter</a> <a id="2132" class="Symbol">(</a><a id="2133" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2137" href="Complex-Model.example.votingexample.html#2066" class="Bound">addr</a><a id="2141" class="Symbol">)</a>
<a id="2143" href="Complex-Model.example.votingexample.html#1955" class="CatchallClause Function">deleteVoterAux</a><a id="2157" class="CatchallClause"> </a><a id="2158" href="Complex-Model.example.votingexample.html#2158" class="CatchallClause Bound">ow</a><a id="2160" class="CatchallClause"> </a><a id="2161" href="Complex-Model.example.votingexample.html#2161" class="CatchallClause Bound">ow&#39;</a><a id="2164" class="CatchallClause"> </a><a id="2165" href="Complex-Model.example.votingexample.html#2165" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="2170" class="Symbol">=</a> <a id="2172" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2176" class="Symbol">(</a><a id="2177" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2184" class="String">&quot; You cannot delete voter &quot;</a><a id="2211" class="Symbol">)</a>



<a id="2216" class="Comment">-- the function below we use it in case to check voter is allowed to vote or not</a>
<a id="2297" class="Comment">-- in case nat 0 or otherwise it will return error and not allow to vote</a>
<a id="2370" class="Comment">-- in case suc (nat n) it will allow to vote and it will call incrementAux to increment the counter</a>
<a id="voteAux"></a><a id="2470" href="Complex-Model.example.votingexample.html#2470" class="Function">voteAux</a> <a id="2478" class="Symbol">:</a> <a id="2480" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="2491" class="Symbol">→</a> <a id="2493" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="2511" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="2515" href="Complex-Model.example.votingexample.html#2470" class="Function">voteAux</a> <a id="2523" class="Symbol">(</a><a id="2524" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2531" class="Symbol">(</a><a id="2532" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2536" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="2540" class="Symbol">))</a> <a id="2543" class="Symbol">=</a> <a id="2545" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">error</a> <a id="2551" class="Symbol">(</a><a id="2552" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2559" class="String">&quot;The message is zero&quot;</a><a id="2580" class="Symbol">)</a> <a id="2582" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2584" class="Number">0</a> <a id="2586" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2589" class="Number">0</a> <a id="2591" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2593" class="String">&quot; Voter is not allowed to vote &quot;</a> <a id="2626" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2628" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2632" class="Number">0</a> <a id="2634" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2637" href="Complex-Model.example.votingexample.html#2470" class="Function">voteAux</a> <a id="2645" class="Symbol">(</a><a id="2646" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2653" class="Symbol">(</a><a id="2654" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2658" class="Symbol">(</a><a id="2659" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2663" href="Complex-Model.example.votingexample.html#2663" class="Bound">n</a><a id="2664" class="Symbol">)))</a> <a id="2668" class="Symbol">=</a> <a id="2670" class="Symbol">(</a><a id="2671" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="2676" class="Symbol">(</a><a id="2677" href="Complex-Model.ccomand.ccommands-cresponse.html#730" class="InductiveConstructor">callPure</a> <a id="2686" class="Number">5</a> <a id="2688" class="String">&quot;counter&quot;</a> <a id="2698" class="Symbol">(</a><a id="2699" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2703" class="Number">0</a><a id="2704" class="Symbol">))</a> <a id="2707" class="Symbol">(λ</a> <a id="2710" href="Complex-Model.example.votingexample.html#2710" class="Bound">result</a> <a id="2717" class="Symbol">→</a> <a id="2719" class="Number">1</a><a id="2720" class="Symbol">))</a>
                                  <a id="2757" class="Symbol">λ</a> <a id="2759" href="Complex-Model.example.votingexample.html#2759" class="Bound">msg</a> <a id="2763" class="Symbol">→</a> <a id="2765" href="Complex-Model.example.votingexample.html#1310" class="Function">incrementAux</a> <a id="2778" href="Complex-Model.example.votingexample.html#2759" class="Bound">msg</a>
<a id="2782" href="Complex-Model.example.votingexample.html#2470" class="CatchallClause Function">voteAux</a><a id="2789" class="CatchallClause"> </a><a id="2790" class="CatchallClause Symbol">(</a><a id="2791" href="basicDataStructure.html#1452" class="CatchallClause InductiveConstructor">theMsg</a><a id="2797" class="CatchallClause"> </a><a id="2798" href="Complex-Model.example.votingexample.html#2798" class="CatchallClause Bound">ow</a><a id="2800" class="CatchallClause Symbol">)</a> <a id="2802" class="Symbol">=</a> <a id="2804" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">error</a> <a id="2810" class="Symbol">(</a><a id="2811" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2818" class="String">&quot; The message is not a number &quot;</a><a id="2849" class="Symbol">)</a> <a id="2851" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2853" class="Number">0</a> <a id="2855" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2858" class="Number">0</a> <a id="2860" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2862" class="String">&quot; Voter is not allowed to vote &quot;</a> <a id="2895" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2897" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2901" class="Number">0</a> <a id="2903" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2906" href="Complex-Model.example.votingexample.html#2470" class="Function">voteAux</a> <a id="2914" class="Symbol">(</a><a id="2915" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2919" href="Complex-Model.example.votingexample.html#2919" class="Bound">x</a><a id="2920" class="Symbol">)</a> <a id="2922" class="Symbol">=</a> <a id="2924" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">error</a> <a id="2930" class="Symbol">(</a><a id="2931" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2938" class="String">&quot; Undefined &quot;</a><a id="2951" class="Symbol">)</a> <a id="2953" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2955" class="Number">0</a> <a id="2957" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2960" class="Number">0</a> <a id="2962" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2964" class="String">&quot; The message is undefined &quot;</a> <a id="2993" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2995" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2999" class="Number">0</a> <a id="3001" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>






<a id="testLedger"></a><a id="3010" href="Complex-Model.example.votingexample.html#3010" class="Function">testLedger</a> <a id="3021" class="Symbol">:</a> <a id="3023" href="libraries.Mainlibrary.html#1067" class="Function">Ledger</a>
<a id="3030" href="Complex-Model.example.votingexample.html#3010" class="Function">testLedger</a> <a id="3041" class="Number">1</a> <a id="3043" class="Symbol">.</a><a id="3044" href="libraries.Mainlibrary.html#808" class="Field">amount</a> <a id="3051" class="Symbol">=</a> <a id="3053" class="Number">100</a>                                                                                        

<a id="3146" class="Comment">-- in case to add voter</a>
<a id="3170" href="Complex-Model.example.votingexample.html#3010" class="Function">testLedger</a> <a id="3181" class="Number">1</a> <a id="3183" class="Symbol">.</a><a id="3184" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3188" class="String">&quot;addVoter&quot;</a> <a id="3199" href="Complex-Model.example.votingexample.html#3199" class="Bound">msg</a>  <a id="3204" class="Symbol">=</a> <a id="3206" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="3211" class="Symbol">(</a><a id="3212" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="3220" class="String">&quot;checkVoter&quot;</a>
                                    <a id="3269" class="Symbol">(</a><a id="3270" href="Complex-Model.example.votingexample.html#1684" class="Function">addVoterAux</a> <a id="3282" href="Complex-Model.example.votingexample.html#3199" class="Bound">msg</a><a id="3285" class="Symbol">)</a> <a id="3287" class="Symbol">λ</a> <a id="3289" href="Complex-Model.example.votingexample.html#3289" class="Bound">_</a> <a id="3291" class="Symbol">→</a> <a id="3293" class="Number">1</a><a id="3294" class="Symbol">)(λ</a> <a id="3298" href="Complex-Model.example.votingexample.html#3298" class="Bound">_</a> <a id="3300" class="Symbol">→</a> <a id="3302" class="Number">1</a><a id="3303" class="Symbol">)</a>
                                    <a id="3341" class="Symbol">λ</a> <a id="3343" href="Complex-Model.example.votingexample.html#3343" class="Bound">_</a> <a id="3345" class="Symbol">→</a> <a id="3347" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="3354" class="Number">1</a> <a id="3356" href="Complex-Model.example.votingexample.html#3199" class="Bound">msg</a>                                           
<a id="3403" class="Comment">-- in case to delete voter</a>
<a id="3430" href="Complex-Model.example.votingexample.html#3010" class="Function">testLedger</a> <a id="3441" class="Number">1</a> <a id="3443" class="Symbol">.</a><a id="3444" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3448" class="String">&quot;deleteVoter&quot;</a> <a id="3462" href="Complex-Model.example.votingexample.html#3462" class="Bound">msg</a> <a id="3466" class="Symbol">=</a> <a id="3468" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="3473" class="Symbol">(</a><a id="3474" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="3482" class="String">&quot;checkVoter&quot;</a> <a id="3495" class="Symbol">(</a><a id="3496" href="Complex-Model.example.votingexample.html#1955" class="Function">deleteVoterAux</a> <a id="3511" href="Complex-Model.example.votingexample.html#3462" class="Bound">msg</a><a id="3514" class="Symbol">)</a> <a id="3516" class="Symbol">λ</a> <a id="3518" href="Complex-Model.example.votingexample.html#3518" class="Bound">_</a> <a id="3520" class="Symbol">→</a> <a id="3522" class="Number">1</a><a id="3523" class="Symbol">)</a>
                                      <a id="3563" class="Symbol">(λ</a> <a id="3566" href="Complex-Model.example.votingexample.html#3566" class="Bound">_</a> <a id="3568" class="Symbol">→</a> <a id="3570" class="Number">1</a><a id="3571" class="Symbol">)</a> <a id="3573" class="Symbol">λ</a> <a id="3575" href="Complex-Model.example.votingexample.html#3575" class="Bound">_</a> <a id="3577" class="Symbol">→</a> <a id="3579" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="3586" class="Number">1</a> <a id="3588" href="Complex-Model.example.votingexample.html#3462" class="Bound">msg</a>
<a id="3592" class="Comment">-- in case to vote</a>
<a id="3611" href="Complex-Model.example.votingexample.html#3010" class="Function">testLedger</a> <a id="3622" class="Number">1</a> <a id="3624" class="Symbol">.</a><a id="3625" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3629" class="String">&quot;vote&quot;</a> <a id="3636" href="Complex-Model.example.votingexample.html#3636" class="Bound">msg</a> <a id="3640" class="Symbol">=</a> <a id="3642" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="3647" href="Complex-Model.ccomand.ccommands-cresponse.html#643" class="InductiveConstructor">callAddrLookupc</a>  <a id="3664" class="Symbol">(λ</a> <a id="3667" href="Complex-Model.example.votingexample.html#3667" class="Bound">_</a> <a id="3669" class="Symbol">→</a> <a id="3671" class="Number">1</a><a id="3672" class="Symbol">)</a>
                               <a id="3705" class="Symbol">λ</a> <a id="3707" href="Complex-Model.example.votingexample.html#3707" class="Bound">addr</a> <a id="3712" class="Symbol">→</a> <a id="3714" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="3719" class="Symbol">(</a><a id="3720" href="Complex-Model.ccomand.ccommands-cresponse.html#730" class="InductiveConstructor">callPure</a> <a id="3729" href="Complex-Model.example.votingexample.html#3707" class="Bound">addr</a> <a id="3734" class="String">&quot;checkVoter&quot;</a> <a id="3747" class="Symbol">(</a><a id="3748" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3752" href="Complex-Model.example.votingexample.html#3707" class="Bound">addr</a><a id="3756" class="Symbol">))</a>
                               <a id="3790" class="Symbol">(λ</a> <a id="3793" href="Complex-Model.example.votingexample.html#3793" class="Bound">_</a> <a id="3795" class="Symbol">→</a> <a id="3797" class="Number">1</a><a id="3798" class="Symbol">)</a> <a id="3800" class="Symbol">λ</a> <a id="3802" href="Complex-Model.example.votingexample.html#3802" class="Bound">check</a> <a id="3808" class="Symbol">→</a> <a id="3810" href="Complex-Model.example.votingexample.html#2470" class="Function">voteAux</a> <a id="3818" href="Complex-Model.example.votingexample.html#3802" class="Bound">check</a>
<a id="3824" class="Comment">-- in case to check voter</a>
<a id="3850" href="Complex-Model.example.votingexample.html#3010" class="Function">testLedger</a> <a id="3861" class="Number">1</a> <a id="3863" class="Symbol">.</a><a id="3864" href="libraries.Mainlibrary.html#888" class="Field">purefunction</a> <a id="3877" class="String">&quot;checkVoter&quot;</a> <a id="3890" href="Complex-Model.example.votingexample.html#3890" class="Bound">msg</a> <a id="3894" class="Symbol">=</a> <a id="3896" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3903" class="Symbol">(</a><a id="3904" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3908" class="Number">0</a><a id="3909" class="Symbol">)</a>

<a id="3912" class="Comment">-- in case to increment our counter</a>
<a id="3948" href="Complex-Model.example.votingexample.html#3010" class="Function">testLedger</a> <a id="3959" class="Number">1</a> <a id="3961" class="Symbol">.</a><a id="3962" href="libraries.Mainlibrary.html#888" class="Field">purefunction</a> <a id="3975" class="String">&quot;counter&quot;</a> <a id="3985" href="Complex-Model.example.votingexample.html#3985" class="Bound">msg</a> <a id="3989" class="Symbol">=</a> <a id="3991" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3998" class="Symbol">(</a><a id="3999" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="4003" class="Number">0</a><a id="4004" class="Symbol">)</a>

<a id="4007" class="Comment">-- for other cases</a>
<a id="4026" href="Complex-Model.example.votingexample.html#3010" class="CatchallClause Function">testLedger</a><a id="4036" class="CatchallClause"> </a><a id="4037" href="Complex-Model.example.votingexample.html#4037" class="CatchallClause Bound">ow</a><a id="4039" class="CatchallClause"> </a><a id="4040" class="CatchallClause Symbol">.</a><a id="4041" href="libraries.Mainlibrary.html#808" class="CatchallClause Field">amount</a> <a id="4048" class="Symbol">=</a> <a id="4050" class="Number">0</a>
<a id="4052" href="Complex-Model.example.votingexample.html#3010" class="CatchallClause Function">testLedger</a><a id="4062" class="CatchallClause"> </a><a id="4063" href="Complex-Model.example.votingexample.html#4063" class="CatchallClause Bound">ow</a><a id="4065" class="CatchallClause"> </a><a id="4066" class="CatchallClause Symbol">.</a><a id="4067" href="libraries.Mainlibrary.html#830" class="CatchallClause Field">fun</a><a id="4070" class="CatchallClause"> </a><a id="4071" href="Complex-Model.example.votingexample.html#4071" class="CatchallClause Bound">ow&#39;</a><a id="4074" class="CatchallClause"> </a><a id="4075" href="Complex-Model.example.votingexample.html#4075" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4080" class="Symbol">=</a> <a id="4082" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">error</a> <a id="4088" class="Symbol">(</a><a id="4089" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4096" class="String">&quot;Undefined&quot;</a><a id="4107" class="Symbol">)</a> <a id="4109" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="4111" href="Complex-Model.example.votingexample.html#4063" class="Bound">ow</a> <a id="4114" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="4117" href="Complex-Model.example.votingexample.html#4063" class="Bound">ow</a> <a id="4120" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="4122" href="Complex-Model.example.votingexample.html#4071" class="Bound">ow&#39;</a> <a id="4126" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="4128" href="Complex-Model.example.votingexample.html#4075" class="Bound">ow&#39;&#39;</a> <a id="4133" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="4136" href="Complex-Model.example.votingexample.html#3010" class="CatchallClause Function">testLedger</a><a id="4146" class="CatchallClause"> </a><a id="4147" href="Complex-Model.example.votingexample.html#4147" class="CatchallClause Bound">ow</a><a id="4149" class="CatchallClause"> </a><a id="4150" class="CatchallClause Symbol">.</a><a id="4151" href="libraries.Mainlibrary.html#888" class="CatchallClause Field">purefunction</a><a id="4163" class="CatchallClause"> </a><a id="4164" href="Complex-Model.example.votingexample.html#4164" class="CatchallClause Bound">ow&#39;</a><a id="4167" class="CatchallClause"> </a><a id="4168" href="Complex-Model.example.votingexample.html#4168" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4173" class="Symbol">=</a> <a id="4175" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="4179" class="Symbol">(</a><a id="4180" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4187" class="String">&quot;Undefined&quot;</a><a id="4198" class="Symbol">)</a>


</pre></body></html>