<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.votingexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.votingexample.html" class="Module">Complex-Model.example.votingexample</a>  <a id="77" class="Keyword">where</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.List.html" class="Module">Data.List</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> 
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Product.html" class="Module">Data.Product</a> <a id="188" class="Keyword">renaming</a> <a id="197" class="Symbol">(</a><a id="198" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="202" class="Symbol">to</a> <a id="205" class="InductiveConstructor Operator">_,,_</a> <a id="210" class="Symbol">)</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="235" class="Keyword">hiding</a> <a id="242" class="Symbol">(</a><a id="243" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="248" class="Symbol">)</a>
<a id="250" class="Keyword">open</a> <a id="255" class="Keyword">import</a> <a id="262" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> 
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.Fin.Base.html#5404" class="Function Operator">_+_</a><a id="340" class="Symbol">;</a> <a id="342" href="Data.Fin.Base.html#5540" class="Function Operator">_-_</a><a id="345" class="Symbol">)</a>
<a id="347" class="Keyword">import</a> <a id="354" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="392" class="Symbol">as</a> <a id="395" class="Module">Eq</a>
<a id="398" class="Keyword">open</a> <a id="403" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="406" class="Keyword">using</a> <a id="412" class="Symbol">(</a><a id="413" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="417" class="Symbol">;</a> <a id="419" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="424" class="Symbol">;</a> <a id="426" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="430" class="Symbol">;</a> <a id="432" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">open</a> <a id="443" class="Keyword">import</a> <a id="450" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="467" class="Keyword">using</a> <a id="473" class="Symbol">(</a><a id="474" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="477" class="Symbol">;</a> <a id="479" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Data.String.html" class="Module">Data.String</a> <a id="508" class="Keyword">hiding</a> <a id="515" class="Symbol">(</a><a id="516" href="Data.String.Base.html#2430" class="Function">length</a><a id="522" class="Symbol">;</a> <a id="524" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="528" class="Symbol">)</a> <a id="530" class="Keyword">renaming</a> <a id="539" class="Symbol">(</a><a id="540" href="Data.String.Base.html#2366" class="Function Operator">_++_</a> <a id="545" class="Symbol">to</a> <a id="548" class="Function Operator">_++str_</a><a id="555" class="Symbol">)</a>

<a id="558" class="Comment">--our work</a>
<a id="569" class="Keyword">open</a> <a id="574" class="Keyword">import</a>  <a id="582" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="664" href="constantparameters.html#969" class="Function">exampleParameters</a>
<a id="682" class="Keyword">open</a> <a id="687" class="Keyword">import</a> <a id="694" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="736" class="Keyword">open</a> <a id="741" class="Keyword">import</a> <a id="748" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a>
<a id="799" class="Keyword">open</a> <a id="804" class="Keyword">import</a> <a id="811" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>



<a id="836" class="Comment">--initial function</a>
<a id="initialfun"></a><a id="855" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="866" class="Symbol">:</a> <a id="868" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="872" class="Symbol">→</a> <a id="874" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="885" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="896" class="Symbol">(</a><a id="897" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="901" href="Complex-Model.example.votingexample.html#901" class="Bound">n</a><a id="902" class="Symbol">)</a> <a id="904" class="Symbol">=</a> <a id="906" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="913" class="Symbol">(</a><a id="914" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="918" class="Number">0</a><a id="919" class="Symbol">)</a>
<a id="921" href="Complex-Model.example.votingexample.html#855" class="CatchallClause Function">initialfun</a><a id="931" class="CatchallClause"> </a><a id="932" href="Complex-Model.example.votingexample.html#932" class="CatchallClause Bound">owmsg</a>   <a id="940" class="Symbol">=</a> <a id="942" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="946" class="Symbol">(</a><a id="947" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="954" class="String">&quot; The message is not a number &quot;</a><a id="985" class="Symbol">)</a>


<a id="updateCounterAux2"></a><a id="989" href="Complex-Model.example.votingexample.html#989" class="Function">updateCounterAux2</a> <a id="1007" class="Symbol">:</a> <a id="1009" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="1016" class="Symbol">→</a> <a id="1018" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1022" class="Symbol">→</a> <a id="1024" href="Complex-Model.ccomand.ccommands-cresponse.html#1661" class="Function">FunDef</a>
<a id="1031" href="Complex-Model.example.votingexample.html#989" class="Function">updateCounterAux2</a> <a id="1049" href="Complex-Model.example.votingexample.html#1049" class="Bound">s</a> <a id="1051" class="Symbol">(</a><a id="1052" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1056" href="Complex-Model.example.votingexample.html#1056" class="Bound">n</a><a id="1057" class="Symbol">)</a> <a id="1059" href="Complex-Model.example.votingexample.html#1059" class="Bound">msg₁</a> <a id="1064" class="Symbol">=</a> <a id="1066" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="1071" class="Symbol">(</a><a id="1072" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="1080" class="String">&quot;counter&quot;</a> <a id="1090" class="Symbol">(λ</a> <a id="1093" href="Complex-Model.example.votingexample.html#1093" class="Bound">x</a> <a id="1095" href="Complex-Model.example.votingexample.html#1095" class="Bound">x₁</a> <a id="1098" class="Symbol">→</a> <a id="1100" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="1111" class="Symbol">(</a><a id="1112" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1116" href="Complex-Model.example.votingexample.html#1056" class="Bound">n</a><a id="1117" class="Symbol">))</a> <a id="1120" class="Symbol">λ</a> <a id="1122" href="Complex-Model.example.votingexample.html#1122" class="Bound">x</a> <a id="1124" class="Symbol">→</a> <a id="1126" class="Number">1</a><a id="1127" class="Symbol">)</a> <a id="1129" class="Symbol">(λ</a> <a id="1132" href="Complex-Model.example.votingexample.html#1132" class="Bound">_</a> <a id="1134" class="Symbol">→</a> <a id="1136" class="Number">1</a><a id="1137" class="Symbol">)</a>
                                 <a id="1172" class="Symbol">λ</a> <a id="1174" href="Complex-Model.example.votingexample.html#1174" class="Bound">result</a> <a id="1181" class="Symbol">→</a>  <a id="1184" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1191" class="Number">1</a> <a id="1193" class="Symbol">(</a><a id="1194" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1198" class="Symbol">(</a><a id="1199" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1203" href="Complex-Model.example.votingexample.html#1056" class="Bound">n</a> <a id="1205" class="Symbol">))</a> 
<a id="1209" href="Complex-Model.example.votingexample.html#989" class="CatchallClause Function">updateCounterAux2</a><a id="1226" class="CatchallClause"> </a><a id="1227" href="Complex-Model.example.votingexample.html#1227" class="CatchallClause Bound">s</a><a id="1228" class="CatchallClause"> </a><a id="1229" href="Complex-Model.example.votingexample.html#1229" class="CatchallClause Bound">otherwise</a><a id="1238" class="CatchallClause"> </a><a id="1239" href="Complex-Model.example.votingexample.html#1239" class="CatchallClause Bound">msg₂</a> <a id="1244" class="Symbol">=</a> <a id="1246" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1253" class="Number">1</a> <a id="1255" class="Symbol">(</a><a id="1256" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1260" class="Number">17</a><a id="1262" class="Symbol">)</a>


<a id="1266" class="Comment">--increment function</a>
<a id="incrementAux"></a><a id="1287" href="Complex-Model.example.votingexample.html#1287" class="Function">incrementAux</a> <a id="1300" class="Symbol">:</a> <a id="1302" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="1313" class="Symbol">→</a> <a id="1315" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="1320" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="1324" href="Complex-Model.example.votingexample.html#1287" class="Function">incrementAux</a> <a id="1337" class="Symbol">(</a><a id="1338" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1345" class="Symbol">(</a><a id="1346" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1350" href="Complex-Model.example.votingexample.html#1350" class="Bound">n</a><a id="1351" class="Symbol">))</a> <a id="1354" class="Symbol">=</a> <a id="1356" class="Symbol">(</a><a id="1357" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="1362" class="Symbol">(</a><a id="1363" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="1371" class="String">&quot;counter&quot;</a> <a id="1381" class="Symbol">(λ</a> <a id="1384" href="Complex-Model.example.votingexample.html#1384" class="Bound">_</a> <a id="1386" class="Symbol">→</a> <a id="1388" class="Symbol">λ</a> <a id="1390" href="Complex-Model.example.votingexample.html#1390" class="Bound">msg</a> <a id="1394" class="Symbol">→</a> <a id="1396" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1403" class="Symbol">(</a><a id="1404" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1408" class="Symbol">(</a><a id="1409" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1413" href="Complex-Model.example.votingexample.html#1350" class="Bound">n</a><a id="1414" class="Symbol">)))</a> <a id="1418" class="Symbol">λ</a> <a id="1420" href="Complex-Model.example.votingexample.html#1420" class="Bound">f</a> <a id="1422" class="Symbol">→</a> <a id="1424" class="Number">1</a><a id="1425" class="Symbol">)</a>
                                                         <a id="1484" class="Symbol">(λ</a> <a id="1487" href="Complex-Model.example.votingexample.html#1487" class="Bound">n</a> <a id="1489" class="Symbol">→</a> <a id="1491" class="Number">1</a><a id="1492" class="Symbol">))</a> <a id="1495" class="Symbol">λ</a> <a id="1497" href="Complex-Model.example.votingexample.html#1497" class="Bound">x</a> <a id="1499" class="Symbol">→</a> <a id="1501" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1508" class="Number">1</a> <a id="1510" class="Symbol">(</a><a id="1511" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1515" class="Symbol">(</a><a id="1516" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1520" href="Complex-Model.example.votingexample.html#1350" class="Bound">n</a><a id="1521" class="Symbol">))</a>
<a id="1524" href="Complex-Model.example.votingexample.html#1287" class="CatchallClause Function">incrementAux</a><a id="1536" class="CatchallClause"> </a><a id="1537" href="Complex-Model.example.votingexample.html#1537" class="CatchallClause Bound">ow</a> <a id="1540" class="Symbol">=</a> <a id="1542" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="1548" class="Symbol">(</a><a id="1549" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1556" class="String">&quot;counter returns not a number&quot;</a><a id="1586" class="Symbol">)</a> <a id="1588" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="1590" class="Number">0</a> <a id="1592" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1595" class="Number">0</a> <a id="1597" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="1599" class="String">&quot;increment&quot;</a> <a id="1611" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="1613" class="Symbol">(</a><a id="1614" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1618" class="Number">0</a><a id="1619" class="Symbol">)</a> <a id="1621" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>



<a id="1627" class="Comment">--add voter function</a>
<a id="addVoterAux"></a><a id="1648" href="Complex-Model.example.votingexample.html#1648" class="Function">addVoterAux</a> <a id="1660" class="Symbol">:</a> <a id="1662" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1666" class="Symbol">→</a> <a id="1668" class="Symbol">(</a><a id="1669" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1673" class="Symbol">→</a> <a id="1675" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1685" class="Symbol">)</a> <a id="1687" class="Symbol">→</a> <a id="1689" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1693" class="Symbol">→</a> <a id="1695" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="1706" href="Complex-Model.example.votingexample.html#1648" class="Function">addVoterAux</a> <a id="1718" class="Symbol">(</a><a id="1719" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1723" href="Complex-Model.example.votingexample.html#1723" class="Bound">newaddr</a><a id="1730" class="Symbol">)</a> <a id="1732" href="Complex-Model.example.votingexample.html#1732" class="Bound">oldCheckVoter</a> <a id="1746" class="Symbol">(</a><a id="1747" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1751" href="Complex-Model.example.votingexample.html#1751" class="Bound">addr</a><a id="1755" class="Symbol">)</a> <a id="1757" class="Symbol">=</a> <a id="1759" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1762" href="Complex-Model.example.votingexample.html#1723" class="Bound">newaddr</a> <a id="1770" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1773" href="Complex-Model.example.votingexample.html#1751" class="Bound">addr</a> <a id="1778" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1783" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1790" class="Symbol">(</a><a id="1791" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1795" class="Number">1</a><a id="1796" class="Symbol">)</a> <a id="1798" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1803" href="Complex-Model.example.votingexample.html#1732" class="Bound">oldCheckVoter</a> <a id="1817" class="Symbol">(</a><a id="1818" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1822" href="Complex-Model.example.votingexample.html#1751" class="Bound">addr</a><a id="1826" class="Symbol">)</a>
<a id="1828" href="Complex-Model.example.votingexample.html#1648" class="CatchallClause Function">addVoterAux</a><a id="1839" class="CatchallClause"> </a><a id="1840" href="Complex-Model.example.votingexample.html#1840" class="CatchallClause Bound">ow</a><a id="1842" class="CatchallClause"> </a><a id="1843" href="Complex-Model.example.votingexample.html#1843" class="CatchallClause Bound">ow&#39;</a><a id="1846" class="CatchallClause"> </a><a id="1847" href="Complex-Model.example.votingexample.html#1847" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1852" class="Symbol">=</a> <a id="1854" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="1858" class="Symbol">(</a><a id="1859" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1866" class="String">&quot; You cannot add voter &quot;</a><a id="1890" class="Symbol">)</a>



<a id="1895" class="Comment">--delete voter function</a>
<a id="deleteVoterAux"></a><a id="1919" href="Complex-Model.example.votingexample.html#1919" class="Function">deleteVoterAux</a> <a id="1934" class="Symbol">:</a> <a id="1936" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1940" class="Symbol">→</a> <a id="1942" class="Symbol">(</a><a id="1943" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1947" class="Symbol">→</a> <a id="1949" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1959" class="Symbol">)</a> <a id="1961" class="Symbol">→</a> <a id="1963" class="Symbol">(</a><a id="1964" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1968" class="Symbol">→</a> <a id="1970" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1980" class="Symbol">)</a>
<a id="1982" href="Complex-Model.example.votingexample.html#1919" class="Function">deleteVoterAux</a> <a id="1997" class="Symbol">(</a><a id="1998" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2002" href="Complex-Model.example.votingexample.html#2002" class="Bound">newaddr</a><a id="2009" class="Symbol">)</a> <a id="2011" href="Complex-Model.example.votingexample.html#2011" class="Bound">oldCheckVoter</a> <a id="2025" class="Symbol">(</a><a id="2026" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2030" href="Complex-Model.example.votingexample.html#2030" class="Bound">addr</a><a id="2034" class="Symbol">)</a> <a id="2036" class="Symbol">=</a> <a id="2038" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2041" href="Complex-Model.example.votingexample.html#2002" class="Bound">newaddr</a> <a id="2049" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="2052" href="Complex-Model.example.votingexample.html#2030" class="Bound">addr</a> <a id="2057" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2062" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2069" class="Symbol">(</a><a id="2070" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2074" class="Number">0</a><a id="2075" class="Symbol">)</a> <a id="2077" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2082" href="Complex-Model.example.votingexample.html#2011" class="Bound">oldCheckVoter</a> <a id="2096" class="Symbol">(</a><a id="2097" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2101" href="Complex-Model.example.votingexample.html#2030" class="Bound">addr</a><a id="2105" class="Symbol">)</a>
<a id="2107" href="Complex-Model.example.votingexample.html#1919" class="CatchallClause Function">deleteVoterAux</a><a id="2121" class="CatchallClause"> </a><a id="2122" href="Complex-Model.example.votingexample.html#2122" class="CatchallClause Bound">ow</a><a id="2124" class="CatchallClause"> </a><a id="2125" href="Complex-Model.example.votingexample.html#2125" class="CatchallClause Bound">ow&#39;</a><a id="2128" class="CatchallClause"> </a><a id="2129" href="Complex-Model.example.votingexample.html#2129" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="2134" class="Symbol">=</a> <a id="2136" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2140" class="Symbol">(</a><a id="2141" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2148" class="String">&quot; You cannot delete voter &quot;</a><a id="2175" class="Symbol">)</a>



<a id="2180" class="Comment">-- the function below we use it in case to check voter is allowed to vote or not</a>
<a id="2261" class="Comment">-- in case nat 0 or otherwise it will return error and not allow to vote</a>
<a id="2334" class="Comment">-- in case suc (nat n) it will allow to vote and it will call incrementAux to increment the counter</a>
<a id="voteAux"></a><a id="2434" href="Complex-Model.example.votingexample.html#2434" class="Function">voteAux</a> <a id="2442" class="Symbol">:</a> <a id="2444" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="2455" class="Symbol">→</a> <a id="2457" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="2462" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="2466" href="Complex-Model.example.votingexample.html#2434" class="Function">voteAux</a> <a id="2474" class="Symbol">(</a><a id="2475" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2482" class="Symbol">(</a><a id="2483" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2487" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="2491" class="Symbol">))</a> <a id="2494" class="Symbol">=</a> <a id="2496" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="2502" class="Symbol">(</a><a id="2503" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2510" class="String">&quot;The message is zero&quot;</a><a id="2531" class="Symbol">)</a> <a id="2533" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2535" class="Number">0</a> <a id="2537" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2540" class="Number">0</a> <a id="2542" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2544" class="String">&quot; Voter is not allowed to vote &quot;</a> <a id="2577" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2579" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2583" class="Number">0</a> <a id="2585" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2588" href="Complex-Model.example.votingexample.html#2434" class="Function">voteAux</a> <a id="2596" class="Symbol">(</a><a id="2597" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2604" class="Symbol">(</a><a id="2605" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2609" class="Symbol">(</a><a id="2610" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2614" href="Complex-Model.example.votingexample.html#2614" class="Bound">n</a><a id="2615" class="Symbol">)))</a> <a id="2619" class="Symbol">=</a> <a id="2621" class="Symbol">(</a><a id="2622" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="2627" class="Symbol">(</a><a id="2628" href="Complex-Model.ccomand.ccommands-cresponse.html#730" class="InductiveConstructor">callPure</a> <a id="2637" class="Number">5</a> <a id="2639" class="String">&quot;counter&quot;</a> <a id="2649" class="Symbol">(</a><a id="2650" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2654" class="Number">0</a><a id="2655" class="Symbol">))</a> <a id="2658" class="Symbol">(λ</a> <a id="2661" href="Complex-Model.example.votingexample.html#2661" class="Bound">result</a> <a id="2668" class="Symbol">→</a> <a id="2670" class="Number">1</a><a id="2671" class="Symbol">))</a>
                                  <a id="2708" class="Symbol">λ</a> <a id="2710" href="Complex-Model.example.votingexample.html#2710" class="Bound">msg</a> <a id="2714" class="Symbol">→</a> <a id="2716" href="Complex-Model.example.votingexample.html#1287" class="Function">incrementAux</a> <a id="2729" href="Complex-Model.example.votingexample.html#2710" class="Bound">msg</a>
<a id="2733" href="Complex-Model.example.votingexample.html#2434" class="CatchallClause Function">voteAux</a><a id="2740" class="CatchallClause"> </a><a id="2741" class="CatchallClause Symbol">(</a><a id="2742" href="basicDataStructure.html#1452" class="CatchallClause InductiveConstructor">theMsg</a><a id="2748" class="CatchallClause"> </a><a id="2749" href="Complex-Model.example.votingexample.html#2749" class="CatchallClause Bound">ow</a><a id="2751" class="CatchallClause Symbol">)</a> <a id="2753" class="Symbol">=</a> <a id="2755" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="2761" class="Symbol">(</a><a id="2762" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2769" class="String">&quot; The message is not a number &quot;</a><a id="2800" class="Symbol">)</a> <a id="2802" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2804" class="Number">0</a> <a id="2806" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2809" class="Number">0</a> <a id="2811" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2813" class="String">&quot; Voter is not allowed to vote &quot;</a> <a id="2846" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2848" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2852" class="Number">0</a> <a id="2854" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2857" href="Complex-Model.example.votingexample.html#2434" class="Function">voteAux</a> <a id="2865" class="Symbol">(</a><a id="2866" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2870" href="Complex-Model.example.votingexample.html#2870" class="Bound">x</a><a id="2871" class="Symbol">)</a> <a id="2873" class="Symbol">=</a> <a id="2875" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="2881" class="Symbol">(</a><a id="2882" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2889" class="String">&quot; Undefined &quot;</a><a id="2902" class="Symbol">)</a> <a id="2904" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2906" class="Number">0</a> <a id="2908" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2911" class="Number">0</a> <a id="2913" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2915" class="String">&quot; The message is undefined &quot;</a> <a id="2944" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2946" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2950" class="Number">0</a> <a id="2952" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>






<a id="testLedger"></a><a id="2961" href="Complex-Model.example.votingexample.html#2961" class="Function">testLedger</a> <a id="2972" class="Symbol">:</a> <a id="2974" href="libraries.Mainlibrary.html#1044" class="Function">Ledger</a>
<a id="2981" href="Complex-Model.example.votingexample.html#2961" class="Function">testLedger</a> <a id="2992" class="Number">1</a> <a id="2994" class="Symbol">.</a><a id="2995" href="libraries.Mainlibrary.html#808" class="Field">amount</a> <a id="3002" class="Symbol">=</a> <a id="3004" class="Number">100</a>                                                                                        

<a id="3097" class="Comment">-- in case to add voter</a>
<a id="3121" href="Complex-Model.example.votingexample.html#2961" class="Function">testLedger</a> <a id="3132" class="Number">1</a> <a id="3134" class="Symbol">.</a><a id="3135" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3139" class="String">&quot;addVoter&quot;</a> <a id="3150" href="Complex-Model.example.votingexample.html#3150" class="Bound">msg</a>  <a id="3155" class="Symbol">=</a> <a id="3157" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="3162" class="Symbol">(</a><a id="3163" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="3171" class="String">&quot;checkVoter&quot;</a>
                                    <a id="3220" class="Symbol">(</a><a id="3221" href="Complex-Model.example.votingexample.html#1648" class="Function">addVoterAux</a> <a id="3233" href="Complex-Model.example.votingexample.html#3150" class="Bound">msg</a><a id="3236" class="Symbol">)</a> <a id="3238" class="Symbol">λ</a> <a id="3240" href="Complex-Model.example.votingexample.html#3240" class="Bound">_</a> <a id="3242" class="Symbol">→</a> <a id="3244" class="Number">1</a><a id="3245" class="Symbol">)(λ</a> <a id="3249" href="Complex-Model.example.votingexample.html#3249" class="Bound">_</a> <a id="3251" class="Symbol">→</a> <a id="3253" class="Number">1</a><a id="3254" class="Symbol">)</a>
                                    <a id="3292" class="Symbol">λ</a> <a id="3294" href="Complex-Model.example.votingexample.html#3294" class="Bound">_</a> <a id="3296" class="Symbol">→</a> <a id="3298" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="3305" class="Number">1</a> <a id="3307" href="Complex-Model.example.votingexample.html#3150" class="Bound">msg</a>                                           
<a id="3354" class="Comment">-- in case to delete voter</a>
<a id="3381" href="Complex-Model.example.votingexample.html#2961" class="Function">testLedger</a> <a id="3392" class="Number">1</a> <a id="3394" class="Symbol">.</a><a id="3395" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3399" class="String">&quot;deleteVoter&quot;</a> <a id="3413" href="Complex-Model.example.votingexample.html#3413" class="Bound">msg</a> <a id="3417" class="Symbol">=</a> <a id="3419" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="3433" class="String">&quot;checkVoter&quot;</a> <a id="3446" class="Symbol">(</a><a id="3447" href="Complex-Model.example.votingexample.html#1919" class="Function">deleteVoterAux</a> <a id="3462" href="Complex-Model.example.votingexample.html#3413" class="Bound">msg</a><a id="3465" class="Symbol">)</a> <a id="3467" class="Symbol">λ</a> <a id="3469" href="Complex-Model.example.votingexample.html#3469" class="Bound">_</a> <a id="3471" class="Symbol">→</a> <a id="3473" class="Number">1</a><a id="3474" class="Symbol">)</a>
                                      <a id="3514" class="Symbol">(λ</a> <a id="3517" href="Complex-Model.example.votingexample.html#3517" class="Bound">_</a> <a id="3519" class="Symbol">→</a> <a id="3521" class="Number">1</a><a id="3522" class="Symbol">)</a> <a id="3524" class="Symbol">λ</a> <a id="3526" href="Complex-Model.example.votingexample.html#3526" class="Bound">_</a> <a id="3528" class="Symbol">→</a> <a id="3530" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="3537" class="Number">1</a> <a id="3539" href="Complex-Model.example.votingexample.html#3413" class="Bound">msg</a>
<a id="3543" class="Comment">-- in case to vote</a>
<a id="3562" href="Complex-Model.example.votingexample.html#2961" class="Function">testLedger</a> <a id="3573" class="Number">1</a> <a id="3575" class="Symbol">.</a><a id="3576" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3580" class="String">&quot;vote&quot;</a> <a id="3587" href="Complex-Model.example.votingexample.html#3587" class="Bound">msg</a> <a id="3591" class="Symbol">=</a> <a id="3593" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="3598" href="Complex-Model.ccomand.ccommands-cresponse.html#643" class="InductiveConstructor">callAddrLookupc</a>  <a id="3615" class="Symbol">(λ</a> <a id="3618" href="Complex-Model.example.votingexample.html#3618" class="Bound">_</a> <a id="3620" class="Symbol">→</a> <a id="3622" class="Number">1</a><a id="3623" class="Symbol">)</a>
                               <a id="3656" class="Symbol">λ</a> <a id="3658" href="Complex-Model.example.votingexample.html#3658" class="Bound">addr</a> <a id="3663" class="Symbol">→</a> <a id="3665" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="3670" class="Symbol">(</a><a id="3671" href="Complex-Model.ccomand.ccommands-cresponse.html#730" class="InductiveConstructor">callPure</a> <a id="3680" href="Complex-Model.example.votingexample.html#3658" class="Bound">addr</a> <a id="3685" class="String">&quot;checkVoter&quot;</a> <a id="3698" class="Symbol">(</a><a id="3699" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3703" href="Complex-Model.example.votingexample.html#3658" class="Bound">addr</a><a id="3707" class="Symbol">))</a>
                               <a id="3741" class="Symbol">(λ</a> <a id="3744" href="Complex-Model.example.votingexample.html#3744" class="Bound">_</a> <a id="3746" class="Symbol">→</a> <a id="3748" class="Number">1</a><a id="3749" class="Symbol">)</a> <a id="3751" class="Symbol">λ</a> <a id="3753" href="Complex-Model.example.votingexample.html#3753" class="Bound">check</a> <a id="3759" class="Symbol">→</a> <a id="3761" href="Complex-Model.example.votingexample.html#2434" class="Function">voteAux</a> <a id="3769" href="Complex-Model.example.votingexample.html#3753" class="Bound">check</a>
<a id="3775" class="Comment">-- in case to check voter</a>
<a id="3801" href="Complex-Model.example.votingexample.html#2961" class="Function">testLedger</a> <a id="3812" class="Number">1</a> <a id="3814" class="Symbol">.</a><a id="3815" href="libraries.Mainlibrary.html#865" class="Field">purefunction</a> <a id="3828" class="String">&quot;checkVoter&quot;</a> <a id="3841" href="Complex-Model.example.votingexample.html#3841" class="Bound">msg</a> <a id="3845" class="Symbol">=</a> <a id="3847" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3854" class="Symbol">(</a><a id="3855" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3859" class="Number">0</a><a id="3860" class="Symbol">)</a>

<a id="3863" class="Comment">-- in case to increment our counter</a>
<a id="3899" href="Complex-Model.example.votingexample.html#2961" class="Function">testLedger</a> <a id="3910" class="Number">1</a> <a id="3912" class="Symbol">.</a><a id="3913" href="libraries.Mainlibrary.html#865" class="Field">purefunction</a> <a id="3926" class="String">&quot;counter&quot;</a> <a id="3936" href="Complex-Model.example.votingexample.html#3936" class="Bound">msg</a> <a id="3940" class="Symbol">=</a> <a id="3942" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3949" class="Symbol">(</a><a id="3950" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3954" class="Number">0</a><a id="3955" class="Symbol">)</a>

<a id="3958" class="Comment">-- for other cases</a>
<a id="3977" href="Complex-Model.example.votingexample.html#2961" class="CatchallClause Function">testLedger</a><a id="3987" class="CatchallClause"> </a><a id="3988" href="Complex-Model.example.votingexample.html#3988" class="CatchallClause Bound">ow</a><a id="3990" class="CatchallClause"> </a><a id="3991" class="CatchallClause Symbol">.</a><a id="3992" href="libraries.Mainlibrary.html#808" class="CatchallClause Field">amount</a> <a id="3999" class="Symbol">=</a> <a id="4001" class="Number">0</a>
<a id="4003" href="Complex-Model.example.votingexample.html#2961" class="CatchallClause Function">testLedger</a><a id="4013" class="CatchallClause"> </a><a id="4014" href="Complex-Model.example.votingexample.html#4014" class="CatchallClause Bound">ow</a><a id="4016" class="CatchallClause"> </a><a id="4017" class="CatchallClause Symbol">.</a><a id="4018" href="libraries.Mainlibrary.html#830" class="CatchallClause Field">fun</a><a id="4021" class="CatchallClause"> </a><a id="4022" href="Complex-Model.example.votingexample.html#4022" class="CatchallClause Bound">ow&#39;</a><a id="4025" class="CatchallClause"> </a><a id="4026" href="Complex-Model.example.votingexample.html#4026" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4031" class="Symbol">=</a> <a id="4033" href="Complex-Model.ccomand.ccommands-cresponse.html#1533" class="InductiveConstructor">error</a> <a id="4039" class="Symbol">(</a><a id="4040" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4047" class="String">&quot;Undefined&quot;</a><a id="4058" class="Symbol">)</a> <a id="4060" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="4062" href="Complex-Model.example.votingexample.html#4014" class="Bound">ow</a> <a id="4065" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="4068" href="Complex-Model.example.votingexample.html#4014" class="Bound">ow</a> <a id="4071" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="4073" href="Complex-Model.example.votingexample.html#4022" class="Bound">ow&#39;</a> <a id="4077" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="4079" href="Complex-Model.example.votingexample.html#4026" class="Bound">ow&#39;&#39;</a> <a id="4084" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="4087" href="Complex-Model.example.votingexample.html#2961" class="CatchallClause Function">testLedger</a><a id="4097" class="CatchallClause"> </a><a id="4098" href="Complex-Model.example.votingexample.html#4098" class="CatchallClause Bound">ow</a><a id="4100" class="CatchallClause"> </a><a id="4101" class="CatchallClause Symbol">.</a><a id="4102" href="libraries.Mainlibrary.html#865" class="CatchallClause Field">purefunction</a><a id="4114" class="CatchallClause"> </a><a id="4115" href="Complex-Model.example.votingexample.html#4115" class="CatchallClause Bound">ow&#39;</a><a id="4118" class="CatchallClause"> </a><a id="4119" href="Complex-Model.example.votingexample.html#4119" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="4124" class="Symbol">=</a> <a id="4126" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="4130" class="Symbol">(</a><a id="4131" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="4138" class="String">&quot;Undefined&quot;</a><a id="4149" class="Symbol">)</a>


</pre></body></html>