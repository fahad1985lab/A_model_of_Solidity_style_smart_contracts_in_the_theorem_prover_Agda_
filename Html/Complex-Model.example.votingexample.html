<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.votingexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.votingexample.html" class="Module">Complex-Model.example.votingexample</a>  <a id="77" class="Keyword">where</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.List.html" class="Module">Data.List</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> 
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Product.html" class="Module">Data.Product</a> <a id="188" class="Keyword">renaming</a> <a id="197" class="Symbol">(</a><a id="198" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="202" class="Symbol">to</a> <a id="205" class="InductiveConstructor Operator">_,,_</a> <a id="210" class="Symbol">)</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="235" class="Keyword">hiding</a> <a id="242" class="Symbol">(</a><a id="243" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="248" class="Symbol">)</a>
<a id="250" class="Keyword">open</a> <a id="255" class="Keyword">import</a> <a id="262" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> 
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.Fin.Base.html#5404" class="Function Operator">_+_</a><a id="340" class="Symbol">;</a> <a id="342" href="Data.Fin.Base.html#5540" class="Function Operator">_-_</a><a id="345" class="Symbol">)</a>
<a id="347" class="Keyword">import</a> <a id="354" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="392" class="Symbol">as</a> <a id="395" class="Module">Eq</a>
<a id="398" class="Keyword">open</a> <a id="403" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="406" class="Keyword">using</a> <a id="412" class="Symbol">(</a><a id="413" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="417" class="Symbol">;</a> <a id="419" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="424" class="Symbol">;</a> <a id="426" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="430" class="Symbol">;</a> <a id="432" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">open</a> <a id="443" class="Keyword">import</a> <a id="450" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="467" class="Keyword">using</a> <a id="473" class="Symbol">(</a><a id="474" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="477" class="Symbol">;</a> <a id="479" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Data.String.html" class="Module">Data.String</a> <a id="508" class="Keyword">hiding</a> <a id="515" class="Symbol">(</a><a id="516" href="Data.String.Base.html#2430" class="Function">length</a><a id="522" class="Symbol">;</a> <a id="524" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="528" class="Symbol">)</a> <a id="530" class="Keyword">renaming</a> <a id="539" class="Symbol">(</a><a id="540" href="Data.String.Base.html#2366" class="Function Operator">_++_</a> <a id="545" class="Symbol">to</a> <a id="548" class="Function Operator">_++str_</a><a id="555" class="Symbol">)</a>

<a id="558" class="Comment">--our work</a>
<a id="569" class="Keyword">open</a> <a id="574" class="Keyword">import</a>  <a id="582" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="664" href="constantparameters.html#969" class="Function">exampleParameters</a>
<a id="682" class="Keyword">open</a> <a id="687" class="Keyword">import</a> <a id="694" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="736" class="Keyword">open</a> <a id="741" class="Keyword">import</a> <a id="748" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a>
<a id="799" class="Keyword">open</a> <a id="804" class="Keyword">import</a> <a id="811" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>



<a id="836" class="Comment">--initial function</a>
<a id="initialfun"></a><a id="855" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="866" class="Symbol">:</a> <a id="868" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="872" class="Symbol">→</a> <a id="874" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="885" href="Complex-Model.example.votingexample.html#855" class="Function">initialfun</a> <a id="896" class="Symbol">(</a><a id="897" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="901" href="Complex-Model.example.votingexample.html#901" class="Bound">n</a><a id="902" class="Symbol">)</a> <a id="904" class="Symbol">=</a> <a id="906" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="913" class="Symbol">(</a><a id="914" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="918" class="Number">0</a><a id="919" class="Symbol">)</a>
<a id="921" href="Complex-Model.example.votingexample.html#855" class="CatchallClause Function">initialfun</a><a id="931" class="CatchallClause"> </a><a id="932" href="Complex-Model.example.votingexample.html#932" class="CatchallClause Bound">owmsg</a>   <a id="940" class="Symbol">=</a> <a id="942" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="946" class="Symbol">(</a><a id="947" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="954" class="String">&quot; The message is not a number &quot;</a><a id="985" class="Symbol">)</a>


<a id="989" class="Comment">--increment function</a>
<a id="incrementAux"></a><a id="1010" href="Complex-Model.example.votingexample.html#1010" class="Function">incrementAux</a> <a id="1023" class="Symbol">:</a> <a id="1025" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="1036" class="Symbol">→</a> <a id="1038" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="1056" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="1060" href="Complex-Model.example.votingexample.html#1010" class="Function">incrementAux</a> <a id="1073" class="Symbol">(</a><a id="1074" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1081" class="Symbol">(</a><a id="1082" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1086" href="Complex-Model.example.votingexample.html#1086" class="Bound">n</a><a id="1087" class="Symbol">))</a> <a id="1090" class="Symbol">=</a> <a id="1092" class="Symbol">(</a><a id="1093" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="1098" class="Symbol">(</a><a id="1099" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="1107" class="String">&quot;counter&quot;</a> <a id="1117" class="Symbol">(λ</a> <a id="1120" href="Complex-Model.example.votingexample.html#1120" class="Bound">_</a> <a id="1122" class="Symbol">→</a> <a id="1124" class="Symbol">λ</a> <a id="1126" href="Complex-Model.example.votingexample.html#1126" class="Bound">msg</a> <a id="1130" class="Symbol">→</a> <a id="1132" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1139" class="Symbol">(</a><a id="1140" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1149" href="Complex-Model.example.votingexample.html#1086" class="Bound">n</a><a id="1150" class="Symbol">)))</a> <a id="1154" class="Symbol">λ</a> <a id="1156" href="Complex-Model.example.votingexample.html#1156" class="Bound">f</a> <a id="1158" class="Symbol">→</a> <a id="1160" class="Number">1</a><a id="1161" class="Symbol">)</a>
                                                         <a id="1220" class="Symbol">(λ</a> <a id="1223" href="Complex-Model.example.votingexample.html#1223" class="Bound">n</a> <a id="1225" class="Symbol">→</a> <a id="1227" class="Number">1</a><a id="1228" class="Symbol">))</a> <a id="1231" class="Symbol">λ</a> <a id="1233" href="Complex-Model.example.votingexample.html#1233" class="Bound">x</a> <a id="1235" class="Symbol">→</a> <a id="1237" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="1244" class="Number">1</a> <a id="1246" class="Symbol">(</a><a id="1247" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1251" class="Symbol">(</a><a id="1252" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1256" href="Complex-Model.example.votingexample.html#1086" class="Bound">n</a><a id="1257" class="Symbol">))</a>
<a id="1260" href="Complex-Model.example.votingexample.html#1010" class="CatchallClause Function">incrementAux</a><a id="1272" class="CatchallClause"> </a><a id="1273" href="Complex-Model.example.votingexample.html#1273" class="CatchallClause Bound">ow</a> <a id="1276" class="Symbol">=</a> <a id="1278" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="1284" class="Symbol">(</a><a id="1285" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1292" class="String">&quot;counter returns not a number&quot;</a><a id="1322" class="Symbol">)</a> <a id="1324" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="1326" class="Number">0</a> <a id="1328" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1331" class="Number">0</a> <a id="1333" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="1335" class="String">&quot;increment&quot;</a> <a id="1347" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="1349" class="Symbol">(</a><a id="1350" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1354" class="Number">0</a><a id="1355" class="Symbol">)</a> <a id="1357" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>



<a id="1363" class="Comment">--add voter function</a>
<a id="addVoterAux"></a><a id="1384" href="Complex-Model.example.votingexample.html#1384" class="Function">addVoterAux</a> <a id="1396" class="Symbol">:</a> <a id="1398" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1402" class="Symbol">→</a> <a id="1404" class="Symbol">(</a><a id="1405" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1421" class="Symbol">)</a> <a id="1423" class="Symbol">→</a> <a id="1425" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1429" class="Symbol">→</a> <a id="1431" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>
<a id="1442" href="Complex-Model.example.votingexample.html#1384" class="Function">addVoterAux</a> <a id="1454" class="Symbol">(</a><a id="1455" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1459" href="Complex-Model.example.votingexample.html#1459" class="Bound">newaddr</a><a id="1466" class="Symbol">)</a> <a id="1468" href="Complex-Model.example.votingexample.html#1468" class="Bound">oldCheckVoter</a> <a id="1482" class="Symbol">(</a><a id="1483" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1487" href="Complex-Model.example.votingexample.html#1487" class="Bound">addr</a><a id="1491" class="Symbol">)</a> <a id="1493" class="Symbol">=</a> <a id="1495" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1498" href="Complex-Model.example.votingexample.html#1459" class="Bound">newaddr</a> <a id="1506" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1509" href="Complex-Model.example.votingexample.html#1487" class="Bound">addr</a> <a id="1514" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1519" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1526" class="Symbol">(</a><a id="1527" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1531" class="Number">1</a><a id="1532" class="Symbol">)</a> <a id="1534" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1539" href="Complex-Model.example.votingexample.html#1468" class="Bound">oldCheckVoter</a> <a id="1553" class="Symbol">(</a><a id="1554" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1558" href="Complex-Model.example.votingexample.html#1487" class="Bound">addr</a><a id="1562" class="Symbol">)</a>
<a id="1564" href="Complex-Model.example.votingexample.html#1384" class="CatchallClause Function">addVoterAux</a><a id="1575" class="CatchallClause"> </a><a id="1576" href="Complex-Model.example.votingexample.html#1576" class="CatchallClause Bound">ow</a><a id="1578" class="CatchallClause"> </a><a id="1579" href="Complex-Model.example.votingexample.html#1579" class="CatchallClause Bound">ow&#39;</a><a id="1582" class="CatchallClause"> </a><a id="1583" href="Complex-Model.example.votingexample.html#1583" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1588" class="Symbol">=</a> <a id="1590" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="1594" class="Symbol">(</a><a id="1595" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1602" class="String">&quot; You cannot add voter &quot;</a><a id="1626" class="Symbol">)</a>



<a id="1631" class="Comment">--delete voter function</a>
<a id="deleteVoterAux"></a><a id="1655" href="Complex-Model.example.votingexample.html#1655" class="Function">deleteVoterAux</a> <a id="1670" class="Symbol">:</a> <a id="1672" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1676" class="Symbol">→</a> <a id="1678" class="Symbol">(</a><a id="1679" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1695" class="Symbol">)</a> <a id="1697" class="Symbol">→</a> <a id="1699" class="Symbol">(</a><a id="1700" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1704" class="Symbol">→</a> <a id="1706" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="1716" class="Symbol">)</a>
<a id="1718" href="Complex-Model.example.votingexample.html#1655" class="Function">deleteVoterAux</a> <a id="1733" class="Symbol">(</a><a id="1734" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1738" href="Complex-Model.example.votingexample.html#1738" class="Bound">newaddr</a><a id="1745" class="Symbol">)</a> <a id="1747" href="Complex-Model.example.votingexample.html#1747" class="Bound">oldCheckVoter</a> <a id="1761" class="Symbol">(</a><a id="1762" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1766" href="Complex-Model.example.votingexample.html#1766" class="Bound">addr</a><a id="1770" class="Symbol">)</a> <a id="1772" class="Symbol">=</a> <a id="1774" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1777" href="Complex-Model.example.votingexample.html#1738" class="Bound">newaddr</a> <a id="1785" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1788" href="Complex-Model.example.votingexample.html#1766" class="Bound">addr</a> <a id="1793" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1798" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="1805" class="Symbol">(</a><a id="1806" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1810" class="Number">0</a><a id="1811" class="Symbol">)</a> <a id="1813" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1818" href="Complex-Model.example.votingexample.html#1747" class="Bound">oldCheckVoter</a> <a id="1832" class="Symbol">(</a><a id="1833" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="1837" href="Complex-Model.example.votingexample.html#1766" class="Bound">addr</a><a id="1841" class="Symbol">)</a>
<a id="1843" href="Complex-Model.example.votingexample.html#1655" class="CatchallClause Function">deleteVoterAux</a><a id="1857" class="CatchallClause"> </a><a id="1858" href="Complex-Model.example.votingexample.html#1858" class="CatchallClause Bound">ow</a><a id="1860" class="CatchallClause"> </a><a id="1861" href="Complex-Model.example.votingexample.html#1861" class="CatchallClause Bound">ow&#39;</a><a id="1864" class="CatchallClause"> </a><a id="1865" href="Complex-Model.example.votingexample.html#1865" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1870" class="Symbol">=</a> <a id="1872" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="1876" class="Symbol">(</a><a id="1877" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="1884" class="String">&quot; You cannot delete voter &quot;</a><a id="1911" class="Symbol">)</a>



<a id="1916" class="Comment">-- the function below we use it in case to check voter is allowed to vote or not</a>
<a id="1997" class="Comment">-- in case nat 0 or otherwise it will return error and not allow to vote</a>
<a id="2070" class="Comment">-- in case suc (nat n) it will allow to vote and it will call incrementAux to increment the counter</a>
<a id="voteAux"></a><a id="2170" href="Complex-Model.example.votingexample.html#2170" class="Function">voteAux</a> <a id="2178" class="Symbol">:</a> <a id="2180" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a> <a id="2191" class="Symbol">→</a> <a id="2193" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="2211" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="2215" href="Complex-Model.example.votingexample.html#2170" class="Function">voteAux</a> <a id="2223" class="Symbol">(</a><a id="2224" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2231" class="Symbol">(</a><a id="2232" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2236" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="2240" class="Symbol">))</a> <a id="2243" class="Symbol">=</a> <a id="2245" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="2251" class="Symbol">(</a><a id="2252" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2259" class="String">&quot;The message is zero&quot;</a><a id="2280" class="Symbol">)</a> <a id="2282" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2284" class="Number">0</a> <a id="2286" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2289" class="Number">0</a> <a id="2291" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2293" class="String">&quot; Voter is not allowed to vote &quot;</a> <a id="2326" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2328" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2332" class="Number">0</a> <a id="2334" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2337" href="Complex-Model.example.votingexample.html#2170" class="Function">voteAux</a> <a id="2345" class="Symbol">(</a><a id="2346" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="2353" class="Symbol">(</a><a id="2354" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2358" class="Symbol">(</a><a id="2359" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2363" href="Complex-Model.example.votingexample.html#2363" class="Bound">n</a><a id="2364" class="Symbol">)))</a> <a id="2368" class="Symbol">=</a> <a id="2370" class="Symbol">(</a><a id="2371" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="2376" class="Symbol">(</a><a id="2377" href="Complex-Model.ccomand.ccommands-cresponse.html#731" class="InductiveConstructor">callPure</a> <a id="2386" class="Number">5</a> <a id="2388" class="String">&quot;counter&quot;</a> <a id="2398" class="Symbol">(</a><a id="2399" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2403" class="Number">0</a><a id="2404" class="Symbol">))</a> <a id="2407" class="Symbol">(λ</a> <a id="2410" href="Complex-Model.example.votingexample.html#2410" class="Bound">result</a> <a id="2417" class="Symbol">→</a> <a id="2419" class="Number">1</a><a id="2420" class="Symbol">))</a>
                                  <a id="2457" class="Symbol">λ</a> <a id="2459" href="Complex-Model.example.votingexample.html#2459" class="Bound">msg</a> <a id="2463" class="Symbol">→</a> <a id="2465" href="Complex-Model.example.votingexample.html#1010" class="Function">incrementAux</a> <a id="2478" href="Complex-Model.example.votingexample.html#2459" class="Bound">msg</a>
<a id="2482" href="Complex-Model.example.votingexample.html#2170" class="CatchallClause Function">voteAux</a><a id="2489" class="CatchallClause"> </a><a id="2490" class="CatchallClause Symbol">(</a><a id="2491" href="basicDataStructure.html#1452" class="CatchallClause InductiveConstructor">theMsg</a><a id="2497" class="CatchallClause"> </a><a id="2498" href="Complex-Model.example.votingexample.html#2498" class="CatchallClause Bound">ow</a><a id="2500" class="CatchallClause Symbol">)</a> <a id="2502" class="Symbol">=</a> <a id="2504" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="2510" class="Symbol">(</a><a id="2511" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2518" class="String">&quot; The message is not a number &quot;</a><a id="2549" class="Symbol">)</a> <a id="2551" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2553" class="Number">0</a> <a id="2555" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2558" class="Number">0</a> <a id="2560" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2562" class="String">&quot; Voter is not allowed to vote &quot;</a> <a id="2595" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2597" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2601" class="Number">0</a> <a id="2603" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="2606" href="Complex-Model.example.votingexample.html#2170" class="Function">voteAux</a> <a id="2614" class="Symbol">(</a><a id="2615" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="2619" href="Complex-Model.example.votingexample.html#2619" class="Bound">x</a><a id="2620" class="Symbol">)</a> <a id="2622" class="Symbol">=</a> <a id="2624" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="2630" class="Symbol">(</a><a id="2631" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="2638" class="String">&quot; Undefined &quot;</a><a id="2651" class="Symbol">)</a> <a id="2653" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2655" class="Number">0</a> <a id="2657" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2660" class="Number">0</a> <a id="2662" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="2664" class="String">&quot; The message is undefined &quot;</a> <a id="2693" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="2695" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="2699" class="Number">0</a> <a id="2701" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>






<a id="testLedger"></a><a id="2710" href="Complex-Model.example.votingexample.html#2710" class="Function">testLedger</a> <a id="2721" class="Symbol">:</a> <a id="2723" href="libraries.Mainlibrary.html#1065" class="Function">Ledger</a>
<a id="2730" href="Complex-Model.example.votingexample.html#2710" class="Function">testLedger</a> <a id="2741" class="Number">1</a> <a id="2743" class="Symbol">.</a><a id="2744" href="libraries.Mainlibrary.html#808" class="Field">amount</a> <a id="2751" class="Symbol">=</a> <a id="2753" class="Number">100</a>                                                                                        

<a id="2846" class="Comment">-- in case to add voter</a>
<a id="2870" href="Complex-Model.example.votingexample.html#2710" class="Function">testLedger</a> <a id="2881" class="Number">1</a> <a id="2883" class="Symbol">.</a><a id="2884" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="2888" class="String">&quot;addVoter&quot;</a> <a id="2899" href="Complex-Model.example.votingexample.html#2899" class="Bound">msg</a>  <a id="2904" class="Symbol">=</a> <a id="2906" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="2911" class="Symbol">(</a><a id="2912" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="2920" class="String">&quot;checkVoter&quot;</a>
                                    <a id="2969" class="Symbol">(</a><a id="2970" href="Complex-Model.example.votingexample.html#1384" class="Function">addVoterAux</a> <a id="2982" href="Complex-Model.example.votingexample.html#2899" class="Bound">msg</a><a id="2985" class="Symbol">)</a> <a id="2987" class="Symbol">λ</a> <a id="2989" href="Complex-Model.example.votingexample.html#2989" class="Bound">_</a> <a id="2991" class="Symbol">→</a> <a id="2993" class="Number">1</a><a id="2994" class="Symbol">)(λ</a> <a id="2998" href="Complex-Model.example.votingexample.html#2998" class="Bound">_</a> <a id="3000" class="Symbol">→</a> <a id="3002" class="Number">1</a><a id="3003" class="Symbol">)</a>
                                    <a id="3041" class="Symbol">λ</a> <a id="3043" href="Complex-Model.example.votingexample.html#3043" class="Bound">_</a> <a id="3045" class="Symbol">→</a> <a id="3047" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="3054" class="Number">1</a> <a id="3056" href="Complex-Model.example.votingexample.html#2899" class="Bound">msg</a>                                           
<a id="3103" class="Comment">-- in case to delete voter</a>
<a id="3130" href="Complex-Model.example.votingexample.html#2710" class="Function">testLedger</a> <a id="3141" class="Number">1</a> <a id="3143" class="Symbol">.</a><a id="3144" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3148" class="String">&quot;deleteVoter&quot;</a> <a id="3162" href="Complex-Model.example.votingexample.html#3162" class="Bound">msg</a> <a id="3166" class="Symbol">=</a> <a id="3168" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="3173" class="Symbol">(</a><a id="3174" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="3182" class="String">&quot;checkVoter&quot;</a> <a id="3195" class="Symbol">(</a><a id="3196" href="Complex-Model.example.votingexample.html#1655" class="Function">deleteVoterAux</a> <a id="3211" href="Complex-Model.example.votingexample.html#3162" class="Bound">msg</a><a id="3214" class="Symbol">)</a> <a id="3216" class="Symbol">λ</a> <a id="3218" href="Complex-Model.example.votingexample.html#3218" class="Bound">_</a> <a id="3220" class="Symbol">→</a> <a id="3222" class="Number">1</a><a id="3223" class="Symbol">)</a>
                                      <a id="3263" class="Symbol">(λ</a> <a id="3266" href="Complex-Model.example.votingexample.html#3266" class="Bound">_</a> <a id="3268" class="Symbol">→</a> <a id="3270" class="Number">1</a><a id="3271" class="Symbol">)</a> <a id="3273" class="Symbol">λ</a> <a id="3275" href="Complex-Model.example.votingexample.html#3275" class="Bound">_</a> <a id="3277" class="Symbol">→</a> <a id="3279" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="3286" class="Number">1</a> <a id="3288" href="Complex-Model.example.votingexample.html#3162" class="Bound">msg</a>
<a id="3292" class="Comment">-- in case to vote</a>
<a id="3311" href="Complex-Model.example.votingexample.html#2710" class="Function">testLedger</a> <a id="3322" class="Number">1</a> <a id="3324" class="Symbol">.</a><a id="3325" href="libraries.Mainlibrary.html#830" class="Field">fun</a> <a id="3329" class="String">&quot;vote&quot;</a> <a id="3336" href="Complex-Model.example.votingexample.html#3336" class="Bound">msg</a> <a id="3340" class="Symbol">=</a> <a id="3342" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="3347" href="Complex-Model.ccomand.ccommands-cresponse.html#644" class="InductiveConstructor">callAddrLookupc</a>  <a id="3364" class="Symbol">(λ</a> <a id="3367" href="Complex-Model.example.votingexample.html#3367" class="Bound">_</a> <a id="3369" class="Symbol">→</a> <a id="3371" class="Number">1</a><a id="3372" class="Symbol">)</a>
                               <a id="3405" class="Symbol">λ</a> <a id="3407" href="Complex-Model.example.votingexample.html#3407" class="Bound">addr</a> <a id="3412" class="Symbol">→</a> <a id="3414" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="3419" class="Symbol">(</a><a id="3420" href="Complex-Model.ccomand.ccommands-cresponse.html#731" class="InductiveConstructor">callPure</a> <a id="3429" href="Complex-Model.example.votingexample.html#3407" class="Bound">addr</a> <a id="3434" class="String">&quot;checkVoter&quot;</a> <a id="3447" class="Symbol">(</a><a id="3448" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3452" href="Complex-Model.example.votingexample.html#3407" class="Bound">addr</a><a id="3456" class="Symbol">))</a>
                               <a id="3490" class="Symbol">(λ</a> <a id="3493" href="Complex-Model.example.votingexample.html#3493" class="Bound">_</a> <a id="3495" class="Symbol">→</a> <a id="3497" class="Number">1</a><a id="3498" class="Symbol">)</a> <a id="3500" class="Symbol">λ</a> <a id="3502" href="Complex-Model.example.votingexample.html#3502" class="Bound">check</a> <a id="3508" class="Symbol">→</a> <a id="3510" href="Complex-Model.example.votingexample.html#2170" class="Function">voteAux</a> <a id="3518" href="Complex-Model.example.votingexample.html#3502" class="Bound">check</a>
<a id="3524" class="Comment">-- in case to check voter</a>
<a id="3550" href="Complex-Model.example.votingexample.html#2710" class="Function">testLedger</a> <a id="3561" class="Number">1</a> <a id="3563" class="Symbol">.</a><a id="3564" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="3577" class="String">&quot;checkVoter&quot;</a> <a id="3590" href="Complex-Model.example.votingexample.html#3590" class="Bound">msg</a> <a id="3594" class="Symbol">=</a> <a id="3596" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3603" class="Symbol">(</a><a id="3604" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3608" class="Number">0</a><a id="3609" class="Symbol">)</a>

<a id="3612" class="Comment">-- in case to increment our counter</a>
<a id="3648" href="Complex-Model.example.votingexample.html#2710" class="Function">testLedger</a> <a id="3659" class="Number">1</a> <a id="3661" class="Symbol">.</a><a id="3662" href="libraries.Mainlibrary.html#886" class="Field">purefunction</a> <a id="3675" class="String">&quot;counter&quot;</a> <a id="3685" href="Complex-Model.example.votingexample.html#3685" class="Bound">msg</a> <a id="3689" class="Symbol">=</a> <a id="3691" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="3698" class="Symbol">(</a><a id="3699" href="basicDataStructure.html#507" class="InductiveConstructor">nat</a> <a id="3703" class="Number">0</a><a id="3704" class="Symbol">)</a>

<a id="3707" class="Comment">-- for other cases</a>
<a id="3726" href="Complex-Model.example.votingexample.html#2710" class="CatchallClause Function">testLedger</a><a id="3736" class="CatchallClause"> </a><a id="3737" href="Complex-Model.example.votingexample.html#3737" class="CatchallClause Bound">ow</a><a id="3739" class="CatchallClause"> </a><a id="3740" class="CatchallClause Symbol">.</a><a id="3741" href="libraries.Mainlibrary.html#808" class="CatchallClause Field">amount</a> <a id="3748" class="Symbol">=</a> <a id="3750" class="Number">0</a>
<a id="3752" href="Complex-Model.example.votingexample.html#2710" class="CatchallClause Function">testLedger</a><a id="3762" class="CatchallClause"> </a><a id="3763" href="Complex-Model.example.votingexample.html#3763" class="CatchallClause Bound">ow</a><a id="3765" class="CatchallClause"> </a><a id="3766" class="CatchallClause Symbol">.</a><a id="3767" href="libraries.Mainlibrary.html#830" class="CatchallClause Field">fun</a><a id="3770" class="CatchallClause"> </a><a id="3771" href="Complex-Model.example.votingexample.html#3771" class="CatchallClause Bound">ow&#39;</a><a id="3774" class="CatchallClause"> </a><a id="3775" href="Complex-Model.example.votingexample.html#3775" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="3780" class="Symbol">=</a> <a id="3782" href="Complex-Model.ccomand.ccommands-cresponse.html#1620" class="InductiveConstructor">error</a> <a id="3788" class="Symbol">(</a><a id="3789" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="3796" class="String">&quot;Undefined&quot;</a><a id="3807" class="Symbol">)</a> <a id="3809" href="basicDataStructure.html#842" class="InductiveConstructor Operator">⟨</a> <a id="3811" href="Complex-Model.example.votingexample.html#3763" class="Bound">ow</a> <a id="3814" href="basicDataStructure.html#842" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="3817" href="Complex-Model.example.votingexample.html#3763" class="Bound">ow</a> <a id="3820" href="basicDataStructure.html#842" class="InductiveConstructor Operator">∙</a> <a id="3822" href="Complex-Model.example.votingexample.html#3771" class="Bound">ow&#39;</a> <a id="3826" href="basicDataStructure.html#842" class="InductiveConstructor Operator">[</a> <a id="3828" href="Complex-Model.example.votingexample.html#3775" class="Bound">ow&#39;&#39;</a> <a id="3833" href="basicDataStructure.html#842" class="InductiveConstructor Operator">]⟩</a>
<a id="3836" href="Complex-Model.example.votingexample.html#2710" class="CatchallClause Function">testLedger</a><a id="3846" class="CatchallClause"> </a><a id="3847" href="Complex-Model.example.votingexample.html#3847" class="CatchallClause Bound">ow</a><a id="3849" class="CatchallClause"> </a><a id="3850" class="CatchallClause Symbol">.</a><a id="3851" href="libraries.Mainlibrary.html#886" class="CatchallClause Field">purefunction</a><a id="3863" class="CatchallClause"> </a><a id="3864" href="Complex-Model.example.votingexample.html#3864" class="CatchallClause Bound">ow&#39;</a><a id="3867" class="CatchallClause"> </a><a id="3868" href="Complex-Model.example.votingexample.html#3868" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="3873" class="Symbol">=</a> <a id="3875" href="basicDataStructure.html#1480" class="InductiveConstructor">err</a> <a id="3879" class="Symbol">(</a><a id="3880" href="basicDataStructure.html#645" class="InductiveConstructor">strErr</a> <a id="3887" class="String">&quot;Undefined&quot;</a><a id="3898" class="Symbol">)</a>


</pre></body></html>