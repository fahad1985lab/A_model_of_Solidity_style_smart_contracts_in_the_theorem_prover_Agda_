<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.ccomand.do-notation</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>


<a id="34" class="Keyword">module</a> <a id="41" href="Complex-Model.ccomand.do-notation.html" class="Module">Complex-Model.ccomand.do-notation</a> <a id="75" class="Symbol">(</a><a id="76" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a> <a id="82" class="Symbol">:</a> <a id="84" href="constantparameters.html#275" class="Record">ConstantParameters</a><a id="102" class="Symbol">)</a> <a id="104" class="Keyword">where</a>

<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="161" class="Keyword">using</a> <a id="167" class="Symbol">(</a><a id="168" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="171" class="Symbol">)</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Data.List.html" class="Module">Data.List</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="292" class="Keyword">open</a> <a id="297" class="Keyword">import</a> <a id="304" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="316" class="Keyword">hiding</a> <a id="323" class="Symbol">(</a><a id="324" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="329" class="Symbol">)</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Data.String.html" class="Module">Data.String</a> <a id="355" class="Keyword">hiding</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.String.Base.html#2430" class="Function">length</a><a id="369" class="Symbol">)</a>


<a id="373" class="Comment">--our work</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>


<a id="504" class="Comment">--- theses functions below we use them with do notation</a>
<a id="560" class="Comment">--functionofreturn : CResponse (callc addr fname msg) → ℕ</a>

<a id="call"></a><a id="619" href="Complex-Model.ccomand.do-notation.html#619" class="Function">call</a> <a id="624" class="Symbol">:</a> <a id="626" class="Symbol">(</a><a id="627" href="Complex-Model.ccomand.do-notation.html#627" class="Bound">addr</a> <a id="632" class="Symbol">:</a> <a id="634" href="basicDataStructure.html#387" class="Function">Address</a><a id="641" class="Symbol">)</a>  <a id="644" class="Symbol">→</a> <a id="646" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="659" class="Symbol">→</a> <a id="661" class="Symbol">(</a><a id="662" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="666" class="Symbol">→</a> <a id="668" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="669" class="Symbol">)</a> <a id="671" class="Symbol">→</a> <a id="673" href="Complex-Model.ccomand.ccommands-cresponse.html#1661" class="Function">FunDef</a>
<a id="680" href="Complex-Model.ccomand.do-notation.html#619" class="Function">call</a> <a id="685" href="Complex-Model.ccomand.do-notation.html#685" class="Bound">addr</a> <a id="690" href="Complex-Model.ccomand.do-notation.html#690" class="Bound">fname</a> <a id="696" href="Complex-Model.ccomand.do-notation.html#696" class="Bound">cost</a> <a id="701" href="Complex-Model.ccomand.do-notation.html#701" class="Bound">msg</a>  <a id="706" class="Symbol">=</a> <a id="708" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="713" class="Symbol">(</a><a id="714" href="Complex-Model.ccomand.ccommands-cresponse.html#675" class="InductiveConstructor">callc</a> <a id="720" href="Complex-Model.ccomand.do-notation.html#685" class="Bound">addr</a> <a id="725" href="Complex-Model.ccomand.do-notation.html#690" class="Bound">fname</a> <a id="731" href="Complex-Model.ccomand.do-notation.html#701" class="Bound">msg</a><a id="734" class="Symbol">)</a> <a id="736" class="Symbol">(</a><a id="737" href="constantparameters.html#569" class="Field">costcallc</a> <a id="747" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="752" class="Symbol">)</a> <a id="754" class="Symbol">λ</a> <a id="756" href="Complex-Model.ccomand.do-notation.html#756" class="Bound">r</a> <a id="758" class="Symbol">→</a> <a id="760" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="767" class="Symbol">(</a><a id="768" href="Complex-Model.ccomand.do-notation.html#696" class="Bound">cost</a> <a id="773" href="Complex-Model.ccomand.do-notation.html#756" class="Bound">r</a><a id="774" class="Symbol">)</a> <a id="776" href="Complex-Model.ccomand.do-notation.html#756" class="Bound">r</a>  

<a id="update"></a><a id="781" href="Complex-Model.ccomand.do-notation.html#781" class="Function">update</a> <a id="788" class="Symbol">:</a> <a id="790" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="803" class="Symbol">→</a> <a id="805" href="Complex-Model.ccomand.ccommands-cresponse.html#1661" class="Function">FunDef</a> <a id="812" class="Symbol">→</a> <a id="814" class="Symbol">(</a><a id="815" href="Complex-Model.ccomand.do-notation.html#815" class="Bound">cost₁</a>  <a id="822" href="Complex-Model.ccomand.do-notation.html#822" class="Bound">cost₂</a> <a id="828" class="Symbol">:</a> <a id="830" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="832" class="Symbol">)</a> <a id="834" class="Symbol">→</a> <a id="836" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="841" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="843" href="Complex-Model.ccomand.do-notation.html#781" class="Function">update</a> <a id="850" href="Complex-Model.ccomand.do-notation.html#850" class="Bound">fname</a> <a id="856" href="Complex-Model.ccomand.do-notation.html#856" class="Bound">fdef</a> <a id="861" href="Complex-Model.ccomand.do-notation.html#861" class="Bound">cost₁</a> <a id="867" href="Complex-Model.ccomand.do-notation.html#867" class="Bound">cost₂</a> <a id="873" class="Symbol">=</a> <a id="875" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="880" class="Symbol">(</a><a id="881" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="889" href="Complex-Model.ccomand.do-notation.html#850" class="Bound">fname</a> <a id="895" class="Symbol">(λ</a> <a id="898" href="Complex-Model.ccomand.do-notation.html#898" class="Bound">_</a> <a id="900" href="Complex-Model.ccomand.do-notation.html#900" class="Bound">fdef</a> <a id="905" class="Symbol">→</a> <a id="907" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="914" href="Complex-Model.ccomand.do-notation.html#900" class="Bound">fdef</a><a id="918" class="Symbol">)</a> <a id="920" class="Symbol">λ</a> <a id="922" href="Complex-Model.ccomand.do-notation.html#922" class="Bound">_</a> <a id="924" class="Symbol">→</a> <a id="926" href="Complex-Model.ccomand.do-notation.html#861" class="Bound">cost₁</a><a id="931" class="Symbol">)</a> <a id="933" class="Symbol">(λ</a> <a id="936" href="Complex-Model.ccomand.do-notation.html#936" class="Bound">_</a> <a id="938" class="Symbol">→</a> <a id="940" href="Complex-Model.ccomand.do-notation.html#861" class="Bound">cost₁</a><a id="945" class="Symbol">)</a> <a id="947" class="Symbol">(</a><a id="948" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="955" href="Complex-Model.ccomand.do-notation.html#867" class="Bound">cost₂</a><a id="960" class="Symbol">)</a> 

<a id="currentAddrLookup"></a><a id="964" href="Complex-Model.ccomand.do-notation.html#964" class="Function">currentAddrLookup</a> <a id="982" class="Symbol">:</a> <a id="984" class="Symbol">(</a><a id="985" href="Complex-Model.ccomand.do-notation.html#985" class="Bound">cost</a> <a id="990" class="Symbol">:</a> <a id="992" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1000" class="Symbol">→</a> <a id="1002" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1003" class="Symbol">)</a> <a id="1005" class="Symbol">→</a> <a id="1007" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="1012" href="basicDataStructure.html#387" class="Function">Address</a>
<a id="1020" href="Complex-Model.ccomand.do-notation.html#964" class="Function">currentAddrLookup</a> <a id="1038" href="Complex-Model.ccomand.do-notation.html#1038" class="Bound">cost</a> <a id="1043" class="Symbol">=</a> <a id="1045" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="1050" href="Complex-Model.ccomand.ccommands-cresponse.html#608" class="InductiveConstructor">currentAddrLookupc</a> <a id="1069" class="Symbol">(λ</a> <a id="1072" href="Complex-Model.ccomand.do-notation.html#1072" class="Bound">_</a> <a id="1074" class="Symbol">→</a> <a id="1076" href="constantparameters.html#507" class="Field">costcurrentAddrLookupc</a> <a id="1099" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1104" class="Symbol">)</a> <a id="1106" class="Symbol">λ</a> <a id="1108" href="Complex-Model.ccomand.do-notation.html#1108" class="Bound">addr</a> <a id="1113" class="Symbol">→</a> <a id="1115" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1122" class="Symbol">(</a><a id="1123" href="Complex-Model.ccomand.do-notation.html#1038" class="Bound">cost</a> <a id="1128" href="Complex-Model.ccomand.do-notation.html#1108" class="Bound">addr</a><a id="1132" class="Symbol">)</a> <a id="1134" href="Complex-Model.ccomand.do-notation.html#1108" class="Bound">addr</a>

<a id="callAddrLookup"></a><a id="1140" href="Complex-Model.ccomand.do-notation.html#1140" class="Function">callAddrLookup</a> <a id="1155" class="Symbol">:</a> <a id="1157" class="Symbol">(</a><a id="1158" href="Complex-Model.ccomand.do-notation.html#1158" class="Bound">cost</a> <a id="1163" class="Symbol">:</a> <a id="1165" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1173" class="Symbol">→</a> <a id="1175" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1176" class="Symbol">)</a> <a id="1178" class="Symbol">→</a> <a id="1180" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="1185" href="basicDataStructure.html#387" class="Function">Address</a>
<a id="1193" href="Complex-Model.ccomand.do-notation.html#1140" class="Function">callAddrLookup</a> <a id="1208" href="Complex-Model.ccomand.do-notation.html#1208" class="Bound">cost</a> <a id="1213" class="Symbol">=</a> <a id="1215" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="1220" href="Complex-Model.ccomand.ccommands-cresponse.html#643" class="InductiveConstructor">callAddrLookupc</a> <a id="1236" class="Symbol">(λ</a> <a id="1239" href="Complex-Model.ccomand.do-notation.html#1239" class="Bound">_</a> <a id="1241" class="Symbol">→</a> <a id="1243" href="constantparameters.html#538" class="Field">costcallAddrLookupc</a> <a id="1263" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1268" class="Symbol">)</a> <a id="1270" class="Symbol">λ</a> <a id="1272" href="Complex-Model.ccomand.do-notation.html#1272" class="Bound">addr</a> <a id="1277" class="Symbol">→</a> <a id="1279" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1286" class="Symbol">(</a><a id="1287" href="Complex-Model.ccomand.do-notation.html#1208" class="Bound">cost</a> <a id="1292" href="Complex-Model.ccomand.do-notation.html#1272" class="Bound">addr</a><a id="1296" class="Symbol">)</a> <a id="1298" href="Complex-Model.ccomand.do-notation.html#1272" class="Bound">addr</a> 

<a id="transfer"></a><a id="1305" href="Complex-Model.ccomand.do-notation.html#1305" class="Function">transfer</a> <a id="1314" class="Symbol">:</a> <a id="1316" href="basicDataStructure.html#360" class="Function">Amount</a> <a id="1323" class="Symbol">→</a> <a id="1325" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1333" class="Symbol">→</a> <a id="1335" class="Symbol">(</a><a id="1336" href="Complex-Model.ccomand.do-notation.html#1336" class="Bound">cost</a> <a id="1341" class="Symbol">:</a> <a id="1343" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1344" class="Symbol">)</a> <a id="1346" class="Symbol">→</a> <a id="1348" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="1353" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1355" href="Complex-Model.ccomand.do-notation.html#1305" class="Function">transfer</a> <a id="1364" href="Complex-Model.ccomand.do-notation.html#1364" class="Bound">amount</a> <a id="1371" href="Complex-Model.ccomand.do-notation.html#1371" class="Bound">addr</a> <a id="1376" href="Complex-Model.ccomand.do-notation.html#1376" class="Bound">cost</a> <a id="1381" class="Symbol">=</a>  <a id="1384" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a> <a id="1389" class="Symbol">(</a><a id="1390" href="Complex-Model.ccomand.ccommands-cresponse.html#816" class="InductiveConstructor">transferc</a> <a id="1400" href="Complex-Model.ccomand.do-notation.html#1364" class="Bound">amount</a> <a id="1407" href="Complex-Model.ccomand.do-notation.html#1371" class="Bound">addr</a><a id="1411" class="Symbol">)</a> <a id="1413" class="Symbol">(λ</a> <a id="1416" href="Complex-Model.ccomand.do-notation.html#1416" class="Bound">_</a> <a id="1418" class="Symbol">→</a> <a id="1420" href="constantparameters.html#606" class="Field">costtransfer</a> <a id="1433" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1438" class="Symbol">)</a> <a id="1440" class="Symbol">(</a><a id="1441" href="Complex-Model.ccomand.ccommands-cresponse.html#1505" class="InductiveConstructor">return</a> <a id="1448" href="Complex-Model.ccomand.do-notation.html#1376" class="Bound">cost</a><a id="1452" class="Symbol">)</a> 
</pre></body></html>