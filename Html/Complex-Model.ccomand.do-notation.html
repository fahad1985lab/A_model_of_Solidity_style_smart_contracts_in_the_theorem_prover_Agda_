<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.ccomand.do-notation</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>


<a id="34" class="Keyword">module</a> <a id="41" href="Complex-Model.ccomand.do-notation.html" class="Module">Complex-Model.ccomand.do-notation</a> <a id="75" class="Symbol">(</a><a id="76" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a> <a id="82" class="Symbol">:</a> <a id="84" href="constantparameters.html#275" class="Record">ConstantParameters</a><a id="102" class="Symbol">)</a> <a id="104" class="Keyword">where</a>

<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="161" class="Keyword">using</a> <a id="167" class="Symbol">(</a><a id="168" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="171" class="Symbol">)</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Data.List.html" class="Module">Data.List</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="292" class="Keyword">open</a> <a id="297" class="Keyword">import</a> <a id="304" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="316" class="Keyword">hiding</a> <a id="323" class="Symbol">(</a><a id="324" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="329" class="Symbol">)</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Data.String.html" class="Module">Data.String</a> <a id="355" class="Keyword">hiding</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.String.Base.html#2430" class="Function">length</a><a id="369" class="Symbol">)</a>


<a id="373" class="Comment">--our work</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>


<a id="504" class="Comment">--- theses functions below we use them with do notation</a>
<a id="560" class="Comment">--functionofreturn : CResponse (callc addr fname msg) → ℕ</a>

<a id="call"></a><a id="619" href="Complex-Model.ccomand.do-notation.html#619" class="Function">call</a> <a id="624" class="Symbol">:</a> <a id="626" class="Symbol">(</a><a id="627" href="Complex-Model.ccomand.do-notation.html#627" class="Bound">addr</a> <a id="632" class="Symbol">:</a> <a id="634" href="basicDataStructure.html#387" class="Function">Address</a><a id="641" class="Symbol">)</a>  <a id="644" class="Symbol">→</a> <a id="646" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="659" class="Symbol">→</a> <a id="661" class="Symbol">(</a><a id="662" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="666" class="Symbol">→</a> <a id="668" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="669" class="Symbol">)</a> <a id="671" class="Symbol">→</a> <a id="673" class="Symbol">(</a><a id="674" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="678" class="Symbol">→</a> <a id="680" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="698" href="basicDataStructure.html#488" class="Datatype">Msg</a><a id="701" class="Symbol">)</a>
<a id="703" href="Complex-Model.ccomand.do-notation.html#619" class="Function">call</a> <a id="708" href="Complex-Model.ccomand.do-notation.html#708" class="Bound">addr</a> <a id="713" href="Complex-Model.ccomand.do-notation.html#713" class="Bound">fname</a> <a id="719" href="Complex-Model.ccomand.do-notation.html#719" class="Bound">cost</a> <a id="724" href="Complex-Model.ccomand.do-notation.html#724" class="Bound">msg</a>  <a id="729" class="Symbol">=</a> <a id="731" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="736" class="Symbol">(</a><a id="737" href="Complex-Model.ccomand.ccommands-cresponse.html#676" class="InductiveConstructor">callc</a> <a id="743" href="Complex-Model.ccomand.do-notation.html#708" class="Bound">addr</a> <a id="748" href="Complex-Model.ccomand.do-notation.html#713" class="Bound">fname</a> <a id="754" href="Complex-Model.ccomand.do-notation.html#724" class="Bound">msg</a><a id="757" class="Symbol">)</a> <a id="759" class="Symbol">(</a><a id="760" href="constantparameters.html#569" class="Field">costcallc</a> <a id="770" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="775" class="Symbol">)</a> <a id="777" class="Symbol">λ</a> <a id="779" href="Complex-Model.ccomand.do-notation.html#779" class="Bound">r</a> <a id="781" class="Symbol">→</a> <a id="783" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="790" class="Symbol">(</a><a id="791" href="Complex-Model.ccomand.do-notation.html#719" class="Bound">cost</a> <a id="796" href="Complex-Model.ccomand.do-notation.html#779" class="Bound">r</a><a id="797" class="Symbol">)</a> <a id="799" href="Complex-Model.ccomand.do-notation.html#779" class="Bound">r</a>  

<a id="update"></a><a id="804" href="Complex-Model.ccomand.do-notation.html#804" class="Function">update</a> <a id="811" class="Symbol">:</a> <a id="813" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="826" class="Symbol">→</a> <a id="828" class="Symbol">(</a><a id="829" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="833" class="Symbol">→</a> <a id="835" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a><a id="845" class="Symbol">)</a> <a id="847" class="Symbol">→</a> <a id="849" class="Symbol">(</a><a id="850" href="Complex-Model.ccomand.do-notation.html#850" class="Bound">cost₁</a>  <a id="857" href="Complex-Model.ccomand.do-notation.html#857" class="Bound">cost₂</a> <a id="863" class="Symbol">:</a> <a id="865" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="867" class="Symbol">)</a> <a id="869" class="Symbol">→</a> <a id="871" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="889" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="891" href="Complex-Model.ccomand.do-notation.html#804" class="Function">update</a> <a id="898" href="Complex-Model.ccomand.do-notation.html#898" class="Bound">fname</a> <a id="904" href="Complex-Model.ccomand.do-notation.html#904" class="Bound">fdef</a> <a id="909" href="Complex-Model.ccomand.do-notation.html#909" class="Bound">cost₁</a> <a id="915" href="Complex-Model.ccomand.do-notation.html#915" class="Bound">cost₂</a> <a id="921" class="Symbol">=</a> <a id="923" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="928" class="Symbol">(</a><a id="929" href="Complex-Model.ccomand.ccommands-cresponse.html#487" class="InductiveConstructor">updatec</a> <a id="937" href="Complex-Model.ccomand.do-notation.html#898" class="Bound">fname</a> <a id="943" class="Symbol">(λ</a> <a id="946" href="Complex-Model.ccomand.do-notation.html#946" class="Bound">_</a> <a id="948" href="Complex-Model.ccomand.do-notation.html#948" class="Bound">fdef</a> <a id="953" class="Symbol">→</a> <a id="955" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="962" href="Complex-Model.ccomand.do-notation.html#948" class="Bound">fdef</a><a id="966" class="Symbol">)</a> <a id="968" class="Symbol">λ</a> <a id="970" href="Complex-Model.ccomand.do-notation.html#970" class="Bound">_</a> <a id="972" class="Symbol">→</a> <a id="974" href="Complex-Model.ccomand.do-notation.html#909" class="Bound">cost₁</a><a id="979" class="Symbol">)</a> <a id="981" class="Symbol">(λ</a> <a id="984" href="Complex-Model.ccomand.do-notation.html#984" class="Bound">_</a> <a id="986" class="Symbol">→</a> <a id="988" href="Complex-Model.ccomand.do-notation.html#909" class="Bound">cost₁</a><a id="993" class="Symbol">)</a> <a id="995" class="Symbol">(</a><a id="996" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="1003" href="Complex-Model.ccomand.do-notation.html#915" class="Bound">cost₂</a><a id="1008" class="Symbol">)</a> 

<a id="currentAddrLookup"></a><a id="1012" href="Complex-Model.ccomand.do-notation.html#1012" class="Function">currentAddrLookup</a> <a id="1030" class="Symbol">:</a> <a id="1032" class="Symbol">(</a><a id="1033" href="Complex-Model.ccomand.do-notation.html#1033" class="Bound">cost</a> <a id="1038" class="Symbol">:</a> <a id="1040" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1048" class="Symbol">→</a> <a id="1050" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1051" class="Symbol">)</a> <a id="1053" class="Symbol">→</a> <a id="1055" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="1073" href="basicDataStructure.html#387" class="Function">Address</a>
<a id="1081" href="Complex-Model.ccomand.do-notation.html#1012" class="Function">currentAddrLookup</a> <a id="1099" href="Complex-Model.ccomand.do-notation.html#1099" class="Bound">cost</a> <a id="1104" class="Symbol">=</a> <a id="1106" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="1111" href="Complex-Model.ccomand.ccommands-cresponse.html#609" class="InductiveConstructor">currentAddrLookupc</a> <a id="1130" class="Symbol">(λ</a> <a id="1133" href="Complex-Model.ccomand.do-notation.html#1133" class="Bound">_</a> <a id="1135" class="Symbol">→</a> <a id="1137" href="constantparameters.html#507" class="Field">costcurrentAddrLookupc</a> <a id="1160" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1165" class="Symbol">)</a> <a id="1167" class="Symbol">λ</a> <a id="1169" href="Complex-Model.ccomand.do-notation.html#1169" class="Bound">addr</a> <a id="1174" class="Symbol">→</a> <a id="1176" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="1183" class="Symbol">(</a><a id="1184" href="Complex-Model.ccomand.do-notation.html#1099" class="Bound">cost</a> <a id="1189" href="Complex-Model.ccomand.do-notation.html#1169" class="Bound">addr</a><a id="1193" class="Symbol">)</a> <a id="1195" href="Complex-Model.ccomand.do-notation.html#1169" class="Bound">addr</a>

<a id="callAddrLookup"></a><a id="1201" href="Complex-Model.ccomand.do-notation.html#1201" class="Function">callAddrLookup</a> <a id="1216" class="Symbol">:</a> <a id="1218" class="Symbol">(</a><a id="1219" href="Complex-Model.ccomand.do-notation.html#1219" class="Bound">cost</a> <a id="1224" class="Symbol">:</a> <a id="1226" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1234" class="Symbol">→</a> <a id="1236" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1237" class="Symbol">)</a> <a id="1239" class="Symbol">→</a> <a id="1241" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="1259" href="basicDataStructure.html#387" class="Function">Address</a>
<a id="1267" href="Complex-Model.ccomand.do-notation.html#1201" class="Function">callAddrLookup</a> <a id="1282" href="Complex-Model.ccomand.do-notation.html#1282" class="Bound">cost</a> <a id="1287" class="Symbol">=</a> <a id="1289" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="1294" href="Complex-Model.ccomand.ccommands-cresponse.html#644" class="InductiveConstructor">callAddrLookupc</a> <a id="1310" class="Symbol">(λ</a> <a id="1313" href="Complex-Model.ccomand.do-notation.html#1313" class="Bound">_</a> <a id="1315" class="Symbol">→</a> <a id="1317" href="constantparameters.html#538" class="Field">costcallAddrLookupc</a> <a id="1337" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1342" class="Symbol">)</a> <a id="1344" class="Symbol">λ</a> <a id="1346" href="Complex-Model.ccomand.do-notation.html#1346" class="Bound">addr</a> <a id="1351" class="Symbol">→</a> <a id="1353" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="1360" class="Symbol">(</a><a id="1361" href="Complex-Model.ccomand.do-notation.html#1282" class="Bound">cost</a> <a id="1366" href="Complex-Model.ccomand.do-notation.html#1346" class="Bound">addr</a><a id="1370" class="Symbol">)</a> <a id="1372" href="Complex-Model.ccomand.do-notation.html#1346" class="Bound">addr</a> 

<a id="transfer"></a><a id="1379" href="Complex-Model.ccomand.do-notation.html#1379" class="Function">transfer</a> <a id="1388" class="Symbol">:</a> <a id="1390" href="basicDataStructure.html#360" class="Function">Amount</a> <a id="1397" class="Symbol">→</a> <a id="1399" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1407" class="Symbol">→</a> <a id="1409" class="Symbol">(</a><a id="1410" href="Complex-Model.ccomand.do-notation.html#1410" class="Bound">cost</a> <a id="1415" class="Symbol">:</a> <a id="1417" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1418" class="Symbol">)</a> <a id="1420" class="Symbol">→</a> <a id="1422" href="Complex-Model.ccomand.ccommands-cresponse.html#1535" class="Datatype">SmartContractExec</a> <a id="1440" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1442" href="Complex-Model.ccomand.do-notation.html#1379" class="Function">transfer</a> <a id="1451" href="Complex-Model.ccomand.do-notation.html#1451" class="Bound">amount</a> <a id="1458" href="Complex-Model.ccomand.do-notation.html#1458" class="Bound">addr</a> <a id="1463" href="Complex-Model.ccomand.do-notation.html#1463" class="Bound">cost</a> <a id="1468" class="Symbol">=</a>  <a id="1471" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="1476" class="Symbol">(</a><a id="1477" href="Complex-Model.ccomand.ccommands-cresponse.html#817" class="InductiveConstructor">transferc</a> <a id="1487" href="Complex-Model.ccomand.do-notation.html#1451" class="Bound">amount</a> <a id="1494" href="Complex-Model.ccomand.do-notation.html#1458" class="Bound">addr</a><a id="1498" class="Symbol">)</a> <a id="1500" class="Symbol">(λ</a> <a id="1503" href="Complex-Model.ccomand.do-notation.html#1503" class="Bound">_</a> <a id="1505" class="Symbol">→</a> <a id="1507" href="constantparameters.html#606" class="Field">costtransfer</a> <a id="1520" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1525" class="Symbol">)</a> <a id="1527" class="Symbol">(</a><a id="1528" href="Complex-Model.ccomand.ccommands-cresponse.html#1579" class="InductiveConstructor">return</a> <a id="1535" href="Complex-Model.ccomand.do-notation.html#1463" class="Bound">cost</a><a id="1539" class="Symbol">)</a> 
</pre></body></html>