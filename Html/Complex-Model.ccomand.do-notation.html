<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.ccomand.do-notation</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>


<a id="34" class="Keyword">module</a> <a id="41" href="Complex-Model.ccomand.do-notation.html" class="Module">Complex-Model.ccomand.do-notation</a> <a id="75" class="Symbol">(</a><a id="76" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a> <a id="82" class="Symbol">:</a> <a id="84" href="constantparameters.html#275" class="Record">ConstantParameters</a><a id="102" class="Symbol">)</a> <a id="104" class="Keyword">where</a>

<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="161" class="Keyword">using</a> <a id="167" class="Symbol">(</a><a id="168" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="171" class="Symbol">)</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Data.List.html" class="Module">Data.List</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="292" class="Keyword">open</a> <a id="297" class="Keyword">import</a> <a id="304" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="316" class="Keyword">hiding</a> <a id="323" class="Symbol">(</a><a id="324" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="329" class="Symbol">)</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Data.String.html" class="Module">Data.String</a> <a id="355" class="Keyword">hiding</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.String.Base.html#2430" class="Function">length</a><a id="369" class="Symbol">)</a>


<a id="373" class="Comment">--our work</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>


<a id="504" class="Comment">--- theses functions below we use them with do notation</a>
<a id="560" class="Comment">--functionofreturn : CResponse (callc addr fname msg) → ℕ</a>

<a id="call"></a><a id="619" href="Complex-Model.ccomand.do-notation.html#619" class="Function">call</a> <a id="624" class="Symbol">:</a> <a id="626" class="Symbol">(</a><a id="627" href="Complex-Model.ccomand.do-notation.html#627" class="Bound">addr</a> <a id="632" class="Symbol">:</a> <a id="634" href="basicDataStructure.html#387" class="Function">Address</a><a id="641" class="Symbol">)</a>  <a id="644" class="Symbol">→</a> <a id="646" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="659" class="Symbol">→</a> <a id="661" class="Symbol">(</a><a id="662" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="666" class="Symbol">→</a> <a id="668" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="669" class="Symbol">)</a> <a id="671" class="Symbol">→</a> <a id="673" class="Symbol">(</a><a id="674" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="678" class="Symbol">→</a> <a id="680" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="698" href="basicDataStructure.html#488" class="Datatype">Msg</a><a id="701" class="Symbol">)</a>
<a id="703" href="Complex-Model.ccomand.do-notation.html#619" class="Function">call</a> <a id="708" href="Complex-Model.ccomand.do-notation.html#708" class="Bound">addr</a> <a id="713" href="Complex-Model.ccomand.do-notation.html#713" class="Bound">fname</a> <a id="719" href="Complex-Model.ccomand.do-notation.html#719" class="Bound">cost</a> <a id="724" href="Complex-Model.ccomand.do-notation.html#724" class="Bound">msg</a>  <a id="729" class="Symbol">=</a> <a id="731" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="736" class="Symbol">(</a><a id="737" href="Complex-Model.ccomand.ccommands-cresponse.html#675" class="InductiveConstructor">callc</a> <a id="743" href="Complex-Model.ccomand.do-notation.html#708" class="Bound">addr</a> <a id="748" href="Complex-Model.ccomand.do-notation.html#713" class="Bound">fname</a> <a id="754" href="Complex-Model.ccomand.do-notation.html#724" class="Bound">msg</a><a id="757" class="Symbol">)</a> <a id="759" class="Symbol">(</a><a id="760" href="constantparameters.html#569" class="Field">costcallc</a> <a id="770" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="775" class="Symbol">)</a> <a id="777" class="Symbol">λ</a> <a id="779" href="Complex-Model.ccomand.do-notation.html#779" class="Bound">r</a> <a id="781" class="Symbol">→</a> <a id="783" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="790" class="Symbol">(</a><a id="791" href="Complex-Model.ccomand.do-notation.html#719" class="Bound">cost</a> <a id="796" href="Complex-Model.ccomand.do-notation.html#779" class="Bound">r</a><a id="797" class="Symbol">)</a> <a id="799" href="Complex-Model.ccomand.do-notation.html#779" class="Bound">r</a>  

<a id="update"></a><a id="804" href="Complex-Model.ccomand.do-notation.html#804" class="Function">update</a> <a id="811" class="Symbol">:</a> <a id="813" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="826" class="Symbol">→</a> <a id="828" class="Symbol">(</a><a id="829" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="833" class="Symbol">→</a> <a id="835" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="853" href="basicDataStructure.html#488" class="Datatype">Msg</a><a id="856" class="Symbol">)</a> <a id="858" class="Symbol">→</a> <a id="860" class="Symbol">(</a><a id="861" href="Complex-Model.ccomand.do-notation.html#861" class="Bound">cost₁</a>  <a id="868" href="Complex-Model.ccomand.do-notation.html#868" class="Bound">cost₂</a> <a id="874" class="Symbol">:</a> <a id="876" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="878" class="Symbol">)</a> <a id="880" class="Symbol">→</a> <a id="882" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="900" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="902" href="Complex-Model.ccomand.do-notation.html#804" class="Function">update</a> <a id="909" href="Complex-Model.ccomand.do-notation.html#909" class="Bound">fname</a> <a id="915" href="Complex-Model.ccomand.do-notation.html#915" class="Bound">fdef</a> <a id="920" href="Complex-Model.ccomand.do-notation.html#920" class="Bound">cost₁</a> <a id="926" href="Complex-Model.ccomand.do-notation.html#926" class="Bound">cost₂</a> <a id="932" class="Symbol">=</a> <a id="934" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="939" class="Symbol">(</a><a id="940" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">updatec</a> <a id="948" href="Complex-Model.ccomand.do-notation.html#909" class="Bound">fname</a> <a id="954" class="Symbol">(λ</a> <a id="957" href="Complex-Model.ccomand.do-notation.html#957" class="Bound">_</a> <a id="959" href="Complex-Model.ccomand.do-notation.html#959" class="Bound">fdef</a> <a id="964" class="Symbol">→</a> <a id="966" href="basicDataStructure.html#1452" class="InductiveConstructor">theMsg</a> <a id="973" href="Complex-Model.ccomand.do-notation.html#959" class="Bound">fdef</a><a id="977" class="Symbol">)</a> <a id="979" class="Symbol">λ</a> <a id="981" href="Complex-Model.ccomand.do-notation.html#981" class="Bound">_</a> <a id="983" class="Symbol">→</a> <a id="985" href="Complex-Model.ccomand.do-notation.html#920" class="Bound">cost₁</a><a id="990" class="Symbol">)</a> <a id="992" class="Symbol">(λ</a> <a id="995" href="Complex-Model.ccomand.do-notation.html#995" class="Bound">_</a> <a id="997" class="Symbol">→</a> <a id="999" href="Complex-Model.ccomand.do-notation.html#920" class="Bound">cost₁</a><a id="1004" class="Symbol">)</a> <a id="1006" class="Symbol">(</a><a id="1007" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="1014" href="Complex-Model.ccomand.do-notation.html#926" class="Bound">cost₂</a><a id="1019" class="Symbol">)</a> 

<a id="currentAddrLookup"></a><a id="1023" href="Complex-Model.ccomand.do-notation.html#1023" class="Function">currentAddrLookup</a> <a id="1041" class="Symbol">:</a> <a id="1043" class="Symbol">(</a><a id="1044" href="Complex-Model.ccomand.do-notation.html#1044" class="Bound">cost</a> <a id="1049" class="Symbol">:</a> <a id="1051" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1059" class="Symbol">→</a> <a id="1061" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1062" class="Symbol">)</a> <a id="1064" class="Symbol">→</a> <a id="1066" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="1084" href="basicDataStructure.html#387" class="Function">Address</a>
<a id="1092" href="Complex-Model.ccomand.do-notation.html#1023" class="Function">currentAddrLookup</a> <a id="1110" href="Complex-Model.ccomand.do-notation.html#1110" class="Bound">cost</a> <a id="1115" class="Symbol">=</a> <a id="1117" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="1122" href="Complex-Model.ccomand.ccommands-cresponse.html#608" class="InductiveConstructor">currentAddrLookupc</a> <a id="1141" class="Symbol">(λ</a> <a id="1144" href="Complex-Model.ccomand.do-notation.html#1144" class="Bound">_</a> <a id="1146" class="Symbol">→</a> <a id="1148" href="constantparameters.html#507" class="Field">costcurrentAddrLookupc</a> <a id="1171" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1176" class="Symbol">)</a> <a id="1178" class="Symbol">λ</a> <a id="1180" href="Complex-Model.ccomand.do-notation.html#1180" class="Bound">addr</a> <a id="1185" class="Symbol">→</a> <a id="1187" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="1194" class="Symbol">(</a><a id="1195" href="Complex-Model.ccomand.do-notation.html#1110" class="Bound">cost</a> <a id="1200" href="Complex-Model.ccomand.do-notation.html#1180" class="Bound">addr</a><a id="1204" class="Symbol">)</a> <a id="1206" href="Complex-Model.ccomand.do-notation.html#1180" class="Bound">addr</a>

<a id="callAddrLookup"></a><a id="1212" href="Complex-Model.ccomand.do-notation.html#1212" class="Function">callAddrLookup</a> <a id="1227" class="Symbol">:</a> <a id="1229" class="Symbol">(</a><a id="1230" href="Complex-Model.ccomand.do-notation.html#1230" class="Bound">cost</a> <a id="1235" class="Symbol">:</a> <a id="1237" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1245" class="Symbol">→</a> <a id="1247" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1248" class="Symbol">)</a> <a id="1250" class="Symbol">→</a> <a id="1252" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="1270" href="basicDataStructure.html#387" class="Function">Address</a>
<a id="1278" href="Complex-Model.ccomand.do-notation.html#1212" class="Function">callAddrLookup</a> <a id="1293" href="Complex-Model.ccomand.do-notation.html#1293" class="Bound">cost</a> <a id="1298" class="Symbol">=</a> <a id="1300" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="1305" href="Complex-Model.ccomand.ccommands-cresponse.html#643" class="InductiveConstructor">callAddrLookupc</a> <a id="1321" class="Symbol">(λ</a> <a id="1324" href="Complex-Model.ccomand.do-notation.html#1324" class="Bound">_</a> <a id="1326" class="Symbol">→</a> <a id="1328" href="constantparameters.html#538" class="Field">costcallAddrLookupc</a> <a id="1348" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1353" class="Symbol">)</a> <a id="1355" class="Symbol">λ</a> <a id="1357" href="Complex-Model.ccomand.do-notation.html#1357" class="Bound">addr</a> <a id="1362" class="Symbol">→</a> <a id="1364" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="1371" class="Symbol">(</a><a id="1372" href="Complex-Model.ccomand.do-notation.html#1293" class="Bound">cost</a> <a id="1377" href="Complex-Model.ccomand.do-notation.html#1357" class="Bound">addr</a><a id="1381" class="Symbol">)</a> <a id="1383" href="Complex-Model.ccomand.do-notation.html#1357" class="Bound">addr</a> 

<a id="transfer"></a><a id="1390" href="Complex-Model.ccomand.do-notation.html#1390" class="Function">transfer</a> <a id="1399" class="Symbol">:</a> <a id="1401" href="basicDataStructure.html#360" class="Function">Amount</a> <a id="1408" class="Symbol">→</a> <a id="1410" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1418" class="Symbol">→</a> <a id="1420" class="Symbol">(</a><a id="1421" href="Complex-Model.ccomand.do-notation.html#1421" class="Bound">cost</a> <a id="1426" class="Symbol">:</a> <a id="1428" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1429" class="Symbol">)</a> <a id="1431" class="Symbol">→</a> <a id="1433" href="Complex-Model.ccomand.ccommands-cresponse.html#1494" class="Datatype">SmartContractExec</a> <a id="1451" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1453" href="Complex-Model.ccomand.do-notation.html#1390" class="Function">transfer</a> <a id="1462" href="Complex-Model.ccomand.do-notation.html#1462" class="Bound">amount</a> <a id="1469" href="Complex-Model.ccomand.do-notation.html#1469" class="Bound">addr</a> <a id="1474" href="Complex-Model.ccomand.do-notation.html#1474" class="Bound">cost</a> <a id="1479" class="Symbol">=</a>  <a id="1482" href="Complex-Model.ccomand.ccommands-cresponse.html#1636" class="InductiveConstructor">exec</a> <a id="1487" class="Symbol">(</a><a id="1488" href="Complex-Model.ccomand.ccommands-cresponse.html#816" class="InductiveConstructor">transferc</a> <a id="1498" href="Complex-Model.ccomand.do-notation.html#1462" class="Bound">amount</a> <a id="1505" href="Complex-Model.ccomand.do-notation.html#1469" class="Bound">addr</a><a id="1509" class="Symbol">)</a> <a id="1511" class="Symbol">(λ</a> <a id="1514" href="Complex-Model.ccomand.do-notation.html#1514" class="Bound">_</a> <a id="1516" class="Symbol">→</a> <a id="1518" href="constantparameters.html#606" class="Field">costtransfer</a> <a id="1531" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1536" class="Symbol">)</a> <a id="1538" class="Symbol">(</a><a id="1539" href="Complex-Model.ccomand.ccommands-cresponse.html#1538" class="InductiveConstructor">return</a> <a id="1546" href="Complex-Model.ccomand.do-notation.html#1474" class="Bound">cost</a><a id="1550" class="Symbol">)</a> 
</pre></body></html>