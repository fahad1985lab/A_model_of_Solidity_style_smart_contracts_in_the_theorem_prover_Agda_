<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>libraries.Mainlibrary</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Keyword">open</a> <a id="7" class="Keyword">import</a> <a id="14" href="constantparameters.html" class="Module">constantparameters</a>

<a id="34" class="Keyword">module</a> <a id="41" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a> <a id="63" class="Keyword">where</a>

<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Data.List.html" class="Module">Data.List</a> <a id="113" class="Keyword">hiding</a> <a id="120" class="Symbol">(</a><a id="121" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="125" class="Symbol">)</a>
<a id="127" class="Keyword">open</a> <a id="132" class="Keyword">import</a> <a id="139" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="156" class="Keyword">using</a> <a id="162" class="Symbol">(</a><a id="163" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="166" class="Symbol">;</a> <a id="168" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="171" class="Symbol">)</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="270" class="Keyword">open</a> <a id="275" class="Keyword">import</a> <a id="282" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="293" class="Keyword">hiding</a> <a id="300" class="Symbol">(</a><a id="301" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="306" class="Symbol">)</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.String.html" class="Module">Data.String</a> <a id="332" class="Keyword">hiding</a> <a id="339" class="Symbol">(</a><a id="340" href="Data.String.Base.html#2430" class="Function">length</a><a id="346" class="Symbol">;</a><a id="347" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="351" class="Symbol">)</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="379" class="Keyword">open</a> <a id="384" class="Keyword">import</a> <a id="391" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="407" class="Symbol">as</a> <a id="410" class="Module">Maybe</a> <a id="416" class="Keyword">using</a> <a id="422" class="Symbol">(</a><a id="423" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="428" class="Symbol">;</a> <a id="430" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="437" class="Symbol">;</a> <a id="439" href="Data.Maybe.Base.html#2335" class="Function Operator">_&lt;∣&gt;_</a><a id="444" class="Symbol">;</a> <a id="446" href="Data.Maybe.Base.html#2450" class="Function">when</a><a id="450" class="Symbol">)</a>
<a id="452" class="Keyword">import</a> <a id="459" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="482" class="Symbol">as</a> <a id="485" class="Module">Maybe</a>
<a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Data.Product.html" class="Module">Data.Product</a> <a id="516" class="Keyword">renaming</a> <a id="525" class="Symbol">(</a><a id="526" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="530" class="Symbol">to</a> <a id="533" class="InductiveConstructor Operator">_,,_</a> <a id="538" class="Symbol">)</a>
<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>


<a id="574" class="Comment">--our work</a>
<a id="585" class="Keyword">open</a> <a id="590" class="Keyword">import</a> <a id="597" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="649" class="Keyword">open</a> <a id="654" class="Keyword">import</a> <a id="661" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>



<a id="706" class="Comment">--Definition of complex smart contract</a>
<a id="745" class="Keyword">record</a> <a id="Contract"></a><a id="752" href="libraries.Mainlibrary.html#752" class="Record">Contract</a> <a id="761" class="Symbol">:</a> <a id="763" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="767" class="Keyword">where</a>
  <a id="775" class="Keyword">constructor</a> <a id="contract"></a><a id="787" href="libraries.Mainlibrary.html#787" class="InductiveConstructor">contract</a>
  <a id="798" class="Keyword">field</a>
    <a id="Contract.amount"></a><a id="808" href="libraries.Mainlibrary.html#808" class="Field">amount</a>   <a id="817" class="Symbol">:</a> <a id="819" href="basicDataStructure.html#360" class="Function">Amount</a>
    <a id="Contract.fun"></a><a id="830" href="libraries.Mainlibrary.html#830" class="Field">fun</a>  <a id="835" class="Symbol">:</a> <a id="837" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="850" class="Symbol">→</a> <a id="852" href="Complex-Model.ccomand.ccommands-cresponse.html#1661" class="Function">FunDef</a>  
    <a id="Contract.purefunction"></a><a id="865" href="libraries.Mainlibrary.html#865" class="Field">purefunction</a> <a id="878" class="Symbol">:</a> <a id="880" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="893" class="Symbol">→</a> <a id="895" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="899" class="Symbol">→</a> <a id="901" href="basicDataStructure.html#1428" class="Datatype">MsgOrError</a>  <a id="913" class="Comment">--this one will change because in ether the function no change only the variable can change</a>
   

<a id="1010" class="Keyword">open</a> <a id="1015" href="libraries.Mainlibrary.html#752" class="Module">Contract</a> <a id="1024" class="Keyword">public</a>




<a id="1035" class="Comment">--ledger</a>
<a id="Ledger"></a><a id="1044" href="libraries.Mainlibrary.html#1044" class="Function">Ledger</a> <a id="1051" class="Symbol">:</a> <a id="1053" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1057" href="libraries.Mainlibrary.html#1044" class="Function">Ledger</a> <a id="1064" class="Symbol">=</a> <a id="1066" href="basicDataStructure.html#387" class="Function">Address</a>  <a id="1075" class="Symbol">→</a> <a id="1077" href="libraries.Mainlibrary.html#752" class="Record">Contract</a>


<a id="1088" class="Comment">-- the execution stack element</a>
<a id="1119" class="Keyword">record</a> <a id="ExecStackEl"></a><a id="1126" href="libraries.Mainlibrary.html#1126" class="Record">ExecStackEl</a> <a id="1138" class="Symbol">:</a> <a id="1140" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1144" class="Keyword">where</a>
  <a id="1152" class="Keyword">constructor</a> <a id="execStackEl"></a><a id="1164" href="libraries.Mainlibrary.html#1164" class="InductiveConstructor">execStackEl</a>
  <a id="1178" class="Keyword">field</a>
    <a id="ExecStackEl.lastCallAddress"></a><a id="1188" href="libraries.Mainlibrary.html#1188" class="Field">lastCallAddress</a> <a id="1204" class="Symbol">:</a> <a id="1206" href="basicDataStructure.html#387" class="Function">Address</a>   <a id="1216" class="Comment">-- the address which made the call to the current function call</a>
    <a id="ExecStackEl.calledAddress"></a><a id="1284" href="libraries.Mainlibrary.html#1284" class="Field">calledAddress</a>   <a id="1300" class="Symbol">:</a> <a id="1302" href="basicDataStructure.html#387" class="Function">Address</a>   <a id="1312" class="Comment">-- is the address to which the last current function call was made from lastCallAddr</a>
    <a id="ExecStackEl.continuation"></a><a id="1401" href="libraries.Mainlibrary.html#1401" class="Field">continuation</a>  <a id="1415" class="Symbol">:</a> <a id="1417" href="Complex-Model.ccomand.ccommands-cresponse.html#1661" class="Function">FunDef</a> <a id="1424" class="Comment">-- continuation how to proceed once a result is returned, which depends on that result which is an element of Msg</a>
    <a id="ExecStackEl.costCont"></a><a id="1542" href="libraries.Mainlibrary.html#1542" class="Field">costCont</a>  <a id="1552" class="Symbol">:</a> <a id="1554" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1558" class="Symbol">→</a> <a id="1560" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1562" class="Comment">-- Cost for continuation depending on the msg returned when the current call is finished</a>
<a id="1651" class="Comment">-- The following two elements are only for debugging purposes so that in case of an error</a>
    <a id="ExecStackEl.funcNameexecStackEl"></a><a id="1745" href="libraries.Mainlibrary.html#1745" class="Field">funcNameexecStackEl</a>  <a id="1766" class="Symbol">:</a> <a id="1768" href="basicDataStructure.html#172" class="Function">FunctionName</a>     <a id="1785" class="Comment">--functionanme is the name of the function which was called</a>

    <a id="ExecStackEl.msgexecStackEl"></a><a id="1850" href="libraries.Mainlibrary.html#1850" class="Field">msgexecStackEl</a>       <a id="1871" class="Symbol">:</a> <a id="1873" href="basicDataStructure.html#488" class="Datatype">Msg</a> <a id="1877" class="Comment">--msg is the arguments with which this funciton was called.</a>
<a id="1937" class="Keyword">open</a> <a id="1942" href="libraries.Mainlibrary.html#1126" class="Module">ExecStackEl</a> <a id="1954" class="Keyword">public</a>


<a id="1963" class="Comment">-- execution stack function</a>
<a id="ExecutionStack"></a><a id="1991" href="libraries.Mainlibrary.html#1991" class="Function">ExecutionStack</a> <a id="2006" class="Symbol">:</a> <a id="2008" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2012" href="libraries.Mainlibrary.html#1991" class="Function">ExecutionStack</a> <a id="2027" class="Symbol">=</a> <a id="2029" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2034" href="libraries.Mainlibrary.html#1126" class="Record">ExecStackEl</a>





<a id="2051" class="Keyword">record</a> <a id="StateExecFun"></a><a id="2058" href="libraries.Mainlibrary.html#2058" class="Record">StateExecFun</a> <a id="2071" class="Symbol">:</a> <a id="2073" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2077" class="Keyword">where</a>
  <a id="2085" class="Keyword">constructor</a> <a id="stateEF"></a><a id="2097" href="libraries.Mainlibrary.html#2097" class="InductiveConstructor">stateEF</a>
  <a id="2107" class="Keyword">field</a>
    <a id="StateExecFun.ledger"></a><a id="2117" href="libraries.Mainlibrary.html#2117" class="Field">ledger</a> <a id="2124" class="Symbol">:</a> <a id="2126" href="libraries.Mainlibrary.html#1044" class="Function">Ledger</a>
    <a id="StateExecFun.executionStack"></a><a id="2137" href="libraries.Mainlibrary.html#2137" class="Field">executionStack</a> <a id="2152" class="Symbol">:</a> <a id="2154" href="libraries.Mainlibrary.html#1991" class="Function">ExecutionStack</a>
    <a id="StateExecFun.initialAddr"></a><a id="2173" href="libraries.Mainlibrary.html#2173" class="Field">initialAddr</a> <a id="2185" class="Symbol">:</a>  <a id="2188" href="basicDataStructure.html#387" class="Function">Address</a> <a id="2196" class="Comment">-- the address which initiated everything</a>
    <a id="StateExecFun.lastCallAddr"></a><a id="2242" href="libraries.Mainlibrary.html#2242" class="Field">lastCallAddr</a>    <a id="2258" class="Symbol">:</a> <a id="2260" href="basicDataStructure.html#387" class="Function">Address</a> <a id="2268" class="Comment">-- the address which made the call to the current function call</a>
    <a id="StateExecFun.calledAddr"></a><a id="2336" href="libraries.Mainlibrary.html#2336" class="Field">calledAddr</a> <a id="2347" class="Symbol">:</a> <a id="2349" href="basicDataStructure.html#387" class="Function">Address</a>   <a id="2359" class="Comment">-- is the address to which the last current fucntion call was made from lastCallAddr</a>
    <a id="StateExecFun.nextstep"></a><a id="2448" href="libraries.Mainlibrary.html#2448" class="Field">nextstep</a>  <a id="2458" class="Symbol">:</a> <a id="2460" href="Complex-Model.ccomand.ccommands-cresponse.html#1474" class="Datatype">Prog</a> <a id="2465" href="basicDataStructure.html#488" class="Datatype">Msg</a>   <a id="2471" class="Comment">-- next step in the program to be executed when</a>
    <a id="StateExecFun.gasLeft"></a><a id="2523" href="libraries.Mainlibrary.html#2523" class="Field">gasLeft</a>   <a id="2533" class="Symbol">:</a> <a id="2535" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>  <a id="2538" class="Comment">-- how much we have left in the next execution step</a>

<a id="2591" class="Comment">--these info regarding debug info :</a>

    <a id="StateExecFun.funNameevalState"></a><a id="2632" href="libraries.Mainlibrary.html#2632" class="Field">funNameevalState</a> <a id="2649" class="Symbol">:</a> <a id="2651" href="basicDataStructure.html#172" class="Function">FunctionName</a>
    <a id="StateExecFun.msgevalState"></a><a id="2668" href="libraries.Mainlibrary.html#2668" class="Field">msgevalState</a> <a id="2681" class="Symbol">:</a> <a id="2683" href="basicDataStructure.html#488" class="Datatype">Msg</a>
<a id="2687" class="Keyword">open</a> <a id="2692" href="libraries.Mainlibrary.html#2058" class="Module">StateExecFun</a> <a id="2705" class="Keyword">public</a>


</pre></body></html>